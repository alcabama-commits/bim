var Uh=Object.defineProperty,xc=n=>{throw TypeError(n)},Nh=(n,e,t)=>e in n?Uh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ot=(n,e,t)=>Nh(n,typeof e!="symbol"?e+"":e,t),fc=(n,e,t)=>e.has(n)||xc("Cannot "+t),sa=(n,e,t)=>(fc(n,e,"read from private field"),t?t.call(n):e.get(n)),ra=(n,e,t)=>e.has(n)?xc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),ia=(n,e,t,s)=>(fc(n,e,"write to private field"),e.set(n,t),t);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const gc="171",Rc="",xe="srgb",na="srgb-linear",aa="linear",Bs="srgb";class ws{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const s=this._listeners;s[e]===void 0&&(s[e]=[]),s[e].indexOf(t)===-1&&s[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const s=this._listeners;return s[e]!==void 0&&s[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const s=t.slice(0);for(let r=0,i=s.length;r<i;r++)s[r].call(this,e);e.target=null}}}const Q=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function St(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(Q[n&255]+Q[n>>8&255]+Q[n>>16&255]+Q[n>>24&255]+"-"+Q[e&255]+Q[e>>8&255]+"-"+Q[e>>16&15|64]+Q[e>>24&255]+"-"+Q[t&63|128]+Q[t>>8&255]+"-"+Q[t>>16&255]+Q[t>>24&255]+Q[s&255]+Q[s>>8&255]+Q[s>>16&255]+Q[s>>24&255]).toLowerCase()}function z(n,e,t){return Math.max(e,Math.min(t,n))}function Fh(n,e){return(n%e+e)%e}function Js(n,e,t){return(1-t)*n+t*e}function Vt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function se(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class w{constructor(e=0,t=0){w.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,s=this.y,r=e.elements;return this.x=r[0]*t+r[3]*s+r[6],this.y=r[1]*t+r[4]*s+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=z(this.x,e.x,t.x),this.y=z(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=z(this.x,e,t),this.y=z(this.y,e,t),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(z(s,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const s=this.dot(e)/t;return Math.acos(z(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,s=this.y-e.y;return t*t+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const s=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*s-a*r+e.x,this.y=i*r+a*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ue{constructor(e,t,s,r,i,a,o,l,c){Ue.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,s,r,i,a,o,l,c)}set(e,t,s,r,i,a,o,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=o,h[3]=t,h[4]=i,h[5]=l,h[6]=s,h[7]=a,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,s=e.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],this}extractBasis(e,t,s){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const s=e.elements,r=t.elements,i=this.elements,a=s[0],o=s[3],l=s[6],c=s[1],h=s[4],u=s[7],d=s[2],p=s[5],m=s[8],y=r[0],b=r[3],x=r[6],g=r[1],R=r[4],Z=r[7],v=r[2],G=r[5],S=r[8];return i[0]=a*y+o*g+l*v,i[3]=a*b+o*R+l*G,i[6]=a*x+o*Z+l*S,i[1]=c*y+h*g+u*v,i[4]=c*b+h*R+u*G,i[7]=c*x+h*Z+u*S,i[2]=d*y+p*g+m*v,i[5]=d*b+p*R+m*G,i[8]=d*x+p*Z+m*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],s=e[1],r=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8];return t*a*h-t*o*c-s*i*h+s*o*l+r*i*c-r*a*l}invert(){const e=this.elements,t=e[0],s=e[1],r=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=h*a-o*c,d=o*l-h*i,p=c*i-a*l,m=t*u+s*d+r*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/m;return e[0]=u*y,e[1]=(r*c-h*s)*y,e[2]=(o*s-r*a)*y,e[3]=d*y,e[4]=(h*t-r*l)*y,e[5]=(r*i-o*t)*y,e[6]=p*y,e[7]=(s*l-c*t)*y,e[8]=(a*t-s*i)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,s,r,i,a,o){const l=Math.cos(i),c=Math.sin(i);return this.set(s*l,s*c,-s*(l*a+c*o)+a+e,-r*c,r*l,-r*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(Ks.makeScale(e,t)),this}rotate(e){return this.premultiply(Ks.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ks.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,s,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,s=e.elements;for(let r=0;r<9;r++)if(t[r]!==s[r])return!1;return!0}fromArray(e,t=0){for(let s=0;s<9;s++)this.elements[s]=e[s+t];return this}toArray(e=[],t=0){const s=this.elements;return e[t]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3],e[t+4]=s[4],e[t+5]=s[5],e[t+6]=s[6],e[t+7]=s[7],e[t+8]=s[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Ks=new Ue;function Ch(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function oa(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}const la=new Ue().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),ca=new Ue().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Eh(){const n={enabled:!0,workingColorSpace:na,spaces:{},convert:function(r,i,a){return this.enabled===!1||i===a||!i||!a||(this.spaces[i].transfer===Bs&&(r.r=Te(r.r),r.g=Te(r.g),r.b=Te(r.b)),this.spaces[i].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Bs&&(r.r=Zt(r.r),r.g=Zt(r.g),r.b=Zt(r.b))),r},fromWorkingColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},toWorkingColorSpace:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Rc?aa:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,a){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],s=[.3127,.329];return n.define({[na]:{primaries:e,whitePoint:s,transfer:aa,toXYZ:la,fromXYZ:ca,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:xe},outputColorSpaceConfig:{drawingBufferColorSpace:xe}},[xe]:{primaries:e,whitePoint:s,transfer:Bs,toXYZ:la,fromXYZ:ca,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:xe}}}),n}const pe=Eh();function Te(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Zt(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let lt;class Hh{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{lt===void 0&&(lt=oa("canvas")),lt.width=e.width,lt.height=e.height;const s=lt.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),t=lt}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=oa("canvas");t.width=e.width,t.height=e.height;const s=t.getContext("2d");s.drawImage(e,0,0,e.width,e.height);const r=s.getImageData(0,0,e.width,e.height),i=r.data;for(let a=0;a<i.length;a++)i[a]=Te(i[a]/255)*255;return s.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let s=0;s<t.length;s++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[s]=Math.floor(Te(t[s]/255)*255):t[s]=Te(t[s]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Yh=0;class Bh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Yh++}),this.uuid=St(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const s={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(Ps(r[a].image)):i.push(Ps(r[a]))}else i=Ps(r);s.url=i}return t||(e.images[this.uuid]=s),s}}function Ps(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Hh.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Jh=0;class Ie extends ws{constructor(e=Ie.DEFAULT_IMAGE,t=Ie.DEFAULT_MAPPING,s=1001,r=1001,i=1006,a=1008,o=1023,l=1009,c=Ie.DEFAULT_ANISOTROPY,h=Rc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Jh++}),this.uuid=St(),this.name="",this.source=new Bh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=s,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new w(0,0),this.repeat=new w(1,1),this.center=new w(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ue,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),t||(e.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ie.DEFAULT_IMAGE=null;Ie.DEFAULT_MAPPING=300;Ie.DEFAULT_ANISOTROPY=1;class Ct{constructor(e=0,t=0,s=0,r=1){Ct.prototype.isVector4=!0,this.x=e,this.y=t,this.z=s,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,s,r){return this.x=e,this.y=t,this.z=s,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,s=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*s+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*s+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*s+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*s+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,s,r,i;const a=e.elements,o=a[0],l=a[4],c=a[8],h=a[1],u=a[5],d=a[9],p=a[2],m=a[6],y=a[10];if(Math.abs(l-h)<.01&&Math.abs(c-p)<.01&&Math.abs(d-m)<.01){if(Math.abs(l+h)<.1&&Math.abs(c+p)<.1&&Math.abs(d+m)<.1&&Math.abs(o+u+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(o+1)/2,g=(u+1)/2,R=(y+1)/2,Z=(l+h)/4,v=(c+p)/4,G=(d+m)/4;return x>g&&x>R?x<.01?(s=0,r=.707106781,i=.707106781):(s=Math.sqrt(x),r=Z/s,i=v/s):g>R?g<.01?(s=.707106781,r=0,i=.707106781):(r=Math.sqrt(g),s=Z/r,i=G/r):R<.01?(s=.707106781,r=.707106781,i=0):(i=Math.sqrt(R),s=v/i,r=G/i),this.set(s,r,i,t),this}let b=Math.sqrt((m-d)*(m-d)+(c-p)*(c-p)+(h-l)*(h-l));return Math.abs(b)<.001&&(b=1),this.x=(m-d)/b,this.y=(c-p)/b,this.z=(h-l)/b,this.w=Math.acos((o+u+y-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=z(this.x,e.x,t.x),this.y=z(this.y,e.y,t.y),this.z=z(this.z,e.z,t.z),this.w=z(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=z(this.x,e,t),this.y=z(this.y,e,t),this.z=z(this.z,e,t),this.w=z(this.w,e,t),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(z(s,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this.z=e.z+(t.z-e.z)*s,this.w=e.w+(t.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}let $e=class{constructor(n=0,e=0,t=0,s=1){this.isQuaternion=!0,this._x=n,this._y=e,this._z=t,this._w=s}static slerpFlat(n,e,t,s,r,i,a){let o=t[s+0],l=t[s+1],c=t[s+2],h=t[s+3];const u=r[i+0],d=r[i+1],p=r[i+2],m=r[i+3];if(a===0){n[e+0]=o,n[e+1]=l,n[e+2]=c,n[e+3]=h;return}if(a===1){n[e+0]=u,n[e+1]=d,n[e+2]=p,n[e+3]=m;return}if(h!==m||o!==u||l!==d||c!==p){let y=1-a;const b=o*u+l*d+c*p+h*m,x=b>=0?1:-1,g=1-b*b;if(g>Number.EPSILON){const Z=Math.sqrt(g),v=Math.atan2(Z,b*x);y=Math.sin(y*v)/Z,a=Math.sin(a*v)/Z}const R=a*x;if(o=o*y+u*R,l=l*y+d*R,c=c*y+p*R,h=h*y+m*R,y===1-a){const Z=1/Math.sqrt(o*o+l*l+c*c+h*h);o*=Z,l*=Z,c*=Z,h*=Z}}n[e]=o,n[e+1]=l,n[e+2]=c,n[e+3]=h}static multiplyQuaternionsFlat(n,e,t,s,r,i){const a=t[s],o=t[s+1],l=t[s+2],c=t[s+3],h=r[i],u=r[i+1],d=r[i+2],p=r[i+3];return n[e]=a*p+c*h+o*d-l*u,n[e+1]=o*p+c*u+l*h-a*d,n[e+2]=l*p+c*d+a*u-o*h,n[e+3]=c*p-a*h-o*u-l*d,n}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get w(){return this._w}set w(n){this._w=n,this._onChangeCallback()}set(n,e,t,s){return this._x=n,this._y=e,this._z=t,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(n){return this._x=n.x,this._y=n.y,this._z=n.z,this._w=n.w,this._onChangeCallback(),this}setFromEuler(n,e=!0){const t=n._x,s=n._y,r=n._z,i=n._order,a=Math.cos,o=Math.sin,l=a(t/2),c=a(s/2),h=a(r/2),u=o(t/2),d=o(s/2),p=o(r/2);switch(i){case"XYZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"YXZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"ZXY":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"ZYX":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"YZX":this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p;break;case"XZY":this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(n,e){const t=e/2,s=Math.sin(t);return this._x=n.x*s,this._y=n.y*s,this._z=n.z*s,this._w=Math.cos(t),this._onChangeCallback(),this}setFromRotationMatrix(n){const e=n.elements,t=e[0],s=e[4],r=e[8],i=e[1],a=e[5],o=e[9],l=e[2],c=e[6],h=e[10],u=t+a+h;if(u>0){const d=.5/Math.sqrt(u+1);this._w=.25/d,this._x=(c-o)*d,this._y=(r-l)*d,this._z=(i-s)*d}else if(t>a&&t>h){const d=2*Math.sqrt(1+t-a-h);this._w=(c-o)/d,this._x=.25*d,this._y=(s+i)/d,this._z=(r+l)/d}else if(a>h){const d=2*Math.sqrt(1+a-t-h);this._w=(r-l)/d,this._x=(s+i)/d,this._y=.25*d,this._z=(o+c)/d}else{const d=2*Math.sqrt(1+h-t-a);this._w=(i-s)/d,this._x=(r+l)/d,this._y=(o+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(n,e){let t=n.dot(e)+1;return t<Number.EPSILON?(t=0,Math.abs(n.x)>Math.abs(n.z)?(this._x=-n.y,this._y=n.x,this._z=0,this._w=t):(this._x=0,this._y=-n.z,this._z=n.y,this._w=t)):(this._x=n.y*e.z-n.z*e.y,this._y=n.z*e.x-n.x*e.z,this._z=n.x*e.y-n.y*e.x,this._w=t),this.normalize()}angleTo(n){return 2*Math.acos(Math.abs(z(this.dot(n),-1,1)))}rotateTowards(n,e){const t=this.angleTo(n);if(t===0)return this;const s=Math.min(1,e/t);return this.slerp(n,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(n){return this._x*n._x+this._y*n._y+this._z*n._z+this._w*n._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let n=this.length();return n===0?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this._onChangeCallback(),this}multiply(n){return this.multiplyQuaternions(this,n)}premultiply(n){return this.multiplyQuaternions(n,this)}multiplyQuaternions(n,e){const t=n._x,s=n._y,r=n._z,i=n._w,a=e._x,o=e._y,l=e._z,c=e._w;return this._x=t*c+i*a+s*l-r*o,this._y=s*c+i*o+r*a-t*l,this._z=r*c+i*l+t*o-s*a,this._w=i*c-t*a-s*o-r*l,this._onChangeCallback(),this}slerp(n,e){if(e===0)return this;if(e===1)return this.copy(n);const t=this._x,s=this._y,r=this._z,i=this._w;let a=i*n._w+t*n._x+s*n._y+r*n._z;if(a<0?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,a=-a):this.copy(n),a>=1)return this._w=i,this._x=t,this._y=s,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const d=1-e;return this._w=d*i+e*this._w,this._x=d*t+e*this._x,this._y=d*s+e*this._y,this._z=d*r+e*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=i*h+this._w*u,this._x=t*h+this._x*u,this._y=s*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(n,e,t){return this.copy(n).slerp(e,t)}random(){const n=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),t=Math.random(),s=Math.sqrt(1-t),r=Math.sqrt(t);return this.set(s*Math.sin(n),s*Math.cos(n),r*Math.sin(e),r*Math.cos(e))}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._w===this._w}fromArray(n,e=0){return this._x=n[e],this._y=n[e+1],this._z=n[e+2],this._w=n[e+3],this._onChangeCallback(),this}toArray(n=[],e=0){return n[e]=this._x,n[e+1]=this._y,n[e+2]=this._z,n[e+3]=this._w,n}fromBufferAttribute(n,e){return this._x=n.getX(e),this._y=n.getY(e),this._z=n.getZ(e),this._w=n.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};class f{constructor(e=0,t=0,s=0){f.prototype.isVector3=!0,this.x=e,this.y=t,this.z=s}set(e,t,s){return s===void 0&&(s=this.z),this.x=e,this.y=t,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ha.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ha.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,s=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*s+i[6]*r,this.y=i[1]*t+i[4]*s+i[7]*r,this.z=i[2]*t+i[5]*s+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,s=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*s+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*s+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*s+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*s+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,s=this.y,r=this.z,i=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*r-o*s),h=2*(o*t-i*r),u=2*(i*s-a*t);return this.x=t+l*c+a*u-o*h,this.y=s+l*h+o*c-i*u,this.z=r+l*u+i*h-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,s=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*s+i[8]*r,this.y=i[1]*t+i[5]*s+i[9]*r,this.z=i[2]*t+i[6]*s+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=z(this.x,e.x,t.x),this.y=z(this.y,e.y,t.y),this.z=z(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=z(this.x,e,t),this.y=z(this.y,e,t),this.z=z(this.z,e,t),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(z(s,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this.z=e.z+(t.z-e.z)*s,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const s=e.x,r=e.y,i=e.z,a=t.x,o=t.y,l=t.z;return this.x=r*l-i*o,this.y=i*a-s*l,this.z=s*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const s=e.dot(this)/t;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return _s.copy(this).projectOnVector(e),this.sub(_s)}reflect(e){return this.sub(_s.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const s=this.dot(e)/t;return Math.acos(z(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,s=this.y-e.y,r=this.z-e.z;return t*t+s*s+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,s){const r=Math.sin(t)*e;return this.x=r*Math.sin(s),this.y=Math.cos(t)*e,this.z=r*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,s){return this.x=e*Math.sin(t),this.y=s,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=s,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,s=Math.sqrt(1-t*t);return this.x=s*Math.cos(e),this.y=t,this.z=s*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _s=new f,ha=new $e;let Ze=class{constructor(n=new f(1/0,1/0,1/0),e=new f(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=n,this.max=e}set(n,e){return this.min.copy(n),this.max.copy(e),this}setFromArray(n){this.makeEmpty();for(let e=0,t=n.length;e<t;e+=3)this.expandByPoint(me.fromArray(n,e));return this}setFromBufferAttribute(n){this.makeEmpty();for(let e=0,t=n.count;e<t;e++)this.expandByPoint(me.fromBufferAttribute(n,e));return this}setFromPoints(n){this.makeEmpty();for(let e=0,t=n.length;e<t;e++)this.expandByPoint(n[e]);return this}setFromCenterAndSize(n,e){const t=me.copy(e).multiplyScalar(.5);return this.min.copy(n).sub(t),this.max.copy(n).add(t),this}setFromObject(n,e=!1){return this.makeEmpty(),this.expandByObject(n,e)}clone(){return new this.constructor().copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(n){return this.isEmpty()?n.set(0,0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}expandByObject(n,e=!1){n.updateWorldMatrix(!1,!1);const t=n.geometry;if(t!==void 0){const r=t.getAttribute("position");if(e===!0&&r!==void 0&&n.isInstancedMesh!==!0)for(let i=0,a=r.count;i<a;i++)n.isMesh===!0?n.getVertexPosition(i,me):me.fromBufferAttribute(r,i),me.applyMatrix4(n.matrixWorld),this.expandByPoint(me);else n.boundingBox!==void 0?(n.boundingBox===null&&n.computeBoundingBox(),Qt.copy(n.boundingBox)):(t.boundingBox===null&&t.computeBoundingBox(),Qt.copy(t.boundingBox)),Qt.applyMatrix4(n.matrixWorld),this.union(Qt)}const s=n.children;for(let r=0,i=s.length;r<i;r++)this.expandByObject(s[r],e);return this}containsPoint(n){return n.x>=this.min.x&&n.x<=this.max.x&&n.y>=this.min.y&&n.y<=this.max.y&&n.z>=this.min.z&&n.z<=this.max.z}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y&&this.min.z<=n.min.z&&n.max.z<=this.max.z}getParameter(n,e){return e.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y),(n.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(n){return n.max.x>=this.min.x&&n.min.x<=this.max.x&&n.max.y>=this.min.y&&n.min.y<=this.max.y&&n.max.z>=this.min.z&&n.min.z<=this.max.z}intersectsSphere(n){return this.clampPoint(n.center,me),me.distanceToSquared(n.center)<=n.radius*n.radius}intersectsPlane(n){let e,t;return n.normal.x>0?(e=n.normal.x*this.min.x,t=n.normal.x*this.max.x):(e=n.normal.x*this.max.x,t=n.normal.x*this.min.x),n.normal.y>0?(e+=n.normal.y*this.min.y,t+=n.normal.y*this.max.y):(e+=n.normal.y*this.max.y,t+=n.normal.y*this.min.y),n.normal.z>0?(e+=n.normal.z*this.min.z,t+=n.normal.z*this.max.z):(e+=n.normal.z*this.max.z,t+=n.normal.z*this.min.z),e<=-n.constant&&t>=-n.constant}intersectsTriangle(n){if(this.isEmpty())return!1;this.getCenter(Mt),Ot.subVectors(this.max,Mt),ct.subVectors(n.a,Mt),ht.subVectors(n.b,Mt),ut.subVectors(n.c,Mt),Ee.subVectors(ht,ct),He.subVectors(ut,ht),Ae.subVectors(ct,ut);let e=[0,-Ee.z,Ee.y,0,-He.z,He.y,0,-Ae.z,Ae.y,Ee.z,0,-Ee.x,He.z,0,-He.x,Ae.z,0,-Ae.x,-Ee.y,Ee.x,0,-He.y,He.x,0,-Ae.y,Ae.x,0];return!js(e,ct,ht,ut,Ot)||(e=[1,0,0,0,1,0,0,0,1],!js(e,ct,ht,ut,Ot))?!1:(Dt.crossVectors(Ee,He),e=[Dt.x,Dt.y,Dt.z],js(e,ct,ht,ut,Ot))}clampPoint(n,e){return e.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return this.clampPoint(n,me).distanceTo(n)}getBoundingSphere(n){return this.isEmpty()?n.makeEmpty():(this.getCenter(n.center),n.radius=this.getSize(me).length()*.5),n}intersect(n){return this.min.max(n.min),this.max.min(n.max),this.isEmpty()&&this.makeEmpty(),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}applyMatrix4(n){return this.isEmpty()?this:(Ve[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),Ve[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),Ve[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),Ve[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),Ve[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),Ve[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),Ve[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),Ve[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(Ve),this)}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}};const Ve=[new f,new f,new f,new f,new f,new f,new f,new f],me=new f,Qt=new Ze,ct=new f,ht=new f,ut=new f,Ee=new f,He=new f,Ae=new f,Mt=new f,Ot=new f,Dt=new f,Qe=new f;function js(n,e,t,s,r){for(let i=0,a=n.length-3;i<=a;i+=3){Qe.fromArray(n,i);const o=r.x*Math.abs(Qe.x)+r.y*Math.abs(Qe.y)+r.z*Math.abs(Qe.z),l=e.dot(Qe),c=t.dot(Qe),h=s.dot(Qe);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>o)return!1}return!0}const Kh=new Ze,kt=new f,As=new f;class Sn{constructor(e=new f,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const s=this.center;t!==void 0?s.copy(t):Kh.setFromPoints(e).getCenter(s);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,s.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const s=this.center.distanceToSquared(e);return t.copy(e),s>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;kt.subVectors(e,this.center);const t=kt.lengthSq();if(t>this.radius*this.radius){const s=Math.sqrt(t),r=(s-this.radius)*.5;this.center.addScaledVector(kt,r/s),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(As.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(kt.copy(e.center).add(As)),this.expandByPoint(kt.copy(e.center).sub(As))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Me=new f,Qs=new f,qt=new f,Ye=new f,Os=new f,$t=new f,Ds=new f;class vn{constructor(e=new f,t=new f(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Me)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const s=t.dot(this.direction);return s<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Me.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Me.copy(this.origin).addScaledVector(this.direction,t),Me.distanceToSquared(e))}distanceSqToSegment(e,t,s,r){Qs.copy(e).add(t).multiplyScalar(.5),qt.copy(t).sub(e).normalize(),Ye.copy(this.origin).sub(Qs);const i=e.distanceTo(t)*.5,a=-this.direction.dot(qt),o=Ye.dot(this.direction),l=-Ye.dot(qt),c=Ye.lengthSq(),h=Math.abs(1-a*a);let u,d,p,m;if(h>0)if(u=a*l-o,d=a*o-l,m=i*h,u>=0)if(d>=-m)if(d<=m){const y=1/h;u*=y,d*=y,p=u*(u+a*d+2*o)+d*(a*u+d+2*l)+c}else d=i,u=Math.max(0,-(a*d+o)),p=-u*u+d*(d+2*l)+c;else d=-i,u=Math.max(0,-(a*d+o)),p=-u*u+d*(d+2*l)+c;else d<=-m?(u=Math.max(0,-(-a*i+o)),d=u>0?-i:Math.min(Math.max(-i,-l),i),p=-u*u+d*(d+2*l)+c):d<=m?(u=0,d=Math.min(Math.max(-i,-l),i),p=d*(d+2*l)+c):(u=Math.max(0,-(a*i+o)),d=u>0?i:Math.min(Math.max(-i,-l),i),p=-u*u+d*(d+2*l)+c);else d=a>0?-i:i,u=Math.max(0,-(a*d+o)),p=-u*u+d*(d+2*l)+c;return s&&s.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(Qs).addScaledVector(qt,d),p}intersectSphere(e,t){Me.subVectors(e.center,this.origin);const s=Me.dot(this.direction),r=Me.dot(Me)-s*s,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),o=s-a,l=s+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/t;return s>=0?s:null}intersectPlane(e,t){const s=this.distanceToPlane(e);return s===null?null:this.at(s,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let s,r,i,a,o,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(s=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(s=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),h>=0?(i=(e.min.y-d.y)*h,a=(e.max.y-d.y)*h):(i=(e.max.y-d.y)*h,a=(e.min.y-d.y)*h),s>a||i>r||((i>s||isNaN(s))&&(s=i),(a<r||isNaN(r))&&(r=a),u>=0?(o=(e.min.z-d.z)*u,l=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,l=(e.min.z-d.z)*u),s>l||o>r)||((o>s||s!==s)&&(s=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(s>=0?s:r,t)}intersectsBox(e){return this.intersectBox(e,Me)!==null}intersectTriangle(e,t,s,r,i){Os.subVectors(t,e),$t.subVectors(s,e),Ds.crossVectors(Os,$t);let a=this.direction.dot(Ds),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Ye.subVectors(this.origin,e);const l=o*this.direction.dot($t.crossVectors(Ye,$t));if(l<0)return null;const c=o*this.direction.dot(Os.cross(Ye));if(c<0||l+c>a)return null;const h=-o*Ye.dot(Ds);return h<0?null:this.at(h/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class re{constructor(e,t,s,r,i,a,o,l,c,h,u,d,p,m,y,b){re.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,s,r,i,a,o,l,c,h,u,d,p,m,y,b)}set(e,t,s,r,i,a,o,l,c,h,u,d,p,m,y,b){const x=this.elements;return x[0]=e,x[4]=t,x[8]=s,x[12]=r,x[1]=i,x[5]=a,x[9]=o,x[13]=l,x[2]=c,x[6]=h,x[10]=u,x[14]=d,x[3]=p,x[7]=m,x[11]=y,x[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new re().fromArray(this.elements)}copy(e){const t=this.elements,s=e.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],this}copyPosition(e){const t=this.elements,s=e.elements;return t[12]=s[12],t[13]=s[13],t[14]=s[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,s){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(e,t,s){return this.set(e.x,t.x,s.x,0,e.y,t.y,s.y,0,e.z,t.z,s.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,s=e.elements,r=1/dt.setFromMatrixColumn(e,0).length(),i=1/dt.setFromMatrixColumn(e,1).length(),a=1/dt.setFromMatrixColumn(e,2).length();return t[0]=s[0]*r,t[1]=s[1]*r,t[2]=s[2]*r,t[3]=0,t[4]=s[4]*i,t[5]=s[5]*i,t[6]=s[6]*i,t[7]=0,t[8]=s[8]*a,t[9]=s[9]*a,t[10]=s[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,s=e.x,r=e.y,i=e.z,a=Math.cos(s),o=Math.sin(s),l=Math.cos(r),c=Math.sin(r),h=Math.cos(i),u=Math.sin(i);if(e.order==="XYZ"){const d=a*h,p=a*u,m=o*h,y=o*u;t[0]=l*h,t[4]=-l*u,t[8]=c,t[1]=p+m*c,t[5]=d-y*c,t[9]=-o*l,t[2]=y-d*c,t[6]=m+p*c,t[10]=a*l}else if(e.order==="YXZ"){const d=l*h,p=l*u,m=c*h,y=c*u;t[0]=d+y*o,t[4]=m*o-p,t[8]=a*c,t[1]=a*u,t[5]=a*h,t[9]=-o,t[2]=p*o-m,t[6]=y+d*o,t[10]=a*l}else if(e.order==="ZXY"){const d=l*h,p=l*u,m=c*h,y=c*u;t[0]=d-y*o,t[4]=-a*u,t[8]=m+p*o,t[1]=p+m*o,t[5]=a*h,t[9]=y-d*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const d=a*h,p=a*u,m=o*h,y=o*u;t[0]=l*h,t[4]=m*c-p,t[8]=d*c+y,t[1]=l*u,t[5]=y*c+d,t[9]=p*c-m,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const d=a*l,p=a*c,m=o*l,y=o*c;t[0]=l*h,t[4]=y-d*u,t[8]=m*u+p,t[1]=u,t[5]=a*h,t[9]=-o*h,t[2]=-c*h,t[6]=p*u+m,t[10]=d-y*u}else if(e.order==="XZY"){const d=a*l,p=a*c,m=o*l,y=o*c;t[0]=l*h,t[4]=-u,t[8]=c*h,t[1]=d*u+y,t[5]=a*h,t[9]=p*u-m,t[2]=m*u-p,t[6]=o*h,t[10]=y*u+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Ph,e,_h)}lookAt(e,t,s){const r=this.elements;return le.subVectors(e,t),le.lengthSq()===0&&(le.z=1),le.normalize(),Be.crossVectors(s,le),Be.lengthSq()===0&&(Math.abs(s.z)===1?le.x+=1e-4:le.z+=1e-4,le.normalize(),Be.crossVectors(s,le)),Be.normalize(),es.crossVectors(le,Be),r[0]=Be.x,r[4]=es.x,r[8]=le.x,r[1]=Be.y,r[5]=es.y,r[9]=le.y,r[2]=Be.z,r[6]=es.z,r[10]=le.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const s=e.elements,r=t.elements,i=this.elements,a=s[0],o=s[4],l=s[8],c=s[12],h=s[1],u=s[5],d=s[9],p=s[13],m=s[2],y=s[6],b=s[10],x=s[14],g=s[3],R=s[7],Z=s[11],v=s[15],G=r[0],S=r[4],V=r[8],k=r[12],X=r[1],M=r[5],F=r[9],L=r[13],W=r[2],U=r[6],H=r[10],ae=r[14],oe=r[3],Y=r[7],B=r[11],_=r[15];return i[0]=a*G+o*X+l*W+c*oe,i[4]=a*S+o*M+l*U+c*Y,i[8]=a*V+o*F+l*H+c*B,i[12]=a*k+o*L+l*ae+c*_,i[1]=h*G+u*X+d*W+p*oe,i[5]=h*S+u*M+d*U+p*Y,i[9]=h*V+u*F+d*H+p*B,i[13]=h*k+u*L+d*ae+p*_,i[2]=m*G+y*X+b*W+x*oe,i[6]=m*S+y*M+b*U+x*Y,i[10]=m*V+y*F+b*H+x*B,i[14]=m*k+y*L+b*ae+x*_,i[3]=g*G+R*X+Z*W+v*oe,i[7]=g*S+R*M+Z*U+v*Y,i[11]=g*V+R*F+Z*H+v*B,i[15]=g*k+R*L+Z*ae+v*_,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],s=e[4],r=e[8],i=e[12],a=e[1],o=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],p=e[14],m=e[3],y=e[7],b=e[11],x=e[15];return m*(+i*l*u-r*c*u-i*o*d+s*c*d+r*o*p-s*l*p)+y*(+t*l*p-t*c*d+i*a*d-r*a*p+r*c*h-i*l*h)+b*(+t*c*u-t*o*p-i*a*u+s*a*p+i*o*h-s*c*h)+x*(-r*o*h-t*l*u+t*o*d+r*a*u-s*a*d+s*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,s){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=s),this}invert(){const e=this.elements,t=e[0],s=e[1],r=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],p=e[11],m=e[12],y=e[13],b=e[14],x=e[15],g=u*b*c-y*d*c+y*l*p-o*b*p-u*l*x+o*d*x,R=m*d*c-h*b*c-m*l*p+a*b*p+h*l*x-a*d*x,Z=h*y*c-m*u*c+m*o*p-a*y*p-h*o*x+a*u*x,v=m*u*l-h*y*l-m*o*d+a*y*d+h*o*b-a*u*b,G=t*g+s*R+r*Z+i*v;if(G===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/G;return e[0]=g*S,e[1]=(y*d*i-u*b*i-y*r*p+s*b*p+u*r*x-s*d*x)*S,e[2]=(o*b*i-y*l*i+y*r*c-s*b*c-o*r*x+s*l*x)*S,e[3]=(u*l*i-o*d*i-u*r*c+s*d*c+o*r*p-s*l*p)*S,e[4]=R*S,e[5]=(h*b*i-m*d*i+m*r*p-t*b*p-h*r*x+t*d*x)*S,e[6]=(m*l*i-a*b*i-m*r*c+t*b*c+a*r*x-t*l*x)*S,e[7]=(a*d*i-h*l*i+h*r*c-t*d*c-a*r*p+t*l*p)*S,e[8]=Z*S,e[9]=(m*u*i-h*y*i-m*s*p+t*y*p+h*s*x-t*u*x)*S,e[10]=(a*y*i-m*o*i+m*s*c-t*y*c-a*s*x+t*o*x)*S,e[11]=(h*o*i-a*u*i-h*s*c+t*u*c+a*s*p-t*o*p)*S,e[12]=v*S,e[13]=(h*y*r-m*u*r+m*s*d-t*y*d-h*s*b+t*u*b)*S,e[14]=(m*o*r-a*y*r-m*s*l+t*y*l+a*s*b-t*o*b)*S,e[15]=(a*u*r-h*o*r+h*s*l-t*u*l-a*s*d+t*o*d)*S,this}scale(e){const t=this.elements,s=e.x,r=e.y,i=e.z;return t[0]*=s,t[4]*=r,t[8]*=i,t[1]*=s,t[5]*=r,t[9]*=i,t[2]*=s,t[6]*=r,t[10]*=i,t[3]*=s,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],s=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,s,r))}makeTranslation(e,t,s){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,s,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,t,-s,0,0,s,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,0,s,0,0,1,0,0,-s,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,0,s,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const s=Math.cos(t),r=Math.sin(t),i=1-s,a=e.x,o=e.y,l=e.z,c=i*a,h=i*o;return this.set(c*a+s,c*o-r*l,c*l+r*o,0,c*o+r*l,h*o+s,h*l-r*a,0,c*l-r*o,h*l+r*a,i*l*l+s,0,0,0,0,1),this}makeScale(e,t,s){return this.set(e,0,0,0,0,t,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,t,s,r,i,a){return this.set(1,s,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,s){const r=this.elements,i=t._x,a=t._y,o=t._z,l=t._w,c=i+i,h=a+a,u=o+o,d=i*c,p=i*h,m=i*u,y=a*h,b=a*u,x=o*u,g=l*c,R=l*h,Z=l*u,v=s.x,G=s.y,S=s.z;return r[0]=(1-(y+x))*v,r[1]=(p+Z)*v,r[2]=(m-R)*v,r[3]=0,r[4]=(p-Z)*G,r[5]=(1-(d+x))*G,r[6]=(b+g)*G,r[7]=0,r[8]=(m+R)*S,r[9]=(b-g)*S,r[10]=(1-(d+y))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,s){const r=this.elements;let i=dt.set(r[0],r[1],r[2]).length();const a=dt.set(r[4],r[5],r[6]).length(),o=dt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],ye.copy(this);const l=1/i,c=1/a,h=1/o;return ye.elements[0]*=l,ye.elements[1]*=l,ye.elements[2]*=l,ye.elements[4]*=c,ye.elements[5]*=c,ye.elements[6]*=c,ye.elements[8]*=h,ye.elements[9]*=h,ye.elements[10]*=h,t.setFromRotationMatrix(ye),s.x=i,s.y=a,s.z=o,this}makePerspective(e,t,s,r,i,a,o=2e3){const l=this.elements,c=2*i/(t-e),h=2*i/(s-r),u=(t+e)/(t-e),d=(s+r)/(s-r);let p,m;if(o===2e3)p=-(a+i)/(a-i),m=-2*a*i/(a-i);else if(o===2001)p=-a/(a-i),m=-a*i/(a-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=h,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,s,r,i,a,o=2e3){const l=this.elements,c=1/(t-e),h=1/(s-r),u=1/(a-i),d=(t+e)*c,p=(s+r)*h;let m,y;if(o===2e3)m=(a+i)*u,y=-2*u;else if(o===2001)m=i*u,y=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=y,l[14]=-m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,s=e.elements;for(let r=0;r<16;r++)if(t[r]!==s[r])return!1;return!0}fromArray(e,t=0){for(let s=0;s<16;s++)this.elements[s]=e[s+t];return this}toArray(e=[],t=0){const s=this.elements;return e[t]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3],e[t+4]=s[4],e[t+5]=s[5],e[t+6]=s[6],e[t+7]=s[7],e[t+8]=s[8],e[t+9]=s[9],e[t+10]=s[10],e[t+11]=s[11],e[t+12]=s[12],e[t+13]=s[13],e[t+14]=s[14],e[t+15]=s[15],e}}const dt=new f,ye=new re,Ph=new f(0,0,0),_h=new f(1,1,1),Be=new f,es=new f,le=new f,ua=new re,da=new $e;class vt{constructor(e=0,t=0,s=0,r=vt.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=s,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,s,r=this._order){return this._x=e,this._y=t,this._z=s,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,s=!0){const r=e.elements,i=r[0],a=r[4],o=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],p=r[10];switch(t){case"XYZ":this._y=Math.asin(z(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-z(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(z(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,i));break;case"ZYX":this._y=Math.asin(-z(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,i)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(z(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-z(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,s===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,s){return ua.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ua,t,s)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return da.setFromEuler(this),this.setFromQuaternion(da,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}vt.DEFAULT_ORDER="XYZ";class Zc{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let jh=0;const pa=new f,pt=new $e,ke=new re,ts=new f,wt=new f,Ah=new f,Qh=new $e,ma=new f(1,0,0),ya=new f(0,1,0),ba=new f(0,0,1),xa={type:"added"},Oh={type:"removed"},mt={type:"childadded",child:null},qs={type:"childremoved",child:null};class Re extends ws{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jh++}),this.uuid=St(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Re.DEFAULT_UP.clone();const e=new f,t=new vt,s=new $e,r=new f(1,1,1);function i(){s.setFromEuler(t,!1)}function a(){t.setFromQuaternion(s,void 0,!1)}t._onChange(i),s._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new re},normalMatrix:{value:new Ue}}),this.matrix=new re,this.matrixWorld=new re,this.matrixAutoUpdate=Re.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Re.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Zc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return pt.setFromAxisAngle(e,t),this.quaternion.multiply(pt),this}rotateOnWorldAxis(e,t){return pt.setFromAxisAngle(e,t),this.quaternion.premultiply(pt),this}rotateX(e){return this.rotateOnAxis(ma,e)}rotateY(e){return this.rotateOnAxis(ya,e)}rotateZ(e){return this.rotateOnAxis(ba,e)}translateOnAxis(e,t){return pa.copy(e).applyQuaternion(this.quaternion),this.position.add(pa.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ma,e)}translateY(e){return this.translateOnAxis(ya,e)}translateZ(e){return this.translateOnAxis(ba,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ke.copy(this.matrixWorld).invert())}lookAt(e,t,s){e.isVector3?ts.copy(e):ts.set(e,t,s);const r=this.parent;this.updateWorldMatrix(!0,!1),wt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ke.lookAt(wt,ts,this.up):ke.lookAt(ts,wt,this.up),this.quaternion.setFromRotationMatrix(ke),r&&(ke.extractRotation(r.matrixWorld),pt.setFromRotationMatrix(ke),this.quaternion.premultiply(pt.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(xa),mt.child=e,this.dispatchEvent(mt),mt.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Oh),qs.child=e,this.dispatchEvent(qs),qs.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ke.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ke.multiply(e.parent.matrixWorld)),e.applyMatrix4(ke),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(xa),mt.child=e,this.dispatchEvent(mt),mt.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let s=0,r=this.children.length;s<r;s++){const i=this.children[s].getObjectByProperty(e,t);if(i!==void 0)return i}}getObjectsByProperty(e,t,s=[]){this[e]===t&&s.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,s);return s}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wt,e,Ah),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wt,Qh,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let s=0,r=t.length;s<r;s++)t[s].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let s=0,r=t.length;s<r;s++)t[s].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let s=0,r=t.length;s<r;s++)t[s].updateMatrixWorld(e)}updateWorldMatrix(e,t){const s=this.parent;if(e===!0&&s!==null&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",s={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(o=>({boxInitialized:o.boxInitialized,boxMin:o.box.min.toArray(),boxMax:o.box.max.toArray(),sphereInitialized:o.sphereInitialized,sphereRadius:o.sphere.radius,sphereCenter:o.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function i(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const u=l[c];i(e.shapes,u)}else i(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(i(e.materials,this.material[l]));r.material=o}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(i(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),h=a(e.images),u=a(e.shapes),d=a(e.skeletons),p=a(e.animations),m=a(e.nodes);o.length>0&&(s.geometries=o),l.length>0&&(s.materials=l),c.length>0&&(s.textures=c),h.length>0&&(s.images=h),u.length>0&&(s.shapes=u),d.length>0&&(s.skeletons=d),p.length>0&&(s.animations=p),m.length>0&&(s.nodes=m)}return s.object=r,s;function a(o){const l=[];for(const c in o){const h=o[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let s=0;s<e.children.length;s++){const r=e.children[s];this.add(r.clone())}return this}}Re.DEFAULT_UP=new f(0,1,0);Re.DEFAULT_MATRIX_AUTO_UPDATE=!0;Re.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const be=new f,we=new f,$s=new f,Le=new f,yt=new f,bt=new f,fa=new f,er=new f,tr=new f,sr=new f,rr=new Ct,ir=new Ct,nr=new Ct;class fe{constructor(e=new f,t=new f,s=new f){this.a=e,this.b=t,this.c=s}static getNormal(e,t,s,r){r.subVectors(s,t),be.subVectors(e,t),r.cross(be);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,s,r,i){be.subVectors(r,t),we.subVectors(s,t),$s.subVectors(e,t);const a=be.dot(be),o=be.dot(we),l=be.dot($s),c=we.dot(we),h=we.dot($s),u=a*c-o*o;if(u===0)return i.set(0,0,0),null;const d=1/u,p=(c*l-o*h)*d,m=(a*h-o*l)*d;return i.set(1-p-m,m,p)}static containsPoint(e,t,s,r){return this.getBarycoord(e,t,s,r,Le)===null?!1:Le.x>=0&&Le.y>=0&&Le.x+Le.y<=1}static getInterpolation(e,t,s,r,i,a,o,l){return this.getBarycoord(e,t,s,r,Le)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(i,Le.x),l.addScaledVector(a,Le.y),l.addScaledVector(o,Le.z),l)}static getInterpolatedAttribute(e,t,s,r,i,a){return rr.setScalar(0),ir.setScalar(0),nr.setScalar(0),rr.fromBufferAttribute(e,t),ir.fromBufferAttribute(e,s),nr.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(rr,i.x),a.addScaledVector(ir,i.y),a.addScaledVector(nr,i.z),a}static isFrontFacing(e,t,s,r){return be.subVectors(s,t),we.subVectors(e,t),be.cross(we).dot(r)<0}set(e,t,s){return this.a.copy(e),this.b.copy(t),this.c.copy(s),this}setFromPointsAndIndices(e,t,s,r){return this.a.copy(e[t]),this.b.copy(e[s]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,s,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,s),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return be.subVectors(this.c,this.b),we.subVectors(this.a,this.b),be.cross(we).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fe.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return fe.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,s,r,i){return fe.getInterpolation(e,this.a,this.b,this.c,t,s,r,i)}containsPoint(e){return fe.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fe.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const s=this.a,r=this.b,i=this.c;let a,o;yt.subVectors(r,s),bt.subVectors(i,s),er.subVectors(e,s);const l=yt.dot(er),c=bt.dot(er);if(l<=0&&c<=0)return t.copy(s);tr.subVectors(e,r);const h=yt.dot(tr),u=bt.dot(tr);if(h>=0&&u<=h)return t.copy(r);const d=l*u-h*c;if(d<=0&&l>=0&&h<=0)return a=l/(l-h),t.copy(s).addScaledVector(yt,a);sr.subVectors(e,i);const p=yt.dot(sr),m=bt.dot(sr);if(m>=0&&p<=m)return t.copy(i);const y=p*c-l*m;if(y<=0&&c>=0&&m<=0)return o=c/(c-m),t.copy(s).addScaledVector(bt,o);const b=h*m-p*u;if(b<=0&&u-h>=0&&p-m>=0)return fa.subVectors(i,r),o=(u-h)/(u-h+(p-m)),t.copy(r).addScaledVector(fa,o);const x=1/(b+y+d);return a=y*x,o=d*x,t.copy(s).addScaledVector(yt,a).addScaledVector(bt,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Gc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Je={h:0,s:0,l:0},ss={h:0,s:0,l:0};function ar(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class _e{constructor(e,t,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,s)}set(e,t,s){if(t===void 0&&s===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,s);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=xe){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,pe.toWorkingColorSpace(this,t),this}setRGB(e,t,s,r=pe.workingColorSpace){return this.r=e,this.g=t,this.b=s,pe.toWorkingColorSpace(this,r),this}setHSL(e,t,s,r=pe.workingColorSpace){if(e=Fh(e,1),t=z(t,0,1),s=z(s,0,1),t===0)this.r=this.g=this.b=s;else{const i=s<=.5?s*(1+t):s+t-s*t,a=2*s-i;this.r=ar(a,i,e+1/3),this.g=ar(a,i,e),this.b=ar(a,i,e-1/3)}return pe.toWorkingColorSpace(this,r),this}setStyle(e,t=xe){function s(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return s(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return s(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return s(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],a=i.length;if(a===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=xe){const s=Gc[e.toLowerCase()];return s!==void 0?this.setHex(s,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Te(e.r),this.g=Te(e.g),this.b=Te(e.b),this}copyLinearToSRGB(e){return this.r=Zt(e.r),this.g=Zt(e.g),this.b=Zt(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=xe){return pe.fromWorkingColorSpace(O.copy(this),e),Math.round(z(O.r*255,0,255))*65536+Math.round(z(O.g*255,0,255))*256+Math.round(z(O.b*255,0,255))}getHexString(e=xe){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=pe.workingColorSpace){pe.fromWorkingColorSpace(O.copy(this),t);const s=O.r,r=O.g,i=O.b,a=Math.max(s,r,i),o=Math.min(s,r,i);let l,c;const h=(o+a)/2;if(o===a)l=0,c=0;else{const u=a-o;switch(c=h<=.5?u/(a+o):u/(2-a-o),a){case s:l=(r-i)/u+(r<i?6:0);break;case r:l=(i-s)/u+2;break;case i:l=(s-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,t=pe.workingColorSpace){return pe.fromWorkingColorSpace(O.copy(this),t),e.r=O.r,e.g=O.g,e.b=O.b,e}getStyle(e=xe){pe.fromWorkingColorSpace(O.copy(this),e);const t=O.r,s=O.g,r=O.b;return e!==xe?`color(${e} ${t.toFixed(3)} ${s.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(s*255)},${Math.round(r*255)})`}offsetHSL(e,t,s){return this.getHSL(Je),this.setHSL(Je.h+e,Je.s+t,Je.l+s)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,s){return this.r=e.r+(t.r-e.r)*s,this.g=e.g+(t.g-e.g)*s,this.b=e.b+(t.b-e.b)*s,this}lerpHSL(e,t){this.getHSL(Je),e.getHSL(ss);const s=Js(Je.h,ss.h,t),r=Js(Je.s,ss.s,t),i=Js(Je.l,ss.l,t);return this.setHSL(s,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,s=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*s+i[6]*r,this.g=i[1]*t+i[4]*s+i[7]*r,this.b=i[2]*t+i[5]*s+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const O=new _e;_e.NAMES=Gc;let Dh=0;class Vn extends ws{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dh++}),this.uuid=St(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new _e(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const s=e[t];if(s===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(s):r&&r.isVector3&&s&&s.isVector3?r.copy(s):this[t]=s}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const s={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen!==void 0&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(s.dispersion=this.dispersion),this.iridescence!==void 0&&(s.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(s.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(s.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(s.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(s.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(s.combine=this.combine)),this.envMapRotation!==void 0&&(s.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(s.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(s.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(s.size=this.size),this.shadowSide!==null&&(s.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(s.blending=this.blending),this.side!==0&&(s.side=this.side),this.vertexColors===!0&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=!0),this.blendSrc!==204&&(s.blendSrc=this.blendSrc),this.blendDst!==205&&(s.blendDst=this.blendDst),this.blendEquation!==100&&(s.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(s.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(s.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(s.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(s.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(s.blendAlpha=this.blendAlpha),this.depthFunc!==3&&(s.depthFunc=this.depthFunc),this.depthTest===!1&&(s.depthTest=this.depthTest),this.depthWrite===!1&&(s.depthWrite=this.depthWrite),this.colorWrite===!1&&(s.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(s.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==519&&(s.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(s.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(s.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==7680&&(s.stencilFail=this.stencilFail),this.stencilZFail!==7680&&(s.stencilZFail=this.stencilZFail),this.stencilZPass!==7680&&(s.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(s.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),this.alphaHash===!0&&(s.alphaHash=!0),this.alphaToCoverage===!0&&(s.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=!0),this.forceSinglePass===!0&&(s.forceSinglePass=!0),this.wireframe===!0&&(s.wireframe=!0),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(s.flatShading=!0),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),this.fog===!1&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData);function r(i){const a=[];for(const o in i){const l=i[o];delete l.metadata,a.push(l)}return a}if(t){const i=r(e.textures),a=r(e.images);i.length>0&&(s.textures=i),a.length>0&&(s.images=a)}return s}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let s=null;if(t!==null){const r=t.length;s=new Array(r);for(let i=0;i!==r;++i)s[i]=t[i].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Ls extends Vn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vt,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const J=new f,rs=new w;class q{constructor(e,t,s=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=s,this.usage=35044,this.updateRanges=[],this.gpuType=1015,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,s){e*=this.itemSize,s*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[s+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,s=this.count;t<s;t++)rs.fromBufferAttribute(this,t),rs.applyMatrix3(e),this.setXY(t,rs.x,rs.y);else if(this.itemSize===3)for(let t=0,s=this.count;t<s;t++)J.fromBufferAttribute(this,t),J.applyMatrix3(e),this.setXYZ(t,J.x,J.y,J.z);return this}applyMatrix4(e){for(let t=0,s=this.count;t<s;t++)J.fromBufferAttribute(this,t),J.applyMatrix4(e),this.setXYZ(t,J.x,J.y,J.z);return this}applyNormalMatrix(e){for(let t=0,s=this.count;t<s;t++)J.fromBufferAttribute(this,t),J.applyNormalMatrix(e),this.setXYZ(t,J.x,J.y,J.z);return this}transformDirection(e){for(let t=0,s=this.count;t<s;t++)J.fromBufferAttribute(this,t),J.transformDirection(e),this.setXYZ(t,J.x,J.y,J.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let s=this.array[e*this.itemSize+t];return this.normalized&&(s=Vt(s,this.array)),s}setComponent(e,t,s){return this.normalized&&(s=se(s,this.array)),this.array[e*this.itemSize+t]=s,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Vt(t,this.array)),t}setX(e,t){return this.normalized&&(t=se(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Vt(t,this.array)),t}setY(e,t){return this.normalized&&(t=se(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Vt(t,this.array)),t}setZ(e,t){return this.normalized&&(t=se(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Vt(t,this.array)),t}setW(e,t){return this.normalized&&(t=se(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,s){return e*=this.itemSize,this.normalized&&(t=se(t,this.array),s=se(s,this.array)),this.array[e+0]=t,this.array[e+1]=s,this}setXYZ(e,t,s,r){return e*=this.itemSize,this.normalized&&(t=se(t,this.array),s=se(s,this.array),r=se(r,this.array)),this.array[e+0]=t,this.array[e+1]=s,this.array[e+2]=r,this}setXYZW(e,t,s,r,i){return e*=this.itemSize,this.normalized&&(t=se(t,this.array),s=se(s,this.array),r=se(r,this.array),i=se(i,this.array)),this.array[e+0]=t,this.array[e+1]=s,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==35044&&(e.usage=this.usage),e}}class qh extends q{constructor(e,t,s){super(new Uint16Array(e),t,s)}}class $h extends q{constructor(e,t,s){super(new Uint32Array(e),t,s)}}class he extends q{constructor(e,t,s){super(new Float32Array(e),t,s)}}let eu=0;const ue=new re,or=new Re,xt=new f,ce=new Ze,Lt=new Ze,j=new f;class ie extends ws{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:eu++}),this.uuid=St(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Ch(e)?$h:qh)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,s=0){this.groups.push({start:e,count:t,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const s=this.attributes.normal;if(s!==void 0){const i=new Ue().getNormalMatrix(e);s.applyNormalMatrix(i),s.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ue.makeRotationFromQuaternion(e),this.applyMatrix4(ue),this}rotateX(e){return ue.makeRotationX(e),this.applyMatrix4(ue),this}rotateY(e){return ue.makeRotationY(e),this.applyMatrix4(ue),this}rotateZ(e){return ue.makeRotationZ(e),this.applyMatrix4(ue),this}translate(e,t,s){return ue.makeTranslation(e,t,s),this.applyMatrix4(ue),this}scale(e,t,s){return ue.makeScale(e,t,s),this.applyMatrix4(ue),this}lookAt(e){return or.lookAt(e),or.updateMatrix(),this.applyMatrix4(or.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xt).negate(),this.translate(xt.x,xt.y,xt.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const s=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];s.push(a.x,a.y,a.z||0)}this.setAttribute("position",new he(s,3))}else{const s=Math.min(e.length,t.count);for(let r=0;r<s;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ze);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new f(-1/0,-1/0,-1/0),new f(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let s=0,r=t.length;s<r;s++){const i=t[s];ce.setFromBufferAttribute(i),this.morphTargetsRelative?(j.addVectors(this.boundingBox.min,ce.min),this.boundingBox.expandByPoint(j),j.addVectors(this.boundingBox.max,ce.max),this.boundingBox.expandByPoint(j)):(this.boundingBox.expandByPoint(ce.min),this.boundingBox.expandByPoint(ce.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new f,1/0);return}if(e){const s=this.boundingSphere.center;if(ce.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const o=t[i];Lt.setFromBufferAttribute(o),this.morphTargetsRelative?(j.addVectors(ce.min,Lt.min),ce.expandByPoint(j),j.addVectors(ce.max,Lt.max),ce.expandByPoint(j)):(ce.expandByPoint(Lt.min),ce.expandByPoint(Lt.max))}ce.getCenter(s);let r=0;for(let i=0,a=e.count;i<a;i++)j.fromBufferAttribute(e,i),r=Math.max(r,s.distanceToSquared(j));if(t)for(let i=0,a=t.length;i<a;i++){const o=t[i],l=this.morphTargetsRelative;for(let c=0,h=o.count;c<h;c++)j.fromBufferAttribute(o,c),l&&(xt.fromBufferAttribute(e,c),j.add(xt)),r=Math.max(r,s.distanceToSquared(j))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new q(new Float32Array(4*s.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let V=0;V<s.count;V++)o[V]=new f,l[V]=new f;const c=new f,h=new f,u=new f,d=new w,p=new w,m=new w,y=new f,b=new f;function x(V,k,X){c.fromBufferAttribute(s,V),h.fromBufferAttribute(s,k),u.fromBufferAttribute(s,X),d.fromBufferAttribute(i,V),p.fromBufferAttribute(i,k),m.fromBufferAttribute(i,X),h.sub(c),u.sub(c),p.sub(d),m.sub(d);const M=1/(p.x*m.y-m.x*p.y);isFinite(M)&&(y.copy(h).multiplyScalar(m.y).addScaledVector(u,-p.y).multiplyScalar(M),b.copy(u).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(M),o[V].add(y),o[k].add(y),o[X].add(y),l[V].add(b),l[k].add(b),l[X].add(b))}let g=this.groups;g.length===0&&(g=[{start:0,count:e.count}]);for(let V=0,k=g.length;V<k;++V){const X=g[V],M=X.start,F=X.count;for(let L=M,W=M+F;L<W;L+=3)x(e.getX(L+0),e.getX(L+1),e.getX(L+2))}const R=new f,Z=new f,v=new f,G=new f;function S(V){v.fromBufferAttribute(r,V),G.copy(v);const k=o[V];R.copy(k),R.sub(v.multiplyScalar(v.dot(k))).normalize(),Z.crossVectors(G,k);const X=Z.dot(l[V])<0?-1:1;a.setXYZW(V,R.x,R.y,R.z,X)}for(let V=0,k=g.length;V<k;++V){const X=g[V],M=X.start,F=X.count;for(let L=M,W=M+F;L<W;L+=3)S(e.getX(L+0)),S(e.getX(L+1)),S(e.getX(L+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let s=this.getAttribute("normal");if(s===void 0)s=new q(new Float32Array(t.count*3),3),this.setAttribute("normal",s);else for(let d=0,p=s.count;d<p;d++)s.setXYZ(d,0,0,0);const r=new f,i=new f,a=new f,o=new f,l=new f,c=new f,h=new f,u=new f;if(e)for(let d=0,p=e.count;d<p;d+=3){const m=e.getX(d+0),y=e.getX(d+1),b=e.getX(d+2);r.fromBufferAttribute(t,m),i.fromBufferAttribute(t,y),a.fromBufferAttribute(t,b),h.subVectors(a,i),u.subVectors(r,i),h.cross(u),o.fromBufferAttribute(s,m),l.fromBufferAttribute(s,y),c.fromBufferAttribute(s,b),o.add(h),l.add(h),c.add(h),s.setXYZ(m,o.x,o.y,o.z),s.setXYZ(y,l.x,l.y,l.z),s.setXYZ(b,c.x,c.y,c.z)}else for(let d=0,p=t.count;d<p;d+=3)r.fromBufferAttribute(t,d+0),i.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),h.subVectors(a,i),u.subVectors(r,i),h.cross(u),s.setXYZ(d+0,h.x,h.y,h.z),s.setXYZ(d+1,h.x,h.y,h.z),s.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),s.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,s=e.count;t<s;t++)j.fromBufferAttribute(e,t),j.normalize(),e.setXYZ(t,j.x,j.y,j.z)}toNonIndexed(){function e(o,l){const c=o.array,h=o.itemSize,u=o.normalized,d=new c.constructor(l.length*h);let p=0,m=0;for(let y=0,b=l.length;y<b;y++){o.isInterleavedBufferAttribute?p=l[y]*o.data.stride+o.offset:p=l[y]*h;for(let x=0;x<h;x++)d[m++]=c[p++]}return new q(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ie,s=this.index.array,r=this.attributes;for(const o in r){const l=r[o],c=e(l,s);t.setAttribute(o,c)}const i=this.morphAttributes;for(const o in i){const l=[],c=i[o];for(let h=0,u=c.length;h<u;h++){const d=c[h],p=e(d,s);l.push(p)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const s=this.attributes;for(const l in s){const c=s[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let i=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){const p=c[u];h.push(p.toJSON(e.data))}h.length>0&&(r[l]=h,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const s=e.index;s!==null&&this.setIndex(s.clone(t));const r=e.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(t))}const i=e.morphAttributes;for(const c in i){const h=[],u=i[c];for(let d=0,p=u.length;d<p;d++)h.push(u[d].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,h=a.length;c<h;c++){const u=a[c];this.addGroup(u.start,u.count,u.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ga=new re,Oe=new vn,is=new Sn,Ra=new f,ns=new f,as=new f,os=new f,lr=new f,ls=new f,Za=new f,cs=new f;class ge extends Re{constructor(e=new ie,t=new Ls){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const s=e[t[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,i=s.length;r<i;r++){const a=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,t){const s=this.geometry,r=s.attributes.position,i=s.morphAttributes.position,a=s.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(i&&o){ls.set(0,0,0);for(let l=0,c=i.length;l<c;l++){const h=o[l],u=i[l];h!==0&&(lr.fromBufferAttribute(u,e),a?ls.addScaledVector(lr,h):ls.addScaledVector(lr.sub(t),h))}t.add(ls)}return t}raycast(e,t){const s=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(s.boundingSphere===null&&s.computeBoundingSphere(),is.copy(s.boundingSphere),is.applyMatrix4(i),Oe.copy(e.ray).recast(e.near),!(is.containsPoint(Oe.origin)===!1&&(Oe.intersectSphere(is,Ra)===null||Oe.origin.distanceToSquared(Ra)>(e.far-e.near)**2))&&(ga.copy(i).invert(),Oe.copy(e.ray).applyMatrix4(ga),!(s.boundingBox!==null&&Oe.intersectsBox(s.boundingBox)===!1)&&this._computeIntersections(e,t,Oe)))}_computeIntersections(e,t,s){let r;const i=this.geometry,a=this.material,o=i.index,l=i.attributes.position,c=i.attributes.uv,h=i.attributes.uv1,u=i.attributes.normal,d=i.groups,p=i.drawRange;if(o!==null)if(Array.isArray(a))for(let m=0,y=d.length;m<y;m++){const b=d[m],x=a[b.materialIndex],g=Math.max(b.start,p.start),R=Math.min(o.count,Math.min(b.start+b.count,p.start+p.count));for(let Z=g,v=R;Z<v;Z+=3){const G=o.getX(Z),S=o.getX(Z+1),V=o.getX(Z+2);r=hs(this,x,e,s,c,h,u,G,S,V),r&&(r.faceIndex=Math.floor(Z/3),r.face.materialIndex=b.materialIndex,t.push(r))}}else{const m=Math.max(0,p.start),y=Math.min(o.count,p.start+p.count);for(let b=m,x=y;b<x;b+=3){const g=o.getX(b),R=o.getX(b+1),Z=o.getX(b+2);r=hs(this,a,e,s,c,h,u,g,R,Z),r&&(r.faceIndex=Math.floor(b/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let m=0,y=d.length;m<y;m++){const b=d[m],x=a[b.materialIndex],g=Math.max(b.start,p.start),R=Math.min(l.count,Math.min(b.start+b.count,p.start+p.count));for(let Z=g,v=R;Z<v;Z+=3){const G=Z,S=Z+1,V=Z+2;r=hs(this,x,e,s,c,h,u,G,S,V),r&&(r.faceIndex=Math.floor(Z/3),r.face.materialIndex=b.materialIndex,t.push(r))}}else{const m=Math.max(0,p.start),y=Math.min(l.count,p.start+p.count);for(let b=m,x=y;b<x;b+=3){const g=b,R=b+1,Z=b+2;r=hs(this,a,e,s,c,h,u,g,R,Z),r&&(r.faceIndex=Math.floor(b/3),t.push(r))}}}}function tu(n,e,t,s,r,i,a,o){let l;if(e.side===1?l=s.intersectTriangle(a,i,r,!0,o):l=s.intersectTriangle(r,i,a,e.side===0,o),l===null)return null;cs.copy(o),cs.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(cs);return c<t.near||c>t.far?null:{distance:c,point:cs.clone(),object:n}}function hs(n,e,t,s,r,i,a,o,l,c){n.getVertexPosition(o,ns),n.getVertexPosition(l,as),n.getVertexPosition(c,os);const h=tu(n,e,t,s,ns,as,os,Za);if(h){const u=new f;fe.getBarycoord(Za,ns,as,os,u),r&&(h.uv=fe.getInterpolatedAttribute(r,o,l,c,u,new w)),i&&(h.uv1=fe.getInterpolatedAttribute(i,o,l,c,u,new w)),a&&(h.normal=fe.getInterpolatedAttribute(a,o,l,c,u,new f),h.normal.dot(s.direction)>0&&h.normal.multiplyScalar(-1));const d={a:o,b:l,c,normal:new f,materialIndex:0};fe.getNormal(ns,as,os,d.normal),h.face=d,h.barycoord=u}return h}class Mn extends ie{constructor(e=1,t=1,s=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:s,widthSegments:r,heightSegments:i,depthSegments:a};const o=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const l=[],c=[],h=[],u=[];let d=0,p=0;m("z","y","x",-1,-1,s,t,e,a,i,0),m("z","y","x",1,-1,s,t,-e,a,i,1),m("x","z","y",1,1,e,s,t,r,a,2),m("x","z","y",1,-1,e,s,-t,r,a,3),m("x","y","z",1,-1,e,t,s,r,i,4),m("x","y","z",-1,-1,e,t,-s,r,i,5),this.setIndex(l),this.setAttribute("position",new he(c,3)),this.setAttribute("normal",new he(h,3)),this.setAttribute("uv",new he(u,2));function m(y,b,x,g,R,Z,v,G,S,V,k){const X=Z/S,M=v/V,F=Z/2,L=v/2,W=G/2,U=S+1,H=V+1;let ae=0,oe=0;const Y=new f;for(let B=0;B<H;B++){const _=B*M-L;for(let Ne=0;Ne<U;Ne++){const rt=Ne*X-F;Y[y]=rt*g,Y[b]=_*R,Y[x]=W,c.push(Y.x,Y.y,Y.z),Y[y]=0,Y[b]=0,Y[x]=G>0?1:-1,h.push(Y.x,Y.y,Y.z),u.push(Ne/S),u.push(1-B/V),ae+=1}}for(let B=0;B<V;B++)for(let _=0;_<S;_++){const Ne=d+_+U*B,rt=d+_+U*(B+1),Ys=d+(_+1)+U*(B+1),Kt=d+(_+1)+U*B;l.push(Ne,rt,Kt),l.push(rt,Ys,Kt),oe+=6}o.addGroup(p,oe,k),p+=oe,d+=ae}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}const cr=new f,su=new f,ru=new Ue;class iu{constructor(e=new f(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,s,r){return this.normal.set(e,t,s),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,s){const r=cr.subVectors(s,t).cross(su.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const s=e.delta(cr),r=this.normal.dot(s);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(s,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return t<0&&s>0||s<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const s=t||ru.getNormalMatrix(e),r=this.coplanarPoint(cr).applyMatrix4(e),i=this.normal.applyMatrix3(s).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}class kn extends Vn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new _e(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const vs=new f,Vs=new f,Ga=new re,Xt=new vn,us=new Sn,hr=new f,Sa=new f;class We extends Re{constructor(e=new ie,t=new kn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,s=[0];for(let r=1,i=t.count;r<i;r++)vs.fromBufferAttribute(t,r-1),Vs.fromBufferAttribute(t,r),s[r]=s[r-1],s[r]+=vs.distanceTo(Vs);e.setAttribute("lineDistance",new he(s,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const s=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=s.drawRange;if(s.boundingSphere===null&&s.computeBoundingSphere(),us.copy(s.boundingSphere),us.applyMatrix4(r),us.radius+=i,e.ray.intersectsSphere(us)===!1)return;Ga.copy(r).invert(),Xt.copy(e.ray).applyMatrix4(Ga);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=this.isLineSegments?2:1,h=s.index,u=s.attributes.position;if(h!==null){const d=Math.max(0,a.start),p=Math.min(h.count,a.start+a.count);for(let m=d,y=p-1;m<y;m+=c){const b=h.getX(m),x=h.getX(m+1),g=ds(this,e,Xt,l,b,x);g&&t.push(g)}if(this.isLineLoop){const m=h.getX(p-1),y=h.getX(d),b=ds(this,e,Xt,l,m,y);b&&t.push(b)}}else{const d=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);for(let m=d,y=p-1;m<y;m+=c){const b=ds(this,e,Xt,l,m,m+1);b&&t.push(b)}if(this.isLineLoop){const m=ds(this,e,Xt,l,p-1,d);m&&t.push(m)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const s=e[t[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,i=s.length;r<i;r++){const a=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function ds(n,e,t,s,r,i){const a=n.geometry.attributes.position;if(vs.fromBufferAttribute(a,r),Vs.fromBufferAttribute(a,i),t.distanceSqToSegment(vs,Vs,hr,Sa)>s)return;hr.applyMatrix4(n.matrixWorld);const o=e.ray.origin.distanceTo(hr);if(!(o<e.near||o>e.far))return{distance:o,point:Sa.clone().applyMatrix4(n.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:n}}const va=new f,Va=new f;class Xs extends We{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,s=[];for(let r=0,i=t.count;r<i;r+=2)va.fromBufferAttribute(t,r),Va.fromBufferAttribute(t,r+1),s[r]=r===0?0:s[r-1],s[r+1]=s[r]+va.distanceTo(Va);e.setAttribute("lineDistance",new he(s,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class ne extends Re{constructor(){super(),this.isGroup=!0,this.type="Group"}}class nu extends Ie{constructor(e,t,s,r,i,a,o,l,c){super(e,t,s,r,i,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ge{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const s=this.getUtoTmapping(e);return this.getPoint(s,t)}getPoints(e=5){const t=[];for(let s=0;s<=e;s++)t.push(this.getPoint(s/e));return t}getSpacedPoints(e=5){const t=[];for(let s=0;s<=e;s++)t.push(this.getPointAt(s/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let s,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)s=this.getPoint(a/e),i+=s.distanceTo(r),t.push(i),r=s;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const s=this.getLengths();let r=0;const i=s.length;let a;t?a=t:a=e*s[i-1];let o=0,l=i-1,c;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),c=s[r]-a,c<0)o=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,s[r]===a)return r/(i-1);const h=s[r],u=s[r+1]-h,d=(a-h)/u;return(r+d)/(i-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const i=this.getPoint(s),a=this.getPoint(r),o=t||(i.isVector2?new w:new f);return o.copy(a).sub(i).normalize(),o}getTangentAt(e,t){const s=this.getUtoTmapping(e);return this.getTangent(s,t)}computeFrenetFrames(e,t){const s=new f,r=[],i=[],a=[],o=new f,l=new re;for(let p=0;p<=e;p++){const m=p/e;r[p]=this.getTangentAt(m,new f)}i[0]=new f,a[0]=new f;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,s.set(1,0,0)),u<=c&&(c=u,s.set(0,1,0)),d<=c&&s.set(0,0,1),o.crossVectors(r[0],s).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(let p=1;p<=e;p++){if(i[p]=i[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(r[p-1],r[p]),o.length()>Number.EPSILON){o.normalize();const m=Math.acos(z(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(l.makeRotationAxis(o,m))}a[p].crossVectors(r[p],i[p])}if(t===!0){let p=Math.acos(z(i[0].dot(i[e]),-1,1));p/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(p=-p);for(let m=1;m<=e;m++)i[m].applyMatrix4(l.makeRotationAxis(r[m],p*m)),a[m].crossVectors(r[m],i[m])}return{tangents:r,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Et extends Ge{constructor(e=0,t=0,s=1,r=1,i=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=s,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t=new w){const s=t,r=Math.PI*2;let i=this.aEndAngle-this.aStartAngle;const a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(a?i=0:i=r),this.aClockwise===!0&&!a&&(i===r?i=-r:i=i-r);const o=this.aStartAngle+e*i;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,p=c-this.aY;l=d*h-p*u+this.aX,c=d*u+p*h+this.aY}return s.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class wn extends Et{constructor(e,t,s,r,i,a){super(e,t,s,s,r,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Ln(){let n=0,e=0,t=0,s=0;function r(i,a,o,l){n=i,e=o,t=-3*i+3*a-2*o-l,s=2*i-2*a+o+l}return{initCatmullRom:function(i,a,o,l,c){r(a,o,c*(o-i),c*(l-a))},initNonuniformCatmullRom:function(i,a,o,l,c,h,u){let d=(a-i)/c-(o-i)/(c+h)+(o-a)/h,p=(o-a)/h-(l-a)/(h+u)+(l-o)/u;d*=h,p*=h,r(a,o,d,p)},calc:function(i){const a=i*i,o=a*i;return n+e*i+t*a+s*o}}}const ps=new f,ur=new Ln,dr=new Ln,pr=new Ln;class au extends Ge{constructor(e=[],t=!1,s="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=s,this.tension=r}getPoint(e,t=new f){const s=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/i)+1)*i:l===0&&o===i-1&&(o=i-2,l=1);let c,h;this.closed||o>0?c=r[(o-1)%i]:(ps.subVectors(r[0],r[1]).add(r[0]),c=ps);const u=r[o%i],d=r[(o+1)%i];if(this.closed||o+2<i?h=r[(o+2)%i]:(ps.subVectors(r[i-1],r[i-2]).add(r[i-1]),h=ps),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let m=Math.pow(c.distanceToSquared(u),p),y=Math.pow(u.distanceToSquared(d),p),b=Math.pow(d.distanceToSquared(h),p);y<1e-4&&(y=1),m<1e-4&&(m=y),b<1e-4&&(b=y),ur.initNonuniformCatmullRom(c.x,u.x,d.x,h.x,m,y,b),dr.initNonuniformCatmullRom(c.y,u.y,d.y,h.y,m,y,b),pr.initNonuniformCatmullRom(c.z,u.z,d.z,h.z,m,y,b)}else this.curveType==="catmullrom"&&(ur.initCatmullRom(c.x,u.x,d.x,h.x,this.tension),dr.initCatmullRom(c.y,u.y,d.y,h.y,this.tension),pr.initCatmullRom(c.z,u.z,d.z,h.z,this.tension));return s.set(ur.calc(l),dr.calc(l),pr.calc(l)),s}copy(e){super.copy(e),this.points=[];for(let t=0,s=e.points.length;t<s;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,s=this.points.length;t<s;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,s=e.points.length;t<s;t++){const r=e.points[t];this.points.push(new f().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ma(n,e,t,s,r){const i=(s-e)*.5,a=(r-t)*.5,o=n*n,l=n*o;return(2*t-2*s+i+a)*l+(-3*t+3*s-2*i-a)*o+i*n+t}function ou(n,e){const t=1-n;return t*t*e}function lu(n,e){return 2*(1-n)*n*e}function cu(n,e){return n*n*e}function Tt(n,e,t,s){return ou(n,e)+lu(n,t)+cu(n,s)}function hu(n,e){const t=1-n;return t*t*t*e}function uu(n,e){const t=1-n;return 3*t*t*n*e}function du(n,e){return 3*(1-n)*n*n*e}function pu(n,e){return n*n*n*e}function It(n,e,t,s,r){return hu(n,e)+uu(n,t)+du(n,s)+pu(n,r)}class Sc extends Ge{constructor(e=new w,t=new w,s=new w,r=new w){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=s,this.v3=r}getPoint(e,t=new w){const s=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return s.set(It(e,r.x,i.x,a.x,o.x),It(e,r.y,i.y,a.y,o.y)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class mu extends Ge{constructor(e=new f,t=new f,s=new f,r=new f){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=s,this.v3=r}getPoint(e,t=new f){const s=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return s.set(It(e,r.x,i.x,a.x,o.x),It(e,r.y,i.y,a.y,o.y),It(e,r.z,i.z,a.z,o.z)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vc extends Ge{constructor(e=new w,t=new w){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new w){const s=t;return e===1?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(e).add(this.v1)),s}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new w){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yu extends Ge{constructor(e=new f,t=new f){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new f){const s=t;return e===1?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(e).add(this.v1)),s}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new f){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Vc extends Ge{constructor(e=new w,t=new w,s=new w){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=s}getPoint(e,t=new w){const s=t,r=this.v0,i=this.v1,a=this.v2;return s.set(Tt(e,r.x,i.x,a.x),Tt(e,r.y,i.y,a.y)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bu extends Ge{constructor(e=new f,t=new f,s=new f){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=s}getPoint(e,t=new f){const s=t,r=this.v0,i=this.v1,a=this.v2;return s.set(Tt(e,r.x,i.x,a.x),Tt(e,r.y,i.y,a.y),Tt(e,r.z,i.z,a.z)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Mc extends Ge{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new w){const s=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,l=r[a===0?a:a-1],c=r[a],h=r[a>r.length-2?r.length-1:a+1],u=r[a>r.length-3?r.length-1:a+2];return s.set(Ma(o,l.x,c.x,h.x,u.x),Ma(o,l.y,c.y,h.y,u.y)),s}copy(e){super.copy(e),this.points=[];for(let t=0,s=e.points.length;t<s;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,s=this.points.length;t<s;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,s=e.points.length;t<s;t++){const r=e.points[t];this.points.push(new w().fromArray(r))}return this}}var ka=Object.freeze({__proto__:null,ArcCurve:wn,CatmullRomCurve3:au,CubicBezierCurve:Sc,CubicBezierCurve3:mu,EllipseCurve:Et,LineCurve:vc,LineCurve3:yu,QuadraticBezierCurve:Vc,QuadraticBezierCurve3:bu,SplineCurve:Mc});class xu extends Ge{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const s=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new ka[s](t,e))}return this}getPoint(e,t){const s=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=s){const a=r[i]-s,o=this.curves[i],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let s=0,r=this.curves.length;s<r;s++)t+=this.curves[s].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let s=0;s<=e;s++)t.push(this.getPoint(s/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let s;for(let r=0,i=this.curves;r<i.length;r++){const a=i[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const h=l[c];s&&s.equals(h)||(t.push(h),s=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,s=e.curves.length;t<s;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,s=this.curves.length;t<s;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,s=e.curves.length;t<s;t++){const r=e.curves[t];this.curves.push(new ka[r.type]().fromJSON(r))}return this}}class bn extends xu{constructor(e){super(),this.type="Path",this.currentPoint=new w,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,s=e.length;t<s;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const s=new vc(this.currentPoint.clone(),new w(e,t));return this.curves.push(s),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,s,r){const i=new Vc(this.currentPoint.clone(),new w(e,t),new w(s,r));return this.curves.push(i),this.currentPoint.set(s,r),this}bezierCurveTo(e,t,s,r,i,a){const o=new Sc(this.currentPoint.clone(),new w(e,t),new w(s,r),new w(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),s=new Mc(t);return this.curves.push(s),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,s,r,i,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,t+l,s,r,i,a),this}absarc(e,t,s,r,i,a){return this.absellipse(e,t,s,s,r,i,a),this}ellipse(e,t,s,r,i,a,o,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,t+h,s,r,i,a,o,l),this}absellipse(e,t,s,r,i,a,o,l){const c=new Et(e,t,s,r,i,a,o,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class qe extends bn{constructor(e){super(e),this.uuid=St(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let s=0,r=this.holes.length;s<r;s++)t[s]=this.holes[s].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,s=e.holes.length;t<s;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,s=this.holes.length;t<s;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,s=e.holes.length;t<s;t++){const r=e.holes[t];this.holes.push(new bn().fromJSON(r))}return this}}const fu={triangulate:function(n,e,t=2){const s=e&&e.length,r=s?e[0]*t:n.length;let i=kc(n,0,r,t,!0);const a=[];if(!i||i.next===i.prev)return a;let o,l,c,h,u,d,p;if(s&&(i=Su(n,e,i,t)),n.length>80*t){o=c=n[0],l=h=n[1];for(let m=t;m<r;m+=t)u=n[m],d=n[m+1],u<o&&(o=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);p=Math.max(c-o,h-l),p=p!==0?32767/p:0}return Ut(i,a,t,o,l,p,0),a}};function kc(n,e,t,s,r){let i,a;if(r===Iu(n,e,t,s)>0)for(i=e;i<t;i+=s)a=wa(i,n[i],n[i+1],a);else for(i=t-s;i>=e;i-=s)a=wa(i,n[i],n[i+1],a);return a&&zs(a,a.next)&&(Ft(a),a=a.next),a}function et(n,e){if(!n)return n;e||(e=n);let t=n,s;do if(s=!1,!t.steiner&&(zs(t,t.next)||E(t.prev,t,t.next)===0)){if(Ft(t),t=e=t.prev,t===t.next)break;s=!0}else t=t.next;while(s||t!==e);return e}function Ut(n,e,t,s,r,i,a){if(!n)return;!a&&i&&wu(n,s,r,i);let o=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,i?Ru(n,s,r,i):gu(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Ft(n),n=c.next,o=c.next;continue}if(n=c,n===o){a?a===1?(n=Zu(et(n),e,t),Ut(n,e,t,s,r,i,2)):a===2&&Gu(n,e,t,s,r,i):Ut(et(n),e,t,s,r,i,1);break}}}function gu(n){const e=n.prev,t=n,s=n.next;if(E(e,t,s)>=0)return!1;const r=e.x,i=t.x,a=s.x,o=e.y,l=t.y,c=s.y,h=r<i?r<a?r:a:i<a?i:a,u=o<l?o<c?o:c:l<c?l:c,d=r>i?r>a?r:a:i>a?i:a,p=o>l?o>c?o:c:l>c?l:c;let m=s.next;for(;m!==e;){if(m.x>=h&&m.x<=d&&m.y>=u&&m.y<=p&&gt(r,o,i,l,a,c,m.x,m.y)&&E(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Ru(n,e,t,s){const r=n.prev,i=n,a=n.next;if(E(r,i,a)>=0)return!1;const o=r.x,l=i.x,c=a.x,h=r.y,u=i.y,d=a.y,p=o<l?o<c?o:c:l<c?l:c,m=h<u?h<d?h:d:u<d?u:d,y=o>l?o>c?o:c:l>c?l:c,b=h>u?h>d?h:d:u>d?u:d,x=xn(p,m,e,t,s),g=xn(y,b,e,t,s);let R=n.prevZ,Z=n.nextZ;for(;R&&R.z>=x&&Z&&Z.z<=g;){if(R.x>=p&&R.x<=y&&R.y>=m&&R.y<=b&&R!==r&&R!==a&&gt(o,h,l,u,c,d,R.x,R.y)&&E(R.prev,R,R.next)>=0||(R=R.prevZ,Z.x>=p&&Z.x<=y&&Z.y>=m&&Z.y<=b&&Z!==r&&Z!==a&&gt(o,h,l,u,c,d,Z.x,Z.y)&&E(Z.prev,Z,Z.next)>=0))return!1;Z=Z.nextZ}for(;R&&R.z>=x;){if(R.x>=p&&R.x<=y&&R.y>=m&&R.y<=b&&R!==r&&R!==a&&gt(o,h,l,u,c,d,R.x,R.y)&&E(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;Z&&Z.z<=g;){if(Z.x>=p&&Z.x<=y&&Z.y>=m&&Z.y<=b&&Z!==r&&Z!==a&&gt(o,h,l,u,c,d,Z.x,Z.y)&&E(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}return!0}function Zu(n,e,t){let s=n;do{const r=s.prev,i=s.next.next;!zs(r,i)&&wc(r,s,s.next,i)&&Nt(r,i)&&Nt(i,r)&&(e.push(r.i/t|0),e.push(s.i/t|0),e.push(i.i/t|0),Ft(s),Ft(s.next),s=n=i),s=s.next}while(s!==n);return et(s)}function Gu(n,e,t,s,r,i){let a=n;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&zu(a,o)){let l=Lc(a,o);a=et(a,a.next),l=et(l,l.next),Ut(a,e,t,s,r,i,0),Ut(l,e,t,s,r,i,0);return}o=o.next}a=a.next}while(a!==n)}function Su(n,e,t,s){const r=[];let i,a,o,l,c;for(i=0,a=e.length;i<a;i++)o=e[i]*s,l=i<a-1?e[i+1]*s:n.length,c=kc(n,o,l,s,!1),c===c.next&&(c.steiner=!0),r.push(Xu(c));for(r.sort(vu),i=0;i<r.length;i++)t=Vu(r[i],t);return t}function vu(n,e){return n.x-e.x}function Vu(n,e){const t=Mu(n,e);if(!t)return e;const s=Lc(t,n);return et(s,s.next),et(t,t.next)}function Mu(n,e){let t=e,s=-1/0,r;const i=n.x,a=n.y;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const d=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=i&&d>s&&(s=d,r=t.x<t.next.x?t:t.next,d===i))return r}t=t.next}while(t!==e);if(!r)return null;const o=r,l=r.x,c=r.y;let h=1/0,u;t=r;do i>=t.x&&t.x>=l&&i!==t.x&&gt(a<c?i:s,a,l,c,a<c?s:i,a,t.x,t.y)&&(u=Math.abs(a-t.y)/(i-t.x),Nt(t,n)&&(u<h||u===h&&(t.x>r.x||t.x===r.x&&ku(r,t)))&&(r=t,h=u)),t=t.next;while(t!==o);return r}function ku(n,e){return E(n.prev,n,e.prev)<0&&E(e.next,n,n.next)<0}function wu(n,e,t,s){let r=n;do r.z===0&&(r.z=xn(r.x,r.y,e,t,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,Lu(r)}function Lu(n){let e,t,s,r,i,a,o,l,c=1;do{for(t=n,n=null,i=null,a=0;t;){for(a++,s=t,o=0,e=0;e<c&&(o++,s=s.nextZ,!!s);e++);for(l=c;o>0||l>0&&s;)o!==0&&(l===0||!s||t.z<=s.z)?(r=t,t=t.nextZ,o--):(r=s,s=s.nextZ,l--),i?i.nextZ=r:n=r,r.prevZ=i,i=r;t=s}i.nextZ=null,c*=2}while(a>1);return n}function xn(n,e,t,s,r){return n=(n-t)*r|0,e=(e-s)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Xu(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function gt(n,e,t,s,r,i,a,o){return(r-a)*(e-o)>=(n-a)*(i-o)&&(n-a)*(s-o)>=(t-a)*(e-o)&&(t-a)*(i-o)>=(r-a)*(s-o)}function zu(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Wu(n,e)&&(Nt(n,e)&&Nt(e,n)&&Tu(n,e)&&(E(n.prev,n,e.prev)||E(n,e.prev,e))||zs(n,e)&&E(n.prev,n,n.next)>0&&E(e.prev,e,e.next)>0)}function E(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function zs(n,e){return n.x===e.x&&n.y===e.y}function wc(n,e,t,s){const r=ys(E(n,e,t)),i=ys(E(n,e,s)),a=ys(E(t,s,n)),o=ys(E(t,s,e));return!!(r!==i&&a!==o||r===0&&ms(n,t,e)||i===0&&ms(n,s,e)||a===0&&ms(t,n,s)||o===0&&ms(t,e,s))}function ms(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function ys(n){return n>0?1:n<0?-1:0}function Wu(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&wc(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Nt(n,e){return E(n.prev,n,n.next)<0?E(n,e,n.next)>=0&&E(n,n.prev,e)>=0:E(n,e,n.prev)<0||E(n,n.next,e)<0}function Tu(n,e){let t=n,s=!1;const r=(n.x+e.x)/2,i=(n.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(s=!s),t=t.next;while(t!==n);return s}function Lc(n,e){const t=new fn(n.i,n.x,n.y),s=new fn(e.i,e.x,e.y),r=n.next,i=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,s.next=t,t.prev=s,i.next=s,s.prev=i,s}function wa(n,e,t,s){const r=new fn(n,e,t);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function Ft(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function fn(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Iu(n,e,t,s){let r=0;for(let i=e,a=t-s;i<t;i+=s)r+=(n[a]-n[i])*(n[i+1]+n[a+1]),a=i;return r}class Gt{static area(e){const t=e.length;let s=0;for(let r=t-1,i=0;i<t;r=i++)s+=e[r].x*e[i].y-e[i].x*e[r].y;return s*.5}static isClockWise(e){return Gt.area(e)<0}static triangulateShape(e,t){const s=[],r=[],i=[];La(e),Xa(s,e);let a=e.length;t.forEach(La);for(let l=0;l<t.length;l++)r.push(a),a+=t[l].length,Xa(s,t[l]);const o=fu.triangulate(s,r);for(let l=0;l<o.length;l+=3)i.push(o.slice(l,l+3));return i}}function La(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function Xa(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Xn extends ie{constructor(e=1,t=1,s=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:s,heightSegments:r};const i=e/2,a=t/2,o=Math.floor(s),l=Math.floor(r),c=o+1,h=l+1,u=e/o,d=t/l,p=[],m=[],y=[],b=[];for(let x=0;x<h;x++){const g=x*d-a;for(let R=0;R<c;R++){const Z=R*u-i;m.push(Z,-g,0),y.push(0,0,1),b.push(R/o),b.push(1-x/l)}}for(let x=0;x<l;x++)for(let g=0;g<o;g++){const R=g+c*x,Z=g+c*(x+1),v=g+1+c*(x+1),G=g+1+c*x;p.push(R,Z,G),p.push(Z,v,G)}this.setIndex(p),this.setAttribute("position",new he(m,3)),this.setAttribute("normal",new he(y,3)),this.setAttribute("uv",new he(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xn(e.width,e.height,e.widthSegments,e.heightSegments)}}class Ht extends ie{constructor(e=new qe([new w(0,.5),new w(-.5,-.5),new w(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const s=[],r=[],i=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(o,l,h),o+=l,l=0;this.setIndex(s),this.setAttribute("position",new he(r,3)),this.setAttribute("normal",new he(i,3)),this.setAttribute("uv",new he(a,2));function c(h){const u=r.length/3,d=h.extractPoints(t);let p=d.shape;const m=d.holes;Gt.isClockWise(p)===!1&&(p=p.reverse());for(let b=0,x=m.length;b<x;b++){const g=m[b];Gt.isClockWise(g)===!0&&(m[b]=g.reverse())}const y=Gt.triangulateShape(p,m);for(let b=0,x=m.length;b<x;b++){const g=m[b];p=p.concat(g)}for(let b=0,x=p.length;b<x;b++){const g=p[b];r.push(g.x,g.y,0),i.push(0,0,1),a.push(g.x,g.y)}for(let b=0,x=y.length;b<x;b++){const g=y[b],R=g[0]+u,Z=g[1]+u,v=g[2]+u;s.push(R,Z,v),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Uu(t,e)}static fromJSON(e,t){const s=[];for(let r=0,i=e.shapes.length;r<i;r++){const a=t[e.shapes[r]];s.push(a)}return new Ht(s,e.curveSegments)}}function Uu(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,s=n.length;t<s;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class Nu extends Vn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new _e(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new w(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vt,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fu extends kn{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const za={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Cu{constructor(e,t,s){const r=this;let i=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=s,this.itemStart=function(h){o++,i===!1&&r.onStart!==void 0&&r.onStart(h,a,o),i=!0},this.itemEnd=function(h){a++,r.onProgress!==void 0&&r.onProgress(h,a,o),a===o&&(i=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,d=c.length;u<d;u+=2){const p=c[u],m=c[u+1];if(p.global&&(p.lastIndex=0),p.test(h))return m}return null}}}const Eu=new Cu;class zn{constructor(e){this.manager=e!==void 0?e:Eu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const s=this;return new Promise(function(r,i){s.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}zn.DEFAULT_MATERIAL_NAME="__DEFAULT";const Xe={};class Hu extends Error{constructor(e,t){super(e),this.response=t}}class Yu extends zn{constructor(e){super(e)}load(e,t,s,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=za.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(Xe[e]!==void 0){Xe[e].push({onLoad:t,onProgress:s,onError:r});return}Xe[e]=[],Xe[e].push({onLoad:t,onProgress:s,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=Xe[e],u=c.body.getReader(),d=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),p=d?parseInt(d):0,m=p!==0;let y=0;const b=new ReadableStream({start(x){g();function g(){u.read().then(({done:R,value:Z})=>{if(R)x.close();else{y+=Z.byteLength;const v=new ProgressEvent("progress",{lengthComputable:m,loaded:y,total:p});for(let G=0,S=h.length;G<S;G++){const V=h[G];V.onProgress&&V.onProgress(v)}x.enqueue(Z),g()}},R=>{x.error(R)})}}});return new Response(b)}else throw new Hu(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,o));case"json":return c.json();default:if(o===void 0)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(o),u=h&&h[1]?h[1].toLowerCase():void 0,d=new TextDecoder(u);return c.arrayBuffer().then(p=>d.decode(p))}}}).then(c=>{za.add(e,c);const h=Xe[e];delete Xe[e];for(let u=0,d=h.length;u<d;u++){const p=h[u];p.onLoad&&p.onLoad(c)}}).catch(c=>{const h=Xe[e];if(h===void 0)throw this.manager.itemError(e),c;delete Xe[e];for(let u=0,d=h.length;u<d;u++){const p=h[u];p.onError&&p.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}const Wa=new re;let Xc=class{constructor(n,e,t=0,s=1/0){this.ray=new vn(n,e),this.near=t,this.far=s,this.camera=null,this.layers=new Zc,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(n,e){this.ray.set(n,e)}setFromCamera(n,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(n.x,n.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(n.x,n.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}setFromXRController(n){return Wa.identity().extractRotation(n.matrixWorld),this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Wa),this}intersectObject(n,e=!0,t=[]){return gn(n,this,t,e),t.sort(Ta),t}intersectObjects(n,e=!0,t=[]){for(let s=0,r=n.length;s<r;s++)gn(n[s],this,t,e);return t.sort(Ta),t}};function Ta(n,e){return n.distance-e.distance}function gn(n,e,t,s){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&s===!0){const i=n.children;for(let a=0,o=i.length;a<o;a++)gn(i[a],e,t,!0)}}class Bu{constructor(){this.type="ShapePath",this.color=new _e,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new bn,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,s,r){return this.currentPath.quadraticCurveTo(e,t,s,r),this}bezierCurveTo(e,t,s,r,i,a){return this.currentPath.bezierCurveTo(e,t,s,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(x){const g=[];for(let R=0,Z=x.length;R<Z;R++){const v=x[R],G=new qe;G.curves=v.curves,g.push(G)}return g}function s(x,g){const R=g.length;let Z=!1;for(let v=R-1,G=0;G<R;v=G++){let S=g[v],V=g[G],k=V.x-S.x,X=V.y-S.y;if(Math.abs(X)>Number.EPSILON){if(X<0&&(S=g[G],k=-k,V=g[v],X=-X),x.y<S.y||x.y>V.y)continue;if(x.y===S.y){if(x.x===S.x)return!0}else{const M=X*(x.x-S.x)-k*(x.y-S.y);if(M===0)return!0;if(M<0)continue;Z=!Z}}else{if(x.y!==S.y)continue;if(V.x<=x.x&&x.x<=S.x||S.x<=x.x&&x.x<=V.x)return!0}}return Z}const r=Gt.isClockWise,i=this.subPaths;if(i.length===0)return[];let a,o,l;const c=[];if(i.length===1)return o=i[0],l=new qe,l.curves=o.curves,c.push(l),c;let h=!r(i[0].getPoints());h=e?!h:h;const u=[],d=[];let p=[],m=0,y;d[m]=void 0,p[m]=[];for(let x=0,g=i.length;x<g;x++)o=i[x],y=o.getPoints(),a=r(y),a=e?!a:a,a?(!h&&d[m]&&m++,d[m]={s:new qe,p:y},d[m].s.curves=o.curves,h&&m++,p[m]=[]):p[m].push({h:o,p:y[0]});if(!d[0])return t(i);if(d.length>1){let x=!1,g=0;for(let R=0,Z=d.length;R<Z;R++)u[R]=[];for(let R=0,Z=d.length;R<Z;R++){const v=p[R];for(let G=0;G<v.length;G++){const S=v[G];let V=!0;for(let k=0;k<d.length;k++)s(S.p,d[k].p)&&(R!==k&&g++,V?(V=!1,u[k].push(S)):x=!0);V&&u[R].push(S)}}g>0&&x===!1&&(p=u)}let b;for(let x=0,g=d.length;x<g;x++){l=d[x].s,c.push(l),b=p[x];for(let R=0,Z=b.length;R<Z;R++)l.holes.push(b[R].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gc}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=gc);class Ju extends zn{constructor(e){super(e)}load(e,t,s,r){const i=this,a=new Yu(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){const l=i.parse(JSON.parse(o));t&&t(l)},s,r)}parse(e){return new Ku(e)}}class Ku{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const s=[],r=Pu(e,t,this.data);for(let i=0,a=r.length;i<a;i++)s.push(...r[i].toShapes());return s}}function Pu(n,e,t){const s=Array.from(n),r=e/t.resolution,i=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,a=[];let o=0,l=0;for(let c=0;c<s.length;c++){const h=s[c];if(h===`
`)o=0,l-=i;else{const u=_u(h,r,o,l,t);o+=u.offsetX,a.push(u.path)}}return a}function _u(n,e,t,s,r){const i=r.glyphs[n]||r.glyphs["?"];if(!i){console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");return}const a=new Bu;let o,l,c,h,u,d,p,m;if(i.o){const y=i._cachedOutline||(i._cachedOutline=i.o.split(" "));for(let b=0,x=y.length;b<x;)switch(y[b++]){case"m":o=y[b++]*e+t,l=y[b++]*e+s,a.moveTo(o,l);break;case"l":o=y[b++]*e+t,l=y[b++]*e+s,a.lineTo(o,l);break;case"q":c=y[b++]*e+t,h=y[b++]*e+s,u=y[b++]*e+t,d=y[b++]*e+s,a.quadraticCurveTo(u,d,c,h);break;case"b":c=y[b++]*e+t,h=y[b++]*e+s,u=y[b++]*e+t,d=y[b++]*e+s,p=y[b++]*e+t,m=y[b++]*e+s,a.bezierCurveTo(u,d,p,m,c,h);break}}return{offsetX:i.ha*e,path:a}}class K{}ot(K,"cache",!0),ot(K,"showFrozen",!1),ot(K,"showLocked",!0),ot(K,"paperSpace",0),ot(K,"decimals",6),ot(K,"onBeforeTextDraw",null);class Ws{constructor(){this.callbacks=[]}subscribe(e,t){const s=this.callbacks.find(r=>r.name===e);typeof s<"u"?s.callbacks.push(t):this.callbacks.push({name:e,callbacks:[t]})}unSubscribe(e,t){const s=this.callbacks.find(r=>r.name===e);if(typeof s<"u"){let r=s.callbacks.indexOf(t);r>-1&&s.callbacks.splice(r,1),s.callbacks.length===0&&(r=this.callbacks.indexOf(s),r>-1&&this.callbacks.splice(r,1))}}hasSubscribers(e){return typeof this.callbacks.find(t=>t.name===e)<"u"}async trigger(e,...t){const s=this.callbacks.find(r=>r.name===e);if(typeof s<"u")for(const r of s.callbacks)r&&r.constructor.name==="AsyncFunction"?await r(...t):r(...t)}}var mr=new Map,Ia=1;class ju extends Ws{constructor(){super(),this.cache=!0}_getCached(e){if(!e._cache||!K.cache)return null;const t=e._cache;if(mr.has(t)){const s=mr.get(t).deref();if(s!==void 0)return s}return null}_setCache(e,t){if(!K.cache)return;const s="e"+Ia;e._cache=s,Ia++,mr.set(s,t)}}var yr={};class Wn{constructor(){}getMaterial(e,t,s){let r=this._getColorHex(e,s.layers),i=e.lineTypeName+t+r;if(yr[i])return yr[i];let a=t==="shape"?new Ls({side:2}):t==="line"?new kn:this._createDashedMaterial(e,s.ltypes);return a.color.setHex(r),a.color.convertSRGBToLinear(),a.name=i,yr[i]=a,a}_createDashedMaterial(e,t){let s=4,r=4,i=e.lineTypeName&&Object.prototype.hasOwnProperty.call(t,e.lineTypeName)?t[e.lineTypeName]:null;return r=i.pattern&&i.pattern.length>0?Math.max(...i.pattern.map(a=>a.length)):4,s=i.pattern&&i.pattern.length>0?i.pattern.map(a=>a.length===-1).length:4,r=r===0?4:r,new Fu({gapSize:s,dashSize:r})}_getColorHex(e,t){let s=e.fillColor?e.fillColor:e.colorNumber;if(!s||s===0){let r=Object.prototype.hasOwnProperty.call(t,e.layer)?t[e.layer]:null;if(r)return r.color}return this.getColorByNumber(s)}getColorByNumber(e){switch(e){case 0:return 0;case 1:return 16711680;case 2:return 16776960;case 3:return 65280;case 4:return 65535;case 5:return 255;case 6:return 16711935;case 7:return 16777215;case 8:return 4276545;case 9:return 8421504;case 10:return 16711680;case 11:return 16755370;case 12:return 12386304;case 13:return 12418686;case 14:return 8454144;case 15:return 8476246;case 16:return 6815744;case 17:return 6833477;case 18:return 5177344;case 19:return 5190965;case 20:return 16727808;case 21:return 16760746;case 22:return 12398080;case 23:return 12422526;case 24:return 8462080;case 25:return 8478806;case 26:return 6822144;case 27:return 6835781;case 28:return 5182208;case 29:return 5192501;case 30:return 16744192;case 31:return 16766122;case 32:return 12410368;case 33:return 12426622;case 34:return 8470528;case 35:return 8481622;case 36:return 6829056;case 37:return 6837829;case 38:return 5187328;case 39:return 5194293;case 40:return 16760576;case 41:return 16771754;case 42:return 12422400;case 43:return 12430718;case 44:return 8478720;case 45:return 8484438;case 46:return 6835712;case 47:return 6840133;case 48:return 5192448;case 49:return 5196085;case 50:return 16776960;case 51:return 16777130;case 52:return 12434688;case 53:return 12434814;case 54:return 8487168;case 55:return 8487254;case 56:return 6842368;case 57:return 6842437;case 58:return 5197568;case 59:return 5197621;case 60:return 12582656;case 61:return 15400874;case 62:return 9288960;case 63:return 11386238;case 64:return 6324480;case 65:return 7766358;case 66:return 5138432;case 67:return 6252613;case 68:return 3886848;case 69:return 4804405;case 70:return 8388352;case 71:return 13959082;case 72:return 6208768;case 73:return 10337662;case 74:return 4227328;case 75:return 7045462;case 76:return 3434496;case 77:return 5662789;case 78:return 2576128;case 79:return 4345653;case 80:return 4194048;case 81:return 12582826;case 82:return 3063040;case 83:return 9289086;case 84:return 2064640;case 85:return 6324566;case 86:return 1665024;case 87:return 5138501;case 88:return 1265408;case 89:return 3886901;case 90:return 65280;case 91:return 11206570;case 92:return 48384;case 93:return 8306046;case 94:return 33024;case 95:return 5669206;case 96:return 26624;case 97:return 4548677;case 98:return 20224;case 99:return 3493685;case 100:return 65343;case 101:return 11206591;case 102:return 48430;case 103:return 8306061;case 104:return 33055;case 105:return 5669216;case 106:return 26649;case 107:return 4548686;case 108:return 20243;case 109:return 3493691;case 110:return 65407;case 111:return 11206612;case 112:return 48478;case 113:return 8306077;case 114:return 33088;case 115:return 5669227;case 116:return 26676;case 117:return 4548694;case 118:return 20263;case 119:return 3493698;case 120:return 65471;case 121:return 11206634;case 122:return 48525;case 123:return 8306093;case 124:return 33120;case 125:return 5669238;case 126:return 26702;case 127:return 4548703;case 128:return 20283;case 129:return 3493705;case 130:return 65535;case 131:return 11206655;case 132:return 48573;case 133:return 8306109;case 134:return 33153;case 135:return 5669249;case 136:return 26728;case 137:return 4548712;case 138:return 20303;case 139:return 3493711;case 140:return 49151;case 141:return 11201279;case 142:return 36285;case 143:return 8302013;case 144:return 24705;case 145:return 5666433;case 146:return 20072;case 147:return 4546408;case 148:return 15183;case 149:return 3492175;case 150:return 32767;case 151:return 11195647;case 152:return 24253;case 153:return 8297917;case 154:return 16513;case 155:return 5663617;case 156:return 13416;case 157:return 4544104;case 158:return 10063;case 159:return 3490383;case 160:return 16383;case 161:return 11190271;case 162:return 11965;case 163:return 8293821;case 164:return 8065;case 165:return 5660801;case 166:return 6504;case 167:return 4542056;case 168:return 4943;case 169:return 3488591;case 170:return 255;case 171:return 11184895;case 172:return 189;case 173:return 8289981;case 174:return 129;case 175:return 5658241;case 176:return 104;case 177:return 4539752;case 178:return 79;case 179:return 3487055;case 180:return 4129023;case 181:return 12561151;case 182:return 3014845;case 183:return 9273021;case 184:return 2031745;case 185:return 6313601;case 186:return 1638504;case 187:return 5129576;case 188:return 1245263;case 189:return 3880271;case 190:return 8323327;case 191:return 13937407;case 192:return 6160573;case 193:return 10321597;case 194:return 4194433;case 195:return 7034497;case 196:return 3407976;case 197:return 5653864;case 198:return 2555983;case 199:return 4339023;case 200:return 12517631;case 201:return 15379199;case 202:return 9240765;case 203:return 11370173;case 204:return 6291585;case 205:return 7755393;case 206:return 5111912;case 207:return 6243688;case 208:return 3866703;case 209:return 4797775;case 210:return 16711935;case 211:return 16755455;case 212:return 12386493;case 213:return 12418749;case 214:return 8454273;case 215:return 8476289;case 216:return 6815848;case 217:return 6833512;case 218:return 5177423;case 219:return 5190991;case 220:return 16711871;case 221:return 16755434;case 222:return 12386445;case 223:return 12418733;case 224:return 8454240;case 225:return 8476278;case 226:return 6815822;case 227:return 6833503;case 228:return 5177403;case 229:return 5190985;case 230:return 16711807;case 231:return 16755412;case 232:return 12386398;case 233:return 12418717;case 234:return 8454208;case 235:return 8476267;case 236:return 6815796;case 237:return 6833494;case 238:return 5177383;case 239:return 5190978;case 240:return 16711743;case 241:return 16755391;case 242:return 12386350;case 243:return 12418701;case 244:return 8454175;case 245:return 8476256;case 246:return 6815769;case 247:return 6833486;case 248:return 5177363;case 249:return 5190971;case 250:return 3355443;case 251:return 5263440;case 252:return 6908265;case 253:return 8553090;case 254:return 12500670;case 255:return 16777215}return 16777215}}class Au{constructor(){this.xAxis=new f(1,0,0),this.yAxis=new f(0,1,0),this.zAxis=new f(0,0,1)}generatePointIndex(e){let t=[];for(let s=1;s<e.length;s++)t.push(s-1),t.push(s);return t}fixMeshToDrawDashedLines(e){e.geometry.index&&(e.geometry=e.geometry.toNonIndexed()),e.computeLineDistances()}}class zc{constructor(){}parse(e){const t={};let s=new Wn;const r=Object.keys(e);for(let i=0;i<r.length;i++){const a=e[r[i]];t[r[i]]={name:a.name,lineTypeName:a.lineTypeName,lineWeightEnum:a.lineWeightEnum,color:s.getColorByNumber(a.colorNumber),visible:this.isVisible(a),flags:this.parseFlags(a.flags)}}return t}parseFlags(e){if(e===0)return[];let t=[];return e%2!==0&&t.push("frozen"),(4<=e&&e<16||e===20||e===36||e===52)&&t.push("locked"),16<=e&&e<64&&t.push("dependent"),t}isVisible(e){return!(e.colorNumber<0||typeof e.plot<"u"&&!e.plot)}}class Se extends ju{constructor(e){super(),this.data=e,this._colorHelper=new Wn,this._geometryHelper=new Au,this._layerHelper=new zc}_hideEntity(e){if(typeof e.visible<"u"&&!e.visible||typeof e.paperSpace<"u"&&K.showFrozen!==e.paperSpace)return!0;let t=Object.prototype.hasOwnProperty.call(this.data.tables.layers,e.layer)?this.data.tables.layers[e.layer]:null;return!!(t&&(!t.visible||!K.showFrozen&&t.flags.includes("frozen")||!K.showLocked&&t.flags.includes("locked")))}_getBlock(e,t){for(let s=0;s<e.length;s++)if(e[s].name===t)return e[s];return null}}/**
 * @license
 * Credits to vagran (https://github.com/vagran/dxf-viewer) for the original code.
 */const P=Object.freeze({TEXT:0,ESCAPE:1,SKIP_FORMAT:2,PARAGRAPH1:3,PARAGRAPH2:4,PARAGRAPH3:5}),Ke=Object.freeze({TEXT:0,SCOPE:1,PARAGRAPH:2,NON_BREAKING_SPACE:3,PARAGRAPH_ALIGNMENT:4}),Qu=new Set(["L","l","O","o","K","k","P","X","~"]),Ou=new Set(["f","F","p","Q","H","W","S","A","C","T"]),Du=new Set(["\\","{","}"]);class Wt{constructor(){this.entities=[]}Parse(e){const t=e.length;let s=0,r=P.TEXT,i=[],a=this.entities,o=0;const l=this;function c(){r!==P.TEXT||s===o||(a.push({type:Ke.TEXT,content:e.slice(s,o)}),s=o)}function h(p){a.push({type:p})}function u(){const p={type:Ke.SCOPE,content:[]};a.push(p),a=p.content,i.push(p)}function d(){i.length!==0&&(i.pop(),i.length===0?a=l.entities:a=i[i.length-1].content)}for(;o<t;o++){const p=e.charAt(o);switch(r){case P.TEXT:if(p==="{"){c(),u(),s=o+1;continue}if(p==="}"){c(),d(),s=o+1;continue}if(p==="\\"){c(),r=P.ESCAPE;continue}continue;case P.ESCAPE:if(Qu.has(p)){switch(p){case"P":h(Ke.PARAGRAPH);break;case"~":h(Ke.NON_BREAKING_SPACE);break}r=P.TEXT,s=o+1;continue}if(Ou.has(p)){switch(p){case"p":r=P.PARAGRAPH1;continue}r=P.SKIP_FORMAT;continue}Du.has(p)?s=o:s=o-1,r=P.TEXT;continue;case P.PARAGRAPH1:r=p==="x"?P.PARAGRAPH2:P.SKIP_FORMAT;continue;case P.PARAGRAPH2:r=p==="q"?P.PARAGRAPH3:P.SKIP_FORMAT;continue;case P.PARAGRAPH3:a.push({type:Ke.PARAGRAPH_ALIGNMENT,alignment:p}),r=P.SKIP_FORMAT;continue;case P.SKIP_FORMAT:p===";"&&(s=o+1,r=P.TEXT);continue;default:throw new Error("Unhandled state")}}return c(),this}GetContent(){return this.entities}*GetText(){function*e(t){for(const s of t)s.type===Ke.TEXT?yield s.content:s.type===Ke.SCOPE&&(yield*e(s.content))}yield*e(this.GetContent())}}Wt.EntityType=Ke;var Ms,ks;const Rn=class Zn extends Se{static get TextHeight(){return sa(this,Ms)}static set TextHeight(e){ia(this,Ms,e||12)}static get TextScale(){return sa(this,ks)}static set TextScale(e){ia(this,ks,e||1)}constructor(e,t){super(e),this._font=t,this._textParser=new Wt}draw(e){let t=e.entities.filter(r=>r.type==="MTEXT"||r.type==="TEXT"||r.type==="ATTRIB");if(t.length===0)return null;let s=new ne;s.name="TEXTS";for(let r=0;r<t.length;r++){let i=t[r];if(this._hideEntity(i))continue;let a=this._getCached(i),o=null,l=null;if(a)o=a.geometry,l=a.material;else{let h=this.drawText(i);if(!h)continue;o=h.geometry,l=h.material,K.onBeforeTextDraw||this._setCache(i,h)}let c=new ge(o,l);c.userData={entity:i},s.add(c)}return s}drawText(e){if(e.type==="ATTRIB")return Object.keys(e.mtext).length!==0?this.drawText(e.mtext):this.drawText(e.text);let t=this._getTextGeometry(e);if(!t)return null;this._scaleText(t,e);let s=this._getPosAndRotation(e);s.rotation&&t.applyQuaternion(s.rotation),t.translate(s.pos.x,s.pos.y,s.pos.z),this._alignText(t,e,s.pos),this._translateCenter(t,e,s.pos);let r=this._colorHelper.getMaterial(e,"shape",this.data.tables);return{geometry:t,material:r}}_getTextGeometry(e){let t=this._getTextStrings(e);if(t.length===0)return null;let s=t.join("");if(K.onBeforeTextDraw){let a={text:s};K.onBeforeTextDraw(a),s=a.text}let r=this._getTextHeight(e),i=this._font.generateShapes(s,r);return new Ht(i)}_getTextHeight(e){let t=Zn.TextHeight;return typeof e.nominalTextHeight<"u"?t=e.nominalTextHeight:typeof e.textHeight<"u"&&(t=e.textHeight),t*=Zn.TextScale,t}_scaleText(e,t){e.computeBoundingBox();let s=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,i=typeof t.horizontalWidth<"u"?t.horizontalWidth/s:1,a=typeof t.verticalHeight<"u"?t.verticalHeight/r:1;e.scale(i,a,1)}_getTextStrings(e){if(typeof e.string>"u")return[];let t=r=>{let i=[];for(let a=0;a<r.length;a++){const o=r[a];if((o.type===Wt.EntityType.PARAGRAPH||o.type===Wt.EntityType.PARAGRAPH_ALIGNMENT)&&i.push(`
`),typeof o.content=="string")i.push(o.content);else if(o.content instanceof Array){let l=t(o.content);l&&i.push(l)}}return i},s=new Wt().Parse(e.string);return t(s.entities)}_getPosAndRotation(e){let t={pos:{x:0,y:0,z:0},rotation:null},s=e.x,r=e.y,i=e.z,a=e.rotation,o=e.xAxisX,l=e.xAxisY,c=e.xAxisZ,h=e.drawingDirection,u="0".repeat(K.decimals),d="0."+u,p="1."+u,m=typeof s<"u"?s.toFixed(K.decimals):d,y=typeof r<"u"?r.toFixed(K.decimals):d,b=typeof i<"u"?i.toFixed(K.decimals):d,x=m===p&&y===d&&b===d||m===d&&y===p&&b===d||m===d&&y===d&&b===p;return t.pos.x=x?o:s,t.pos.y=x?l:r,t.pos.z=x?c:i,a?t.rotation=new $e().setFromAxisAngle(this._geometryHelper.zAxis,a*Math.PI/180):(h===3||x&&r===1||!x&&l===1)&&(t.rotation=new $e().setFromAxisAngle(this._geometryHelper.zAxis,Math.PI/2)),t}_translateCenter(e,t,s){let r=t.attachmentPoint;e.computeBoundingBox();let i=e.boundingBox.max.x-e.boundingBox.min.x,a=e.boundingBox.max.y-e.boundingBox.min.y,o=e.boundingBox.max.z-e.boundingBox.min.z,l={x:e.boundingBox.min.x+i/2,y:e.boundingBox.min.y+a/2};if(!r){e.translate(s.x-e.boundingBox.min.x,s.y-e.boundingBox.min.y,-.5*o);return}switch(r){case 1:e.translate(s.x-e.boundingBox.min.x,s.y-e.boundingBox.max.y,-.5*o);break;case 2:e.translate(s.x-l.x,s.y-e.boundingBox.max.y,-.5*o);break;case 3:e.translate(s.x-e.boundingBox.max.x,s.y-e.boundingBox.max.y,-.5*o);break;case 4:e.translate(s.x-e.boundingBox.min.x,s.y-l.y,-.5*o);break;case 5:e.translate(s.x-l.x,s.y-l.y,-.5*o);break;case 6:e.translate(s.x-e.boundingBox.max.x,s.y-l.y,-.5*o);break;case 7:e.translate(s.x-e.boundingBox.min.x,s.y-e.boundingBox.min.y,-.5*o);break;case 8:e.translate(s.x-l.x,e.boundingBox.min.y,-.5*o);break;case 9:e.translate(s.x-e.boundingBox.max.x,e.boundingBox.min.y,-.5*o);break}}_alignText(e,t,s){e.computeBoundingBox();let r=e.boundingBox.max.x-e.boundingBox.min.x,i=e.boundingBox.max.y-e.boundingBox.min.y,a={x:e.boundingBox.min.x+r/2,y:e.boundingBox.min.y+i/2},o=0,l=i;switch(t.hAlign){case 0:o=s.x-e.boundingBox.min.x;break;case 1:o=s.x-a.x;break;case 2:o=s.x-e.boundingBox.max.x;break}switch(t.vAlign){case 0:l=s.y-a.y;break;case 1:l=i/2;break;case 2:l=s.y-a.y;break;case 3:l=s.y-e.boundingBox.max.y;break}e.translate(o,l,0)}_replaceSpecialChars(e){return e.replaceAll("\\P",`
`).replaceAll("\\X",`
`).replaceAll("%%d","").replaceAll("%%p","").replaceAll("%%c","").replaceAll("%%%","%")}};Ms=new WeakMap,ks=new WeakMap,ra(Rn,Ms,12),ra(Rn,ks,1);let De=Rn;var bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tn(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ua={},Na={},Fa={},Ca;function In(){return Ca||(Ca=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;function e(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(l){return typeof l}:e=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},e(o)}function t(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}function s(o,l){for(var c=0;c<l.length;c++){var h=l[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function r(o,l,c){return l&&s(o.prototype,l),o}var i=function(){function o(l,c){t(this,o),e(l)==="object"?(this.x=l.x,this.y=l.y):(this.x=l,this.y=c)}return r(o,[{key:"equals",value:function(l){return this.x===l.x&&this.y===l.y}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new o(-this.x,-this.y)}},{key:"add",value:function(l){return new o(this.x+l.x,this.y+l.y)}},{key:"sub",value:function(l){return new o(this.x-l.x,this.y-l.y)}},{key:"multiply",value:function(l){return new o(this.x*l,this.y*l)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(l){return this.x*l.x+this.y*l.y}}]),o}(),a=i;n.default=a}(Fa)),Fa}var Ea={},Ha;function Ts(){return Ha||(Ha=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;function e(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(l){return typeof l}:e=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},e(o)}function t(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}function s(o,l){for(var c=0;c<l.length;c++){var h=l[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function r(o,l,c){return l&&s(o.prototype,l),o}var i=function(){function o(l,c,h){t(this,o),e(l)==="object"?(this.x=l.x,this.y=l.y,this.z=l.z):l===void 0?(this.x=0,this.y=0,this.z=0):(this.x=l,this.y=c,this.z=h)}return r(o,[{key:"equals",value:function(l,c){return c===void 0&&(c=0),Math.abs(this.x-l.x)<=c&&Math.abs(this.y-l.y)<=c&&Math.abs(this.z-l.z)<=c}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new o(-this.x,-this.y,-this.z)}},{key:"add",value:function(l){return new o(this.x+l.x,this.y+l.y,this.z+l.z)}},{key:"sub",value:function(l){return new o(this.x-l.x,this.y-l.y,this.z-l.z)}},{key:"multiply",value:function(l){return new o(this.x*l,this.y*l,this.z*l)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(l){return this.x*l.x+this.y*l.y+this.z*l.z}},{key:"cross",value:function(l){return new o(this.y*l.z-this.z*l.y,this.z*l.x-this.x*l.z,this.x*l.y-this.y*l.x)}}]),o}(),a=i;n.default=a}(Ea)),Ea}var Ya={},Ba;function qu(){return Ba||(Ba=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(In());function t(c){return c&&c.__esModule?c:{default:c}}function s(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function(h){return typeof h}:s=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},s(c)}function r(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function i(c,h){for(var u=0;u<h.length;u++){var d=h[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function a(c,h,u){return h&&i(c.prototype,h),c}var o=function(){function c(h,u){if(r(this,c),s(h)==="object"&&s(u)==="object"&&h.x!==void 0&&h.y!==void 0&&u.x!==void 0&&u.y!==void 0)this.min=new e.default(h),this.max=new e.default(u),this.valid=!0;else if(h===void 0&&u===void 0)this.min=new e.default(1/0,1/0),this.max=new e.default(-1/0,-1/0),this.valid=!1;else throw Error("Illegal construction - must use { x, y } objects")}return a(c,[{key:"equals",value:function(h){if(!this.valid)throw Error("Box2 is invalid");return this.min.equals(h.min)&&this.max.equals(h.max)}},{key:"expandByPoint",value:function(h){return this.min=new e.default(Math.min(this.min.x,h.x),Math.min(this.min.y,h.y)),this.max=new e.default(Math.max(this.max.x,h.x),Math.max(this.max.y,h.y)),this.valid=!0,this}},{key:"expandByPoints",value:function(h){var u=this;return h.forEach(function(d){u.expandByPoint(d)},this),this}},{key:"isPointInside",value:function(h){return h.x>=this.min.x&&h.y>=this.min.y&&h.x<=this.max.x&&h.y<=this.max.y}},{key:"width",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.x-this.min.x}},{key:"height",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.y-this.min.y}}]),c}();o.fromPoints=function(c){return new o().expandByPoints(c)};var l=o;n.default=l}(Ya)),Ya}var Ja={},Ka;function $u(){return Ka||(Ka=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(Ts());function t(c){return c&&c.__esModule?c:{default:c}}function s(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function(h){return typeof h}:s=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},s(c)}function r(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function i(c,h){for(var u=0;u<h.length;u++){var d=h[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function a(c,h,u){return h&&i(c.prototype,h),c}var o=function(){function c(h,u){if(r(this,c),s(h)==="object"&&s(u)==="object"&&h.x!==void 0&&h.y!==void 0&&h.z!==void 0&&u.x!==void 0&&u.y!==void 0&&u.z!==void 0)this.min=new e.default(h),this.max=new e.default(u),this.valid=!0;else if(h===void 0&&u===void 0)this.min=new e.default(1/0,1/0,1/0),this.max=new e.default(-1/0,-1/0,-1/0),this.valid=!1;else throw Error("Illegal construction - must use { x, y, z } objects")}return a(c,[{key:"equals",value:function(h){if(!this.valid)throw Error("Box3 is invalid");return this.min.equals(h.min)&&this.max.equals(h.max)}},{key:"expandByPoint",value:function(h){return this.min=new e.default(Math.min(this.min.x,h.x),Math.min(this.min.y,h.y),Math.min(this.min.z,h.z)),this.max=new e.default(Math.max(this.max.x,h.x),Math.max(this.max.y,h.y),Math.max(this.max.z,h.z)),this.valid=!0,this}},{key:"expandByPoints",value:function(h){var u=this;return h.forEach(function(d){u.expandByPoint(d)},this),this}},{key:"isPointInside",value:function(h){return h.x>=this.min.x&&h.y>=this.min.y&&h.z>=this.min.z&&h.x<=this.max.x&&h.y<=this.max.y&&h.z<=this.max.z}},{key:"width",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.x-this.min.x}},{key:"depth",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.y-this.min.y}},{key:"height",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.z-this.min.z}}]),c}();o.fromPoints=function(c){return new o().expandByPoints(c)};var l=o;n.default=l}(Ja)),Ja}var Pa={},_a;function ed(){return _a||(_a=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;function e(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")}function t(a,o){for(var l=0;l<o.length;l++){var c=o[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}}function s(a,o,l){return o&&t(a.prototype,o),a}var r=function(){function a(o,l,c,h){e(this,a),this.a=o,this.b=l,this.c=c,this.d=h}return s(a,[{key:"distanceToPoint",value:function(o){var l=(this.a*o.x+this.b*o.y+this.c*o.z+this.d)/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);return l}},{key:"equals",value:function(o){return this.a===o.a&&this.b===o.b&&this.c===o.c&&this.d===o.d}},{key:"coPlanar",value:function(o){var l=this.a===o.a&&this.b===o.b&&this.c===o.c&&this.d===o.d,c=this.a===-o.a&&this.b===-o.b&&this.c===-o.c&&this.d===-o.d;return l||c}}]),a}();r.fromPointAndNormal=function(a,o){var l=o.x,c=o.y,h=o.z,u=-(a.x*l+a.y*c+a.z*h);return new r(o.x,o.y,o.z,u)},r.fromPoints=function(a){for(var o,l=0,c=a.length;l<c;++l){var h=a[(l+1)%c].sub(a[l]),u=a[(l+2)%c].sub(a[(l+1)%c]),d=h.cross(u);if(!(isNaN(d.length())||d.length()===0))if(!o)o=d.norm();else{var p=d.norm().equals(o,1e-6),m=d.neg().norm().equals(o,1e-6);if(!(p||m))throw Error("points not on a plane")}}if(!o)throw Error("points not on a plane");return r.fromPointAndNormal(a[0],o.norm())};var i=r;n.default=i}(Pa)),Pa}var ja={},Aa;function td(){return Aa||(Aa=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(Ts());function t(l){return l&&l.__esModule?l:{default:l}}function s(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function r(l,c){for(var h=0;h<c.length;h++){var u=c[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,u.key,u)}}function i(l,c,h){return c&&r(l.prototype,c),l}var a=function(){function l(c,h,u,d){s(this,l),this.x=c,this.y=h,this.z=u,this.w=d}return i(l,[{key:"applyToVec3",value:function(c){var h=c.x,u=c.y,d=c.z,p=this.x,m=this.y,y=this.z,b=this.w,x=b*h+m*d-y*u,g=b*u+y*h-p*d,R=b*d+p*u-m*h,Z=-p*h-m*u-y*d;return new e.default(x*b+Z*-p+g*-y-R*-m,g*b+Z*-m+R*-p-x*-y,R*b+Z*-y+x*-m-g*-p)}}]),l}();a.fromAxisAngle=function(l,c){var h=l.norm(),u=c/2,d=Math.sin(u);return new a(h.x*d,h.y*d,h.z*d,Math.cos(u))};var o=a;n.default=o}(ja)),ja}var Qa={},Oa;function sd(){return Oa||(Oa=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(In());function t(p){return p&&p.__esModule?p:{default:p}}function s(p){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function(m){return typeof m}:s=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},s(p)}function r(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function i(p,m){for(var y=0;y<m.length;y++){var b=m[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}function a(p,m,y){return m&&i(p.prototype,m),p}var o=function(p,m,y){var b=p.x,x=p.y,g=m.x,R=m.y,Z=y.x,v=y.y,G=(v-x)*(g-b),S=(R-x)*(Z-b);return G>S+Number.EPSILON?1:G+Number.EPSILON<S?-1:0},l=function(p,m){var y=p.a,b=p.b,x=m.a,g=m.b;return o(y,x,g)!==o(b,x,g)&&o(y,b,x)!==o(y,b,g)},c=function(p,m){var y=p.a.x,b=p.b.x,x=p.a.y,g=p.b.y,R=m.a.x,Z=m.b.x,v=m.a.y,G=m.b.y,S=y-b,V=R-Z,k=x-g,X=v-G,M=S*X-k*V,F=((y*g-x*b)*V-S*(R*G-v*Z))/M,L=((y*g-x*b)*X-k*(R*G-v*Z))/M;return isNaN(F)||isNaN(L)?null:new e.default(F,L)},h=function(p,m){return Math.sqrt(Math.pow(p.x-m.x,2)+Math.pow(p.y-m.y,2))},u=function(){function p(m,y){if(r(this,p),s(m)!=="object"||m.x===void 0||m.y===void 0)throw Error("expected first argument to have x and y properties");if(s(y)!=="object"||y.x===void 0||y.y===void 0)throw Error("expected second argument to have x and y properties");this.a=new e.default(m),this.b=new e.default(y)}return a(p,[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"intersects",value:function(m){if(!(m instanceof p))throw new Error("expected argument to be an instance of vecks.Line2");return l(this,m)}},{key:"getIntersection",value:function(m){return this.intersects(m)?c(this,m):null}},{key:"containsPoint",value:function(m){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e-12;return Math.abs(h(this.a,this.b)-h(m,this.a)-h(m,this.b))<y}}]),p}(),d=u;n.default=d}(Qa)),Qa}var Da={},qa;function rd(){return qa||(qa=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(Ts());function t(h){return h&&h.__esModule?h:{default:h}}function s(h){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function(u){return typeof u}:s=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},s(h)}function r(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function i(h,u){for(var d=0;d<u.length;d++){var p=u[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}function a(h,u,d){return u&&i(h.prototype,u),h}var o=function(h,u){return Math.sqrt(Math.pow(h.x-u.x,2)+Math.pow(h.y-u.y,2)+Math.pow(h.z-u.z,2))},l=function(){function h(u,d){if(r(this,h),s(u)!=="object"||u.x===void 0||u.y===void 0||u.z===void 0)throw Error("expected first argument to have x, y and z properties");if(s(d)!=="object"||d.x===void 0||d.y===void 0||d.y===void 0)throw Error("expected second argument to have x, y and z properties");this.a=new e.default(u),this.b=new e.default(d)}return a(h,[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"containsPoint",value:function(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e-12;return Math.abs(o(this.a,this.b)-o(u,this.a)-o(u,this.b))<d}}]),h}(),c=l;n.default=c}(Da)),Da}var $a;function Wc(){return $a||($a=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"V2",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"V3",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"Box2",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"Box3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"Plane3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"Quaternion",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"Line2",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"Line3",{enumerable:!0,get:function(){return l.default}});var e=c(In()),t=c(Ts()),s=c(qu()),r=c($u()),i=c(ed()),a=c(td()),o=c(sd()),l=c(rd());function c(h){return h&&h.__esModule?h:{default:h}}}(Na)),Na}var eo;function id(){return eo||(eo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=Wc();n.default=function(t,s,r,i){i||(i=5);var a,o,l;r<0?(a=Math.atan(-r)*4,o=new e.V2(t[0],t[1]),l=new e.V2(s[0],s[1])):(a=Math.atan(r)*4,o=new e.V2(s[0],s[1]),l=new e.V2(t[0],t[1]));var c=l.sub(o),h=c.length(),u=o.add(c.multiply(.5)),d=Math.abs(h/2/Math.tan(a/2)),p=c.norm(),m;if(a<Math.PI){var y=new e.V2(p.x*Math.cos(Math.PI/2)-p.y*Math.sin(Math.PI/2),p.y*Math.cos(Math.PI/2)+p.x*Math.sin(Math.PI/2));m=u.add(y.multiply(-d))}else{var b=new e.V2(p.x*Math.cos(Math.PI/2)-p.y*Math.sin(Math.PI/2),p.y*Math.cos(Math.PI/2)+p.x*Math.sin(Math.PI/2));m=u.add(b.multiply(d))}var x=Math.atan2(l.y-m.y,l.x-m.x)/Math.PI*180,g=Math.atan2(o.y-m.y,o.x-m.x)/Math.PI*180;g<x&&(g+=360);for(var R=l.sub(m).length(),Z=Math.floor(x/i)*i+i,v=Math.ceil(g/i)*i-i,G=[],S=Z;S<=v;S+=i)G.push(m.add(new e.V2(Math.cos(S/180*Math.PI)*R,Math.sin(S/180*Math.PI)*R)));return r<0&&G.reverse(),G.map(function(V){return[V.x,V.y]})}}(Ua)),Ua}var nd=id();const ad=Tn(nd);class Is extends Se{constructor(e){super(e)}draw(e){let t=new ne;t.name="LINES";let s=e.entities.filter(r=>r.type==="LINE"||r.type==="POLYLINE"||r.type==="LWPOLYLINE");if(s.length===0)return null;for(let r=0;r<s.length;r++){let i=s[r];if(this._hideEntity(i))continue;let a=this._getCached(i),o=null,l=null;if(a)o=a.geometry,l=a.material;else{let h=i.type==="LINE"?this.drawLine(i):this.drawPolyLine(i);o=h.geometry,l=h.material,this._setCache(i,h)}let c=new We(o,l);l.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(c),c.userData={entity:i},t.add(c)}return t}drawLine(e,t=1){let s="line";if(e.lineTypeName){let a=this.data.tables.ltypes[e.lineTypeName];a&&a.pattern.length>0&&(s="dashed")}let r=this._colorHelper.getMaterial(e,s,this.data.tables),i=new ie().setFromPoints([{x:t*e.start.x,y:e.start.y,z:e.start.z},{x:t*e.end.x,y:e.end.y,z:e.end.z}]);return i.setIndex(new q(new Uint16Array([0,1]),1)),{geometry:i,material:r}}drawPolyLine(e){let t="line";if(e.lineTypeName){let a=this.data.tables.ltypes[e.lineTypeName];a&&a.pattern.length>0&&(t="dashed")}let s=this._colorHelper.getMaterial(e,t,this.data.tables),r=this._getPolyLinePoints(e.vertices,e.closed),i=new ie().setFromPoints(r);return i.setIndex(new q(new Uint16Array(this._geometryHelper.generatePointIndex(r)),1)),{geometry:i,material:s}}_getPolyLinePoints(e,t,s=1){let r=[];const i=new f,a=new f;for(let o=0,l=e.length;o<l-1;++o){let c=e[o],h=e[o+1],u=e[o].bulge;if(i.set(c.x,c.y,c.z),a.set(h.x,h.y,h.z),r.push({x:c.x,y:c.y,z:c.z}),u){let d=ad([c.x,c.y,c.z],[h.x,h.y,h.z],u);for(let p=0,m=d.length;p<m;++p){const y=d[p];r.push({x:s*y[0],y:y[1],z:y.length>2?y[2]:0})}}o===l-2&&r.push({x:h.x,y:h.y,z:h.z})}return t&&r.push(r[0]),r}}class Un extends Se{constructor(e){super(e)}draw(e){let t=e.entities.filter(r=>r.type==="SOLID");if(t.length===0)return null;let s=new ne;s.name="SOLIDS";for(let r=0;r<t.length;r++){let i=t[r];if(this._hideEntity(i))continue;let a=this._getCached(i),o=null,l=null;if(a)o=a.geometry,l=a.material;else{let h=this.drawSolid(i);o=h.geometry,l=h.material,this._setCache(i,h)}let c=new ge(o,l);c.userData={entity:i},s.add(c)}return s}drawSolid(e){let t=this._colorHelper.getMaterial(e,"shape",this.data.tables),s=e.corners.map(a=>new f(a.x,a.y,a.z));s.splice(0,0,s.pop());const r=new qe(s);let i=new Ht(r);return this._extrusionTransform(e,i),{geometry:i,material:t}}_extrusionTransform(e,t){e.extrusionZ<0&&t.scale(-1,1,1)}}class Tc extends Se{constructor(e){super(e)}draw(e){let t=e.entities.filter(r=>r.type==="ARC"||r.type==="CIRCLE"||r.type==="ELLIPSE");if(t.length===0)return null;let s=new ne;s.name="CIRCLES";for(let r=0;r<t.length;r++){let i=t[r];if(this._hideEntity(i))continue;let a=this._getCached(i),o=null,l=null;if(a)o=a.geometry,l=a.material;else{let h=i.type==="ELLIPSE"?this.drawEllipse(i):this.drawCircle(i);o=h.geometry,l=h.material,this._setCache(i,h)}let c=new We(o,l);l.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(c),c.userData={entity:i},s.add(c)}return s}drawCircle(e){let t="line";if(e.lineTypeName){let c=this.data.tables.ltypes[e.lineTypeName];c&&c.pattern.length>0&&(t="dashed")}let s=this._colorHelper.getMaterial(e,t,this.data.tables),r,i;if(e.type==="CIRCLE")r=e.startAngle||0,i=r+2*Math.PI;else if(r=e.startAngle,i=e.endAngle,e.extrusionZ<0){let c=this._rotateXY(e.startAngle,e.endAngle);r=c[1],i=c[0]}let a=new wn(0,0,e.r,r,i).getPoints(32),o=new ie().setFromPoints(a);o.setIndex(new q(new Uint16Array(this._geometryHelper.generatePointIndex(a)),1));let l={x:e.center?e.center.x:e.x,y:e.center?e.center.y:e.y,z:e.center?e.center.z:e.z};return o.translate(e.extrusionZ<0?-l.x:l.x,l.y,l.z),{geometry:o,material:s}}drawEllipse(e){let t="line";if(e.lineTypeName){let h=this.data.tables.ltypes[e.lineTypeName];h&&h.pattern.length>0&&(t="dashed")}let s=this._colorHelper.getMaterial(e,t,this.data.tables),r=Math.sqrt(Math.pow(e.majorX,2)+Math.pow(e.majorY,2)),i=r*e.axisRatio,a=Math.atan2(e.majorY,e.extrusionZ<0?-e.majorX:e.majorX),o={x:e.center?e.center.x:e.x,y:e.center?e.center.y:e.y,z:e.center?e.center.z:e.z},l=new Et(o.x,o.y,r,i,e.startAngle,e.endAngle,!1,a).getPoints(32),c=new ie().setFromPoints(l);return c.setIndex(new q(new Uint16Array(this._geometryHelper.generatePointIndex(l)),1)),this._extrusionTransform(e,c,o),{geometry:c,material:s}}_extrusionTransform(e,t,s){e.extrusionZ<0&&(t.translate(-s.x,-s.y,-s.z),t.scale(-1,1,1),t.translate(s.x,s.y,s.z))}_rotateXY(e,t){const s=this._geometryHelper.xAxis.clone().applyAxisAngle(this._geometryHelper.zAxis,e),r=this._geometryHelper.xAxis.clone().applyAxisAngle(this._geometryHelper.zAxis,t);return s.applyAxisAngle(this._geometryHelper.yAxis,Math.PI),r.applyAxisAngle(this._geometryHelper.yAxis,Math.PI),[Math.atan2(s.y,s.x),Math.atan2(r.y,r.x)]}}var to={},so={},ro;function od(){return ro||(ro=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default=function(e,t){return typeof t>"u"||+t==0?Math.round(e):(e=+e,t=+t,isNaN(e)||!(typeof t=="number"&&t%1===0)?NaN:(e=e.toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),e=e.toString().split("e"),+(e[0]+"e"+(e[1]?+e[1]+t:t))))}}(so)),so}var io;function ld(){return io||(io=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(od());function t(s){return s&&s.__esModule?s:{default:s}}n.default=function(s,r,i,a,o){var l=i.length,c=i[0].length;if(s<0||s>1)throw new Error("t out of bounds [0,1]: "+s);if(r<1)throw new Error("degree must be at least 1 (linear)");if(r>l-1)throw new Error("degree must be less than or equal to point count - 1");if(!o){o=[];for(var h=0;h<l;h++)o[h]=1}if(a){if(a.length!==l+r+1)throw new Error("bad knot vector length")}else{a=[];for(var u=0;u<l+r+1;u++)a[u]=u}var d=[r,a.length-1-r],p=a[d[0]],m=a[d[1]];s=s*(m-p)+p,s=Math.max(s,p),s=Math.min(s,m);var y;for(y=d[0];y<d[1]&&!(s>=a[y]&&s<=a[y+1]);y++);for(var b=[],x=0;x<l;x++){b[x]=[];for(var g=0;g<c;g++)b[x][g]=i[x][g]*o[x];b[x][c]=o[x]}for(var R,Z=1;Z<=r+1;Z++)for(var v=y;v>y-r-1+Z;v--){R=(s-a[v])/(a[v+r+1-Z]-a[v]);for(var G=0;G<c+1;G++)b[v][G]=(1-R)*b[v-1][G]+R*b[v][G]}for(var S=[],V=0;V<c;V++)S[V]=(0,e.default)(b[y][V]/b[y][c],-9);return S}}(to)),to}var cd=ld();const hd=Tn(cd);class Nn extends Se{constructor(e){super(e)}draw(e){let t=e.entities.filter(r=>r.type==="SPLINE");if(t.length===0)return null;let s=new ne;s.name="SPLINES";for(let r=0;r<t.length;r++){let i=t[r];if(this._hideEntity(i))continue;let a=this._getCached(i),o=null,l=null;if(a)o=a.geometry,l=a.material;else{let h=this.drawSpline(i);o=h.geometry,l=h.material,this._setCache(i,h)}let c=new We(o,l);l.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(c),c.userData={entity:i},s.add(c)}return s}drawSpline(e){let t="line";if(e.lineTypeName){let a=this.data.tables.ltypes[e.lineTypeName];a&&a.pattern.length>0&&(t="dashed")}let s=this._colorHelper.getMaterial(e,t,this.data.tables),r=this.getBSplinePolyline(e.controlPoints,e.degree,e.knots,e.weights),i=new ie().setFromPoints(r);return i.setIndex(new q(new Uint16Array(this._geometryHelper.generatePointIndex(r)),1)),{geometry:i,material:s}}getBSplinePolyline(e,t,s,r=null,i=25){const a=[],o=e.map(function(h){return[h.x,h.y]}),l=[s[t]],c=[s[t],s[s.length-1-t]];for(let h=t+1;h<s.length-t;++h)l[l.length-1]!==s[h]&&l.push(s[h]);for(let h=1;h<l.length;++h){const u=l[h-1],d=l[h];for(let p=0;p<=i;++p){let m=(p/i*(d-u)+u-c[0])/(c[1]-c[0]);m=Math.max(m,0),m=Math.min(m,1);const y=hd(m,t,o,s,r);isNaN(y[0])||isNaN(y[1])||a.push({x:y[0],y:y[1],z:0})}}return a}}const Rt={ODD_PARITY:0,OUTERMOST:1,THROUGH_ENTIRE_AREA:2},xs=1e-9;function no(n,e){return n.x*e.x+n.y*e.y}function ao(n,e){return{x:n.x-e.x,y:n.y-e.y}}function ud(n,e){return{x:n.x+e.x,y:n.y+e.y}}function dd(n,e){return{x:n.x*e,y:n.y*e}}function pd(n){return Math.hypot(n.x,n.y)}class md{constructor(e,t=Rt.ODD_PARITY){this.loops=(e||[]).map(s=>{const r=s.slice();if(r.length>=2){const i=r[0],a=r[r.length-1];(Math.abs(i.x-a.x)>xs||Math.abs(i.y-a.y)>xs)&&r.push({x:i.x,y:i.y})}return r}),this.style=t}_pointInLoop(e,t){let s=!1;for(let r=0,i=t.length-1;r<t.length;i=r++){const a=t[r].x,o=t[r].y,l=t[i].x,c=t[i].y;o>e.y!=c>e.y&&e.x<(l-a)*(e.y-o)/(c-o+1e-30)+a&&(s=!s)}return s}_depthAt(e){let t=0;for(const s of this.loops)this._pointInLoop(e,s)&&t++;return t}ClipLine([e,t]){const s=ao(t,e),r=pd(s);if(r<xs)return[];const i={x:s.x/r,y:s.y/r},a={x:-i.y,y:i.x},o=0,l=r,c=y=>{const b=ao(y,e);return{x:no(b,i),y:no(b,a)}},h=[];for(const y of this.loops)for(let b=0;b+1<y.length;b++){const x=c(y[b]),g=c(y[b+1]),R=g.y-x.y;if(Math.abs(R)<xs||!(x.y<=0&&0<g.y||g.y<=0&&0<x.y))continue;const Z=(0-x.y)/R,v=x.x+Z*(g.x-x.x);h.push(v)}if(!h.length)return[];h.sort((y,b)=>y-b);const u=[];let d=null;for(const y of h)(d===null||Math.abs(y-d)>1e-7)&&u.push(y),d=y;const p=[];if(this.style===Rt.ODD_PARITY){for(let y=0;y+1<u.length;y+=2){const b=Math.max(o,u[y]),x=Math.min(l,u[y+1]);x-b>1e-9&&p.push([(b-o)/(l-o),(x-o)/(l-o)])}return p}const m=[o];for(const y of u)y>o+1e-9&&y<l-1e-9&&m.push(y);m.push(l);for(let y=0;y+1<m.length;y++){const b=m[y],x=m[y+1];if(x-b<=1e-9)continue;const g=(b+x)*.5,R=ud(e,dd(i,g)),Z=this._depthAt(R);let v=!1;this.style,v=Z>=1,v&&p.push([(b-o)/(l-o),(x-o)/(l-o)])}return p}}class Ic extends Se{constructor(e,t){super(e),this._font=t,this._lineEntity=new Is(e),this._splineEntity=new Nn(e),this._patternHelper={dir:new w,nrm:new w,offsetVec:new w,base:new w},this._boxHelper={min:new f,max:new f}}draw(e,t){let s=new ne;s.name="HATCHES";let r=e.entities.filter(i=>i.type==="HATCH");if(r.length===0)return null;for(let i=0;i<r.length;i++){let a=r[i];if(this._hideEntity(a))continue;let o=this._getCached(a),l=null,c=null;if(o)l=o.geometry,c=o.material;else{let h=this.drawHatch(a,t);l=h.geometry,c=h.material,this._setCache(a,h)}if(l){let h=a.fillType==="SOLID"?new ge(l,c):new Xs(l,c);h.userData={entity:a},h.renderOrder=a.fillType==="SOLID"?-1:0,h.position.z=a.fillType==="SOLID"?-.1:0,s.add(h)}}return s}drawHatch(e,t){let s=null,r=null;switch(this._calculatePoints(e),e.boundary.loops.forEach(i=>this._setBoundaryTypes(i)),e.boundary.loops.sort((i,a)=>i.bType.external!=a.bType.external?i.bType.external?-1:1:i.bType.outermost!=a.bType.outermost?i.bType.outermost?-1:1:0),e.style){case 2:e.boundary.loops=[e.boundary.loops[0]];break;case 1:e.boundary.loops=e.boundary.loops.filter(i=>i.bType.external||i.bType.outermost);break}return this._calculateBoxes(e.boundary),e.fillType==="SOLID"?(s=this._generateBoundary(e,t),r=this._colorHelper.getMaterial(e,"shape",this.data.tables)):e.fillType==="PATTERN"&&(s=this._generatePatternGeometry(e,t),r=this._colorHelper.getMaterial(e,"line",this.data.tables)),s&&this._extrusionTransform(e,s),{geometry:s,material:r}}_calculatePoints(e){const t=e.boundary;for(let s=0;s<t.loops.length;s++){const r=t.loops[s];for(let i=0;i<r.entities.length;i++){let a=r.entities[i];if(!(!a||!a.type))switch(a.type){case"LINE":this._getLinePoints(a);break;case"POLYLINE":this._getPolyLinePoints(a);break;case"ARC":this._getArcPoints(a,e);break;case"ELLIPSE":this._getEllipsePoints(a);break;case"SPLINE":this._getSplinePoints(a);break}}}}_getLinePoints(e){e.points=[],e.points.push({x:e.start.x,y:e.start.y,z:0}),e.points.push({x:e.end.x,y:e.end.y,z:0})}_getPolyLinePoints(){}_getArcPoints(e,t){e.points=[];let s=e.startAngle*Math.PI/180,r=e.endAngle*Math.PI/180;if(!e.counterClockWise&&t.extrusionDir.z>0){const a=-s;s=-r,r=a}let i=new wn(e.center.x,e.center.y,e.radius,s,r,!1).getPoints(32);for(let a=0;a<i.length;a++)e.points.push({x:i[a].x,y:i[a].y,z:0})}_getEllipsePoints(e){e.points=[];let t=e.startAngle*Math.PI/180,s=e.endAngle*Math.PI/180,r=new Et(e.center.x,e.center.y,e.major.x,e.major.y,t,s,!1,e.minor).getPoints(32);for(let i=0;i<r.length;i++)e.points.push({x:r[i].x,y:r[i].y,z:0})}_getSplinePoints(e){e.points=this._splineEntity.getBSplinePolyline(e.controlPoints.points,e.degree,e.knots.knots,e.weights)}_generateBoundary(e){const t=e.boundary,s=this._getBiggestLoop(t),r=t.loops.filter(o=>o!==s&&this._isLoopHole(o,e.style)),i=this._mergeLoopPoints(s);if(i.length===0)return null;const a=new qe;a.setFromPoints(i);for(let o=0;o<r.length;o++){const l=this._mergeLoopPoints(r[o]);if(l.length===0)continue;const c=new qe;c.setFromPoints(l),a.holes.push(c)}return new Ht(a)}_calculateBoxes(e){for(let t=0;t<e.loops.length;t++){const s=e.loops[t];s.box=this._getLoopBox(s)}}_getLoopBox(e){let t=new f(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new f(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);for(let r=0;r<e.entities.length;r++){const i=e.entities[r];for(let a=0;a<i.points.length;a++){const o=i.points[a];t.min(o),s.max(o)}}return new Ze(t,s)}_setBoundaryTypes(e){e.bType={external:(e.type&1)!=0,polyline:(e.type&2)!=0,derived:(e.type&4)!=0,textbox:(e.type&8)!=0,outermost:(e.type&16)!=0},e.eType={polyline:typeof e.hasBulge<"u",line:typeof e.hasBulge<"u"?e.hasBulge===1:e.edgeType===1,circulararc:typeof e.hasBulge<"u"?e.hasBulge===2:e.edgeType===2,ellipticarc:typeof e.hasBulge<"u"?e.hasBulge===3:e.edgeType===3,spline:typeof e.hasBulge<"u"?e.hasBulge===4:e.edgeType===4}}_getBiggestLoop(e){if(e.loops.length===1)return e.loops[0];let t=e.loops[0],s=this._getLoopArea(t);for(let r=1;r<e.loops.length;r++){const i=e.loops[r],a=this._getLoopArea(i);a>s&&(t=i,s=a)}return t}_getLoopArea(e){let t=0;const s=e.box;return t=(s.max.x-s.min.x)*(s.max.y-s.min.y),t}_mergeLoopPoints(e){let t=[];const s=this._orderEntityPoints(e.entities);if(!s)return this.trigger("log","loops with separated entities not supported yet"),t;for(let r=0;r<s.length;r++){const i=s[r];if(i)if(i.type==="POLYLINE"){let a=this._lineEntity._getPolyLinePoints(i.points,i.closed);t=t.concat(a)}else{if(!i.points)continue;let a=i.points.length>0?i.points[i.points.length-1]:null;for(let o=0;o<i.points.length;o++){const l=i.points[o];o===0&&a&&a.x===l.x&&a.y===l.y||t.push(l)}}}return t}_orderEntityPoints(e){let t=[];const s=e.filter(i=>i.points&&i.points.length>0);if(s.length===0)return[];t.push(s[0]);let r=s[0];for(;t.length<s.length;){let i=r.points[0],a=r.points[r.points.length-1];const o=t.length;for(let l=t.length;l<s.length;l++){const c=s[l];if(c){if(this._samePoints(a,c.points[0])){t.push(c),r=c;break}if(this._samePoints(a,c.points[c.points.length-1])){c.points.reverse(),t.push(c),r=c;break}if(this._samePoints(i,c.points[0])){for(let h=0;h<t.length;h++)t[h].points.reverse();t.push(c),r=c;break}if(this._samePoints(i,c.points[c.points.length-1])){for(let h=0;h<t.length;h++)t[h].points.reverse();c.points.reverse(),t.push(c),r=c;break}}}if(o===t.length)return null}return t}_samePoints(e,t){const s=e.x-t.x,r=e.y-t.y,i=e.z-t.z,a=s*s+r*r+i*i;return Math.sqrt(a)<1e-4}_isLoopHole(e,t){return t===1?(e.type&16)===16&&(e.type&1)!==1:!0}_extrusionTransform(e,t){e.extrusionDir.z<0&&t&&t.scale(-1,1,1)}_generatePatternGeometry(e,t){const s=e.pattern||{},r=(s.angle||0)*Math.PI/180;this._patternHelper.dir.set(Math.cos(r),Math.sin(r)),this._patternHelper.nrm.set(-this._patternHelper.dir.y,this._patternHelper.dir.x);const i=this._patternHelper.dir,a=this._patternHelper.nrm;this._patternHelper.offsetVec.set(s.offsetX||0,s.offsetY||0);let o=Math.abs(this._patternHelper.offsetVec.x*a.x+this._patternHelper.offsetVec.y*a.y);o<1e-9&&(o=e.spacing||1),this._patternHelper.base.set(s.x||0,s.y||0);const l=this._patternHelper.base.dot(a),c=e.boundary;if(!c||!Array.isArray(c.loops)||c.loops.length===0)return null;const h=L=>L.map(W=>({x:W.x,y:W.y})),u=[];for(const L of c.loops){let W=[];if(Array.isArray(L.references)&&L.references.length){const U=t(L.references),H=(this._getPointsFromEntities(U)||[]).filter(ae=>ae.length>=2);W=this._stitchPolylines(H)}if(W.length)for(const U of W)u.push(U);else{const U=this._mergeLoopPoints(L);if(U&&U.length>=3){const H=this._cleanPolyline(h(U));H.length>=3&&u.push(H)}}}if(u.length===0)return null;let d=1/0,p=-1/0,m=1/0,y=-1/0;for(const L of u)for(const W of L){const U=W.x*i.x+W.y*i.y,H=W.x*a.x+W.y*a.y;U<d&&(d=U),U>p&&(p=U),H<m&&(m=H),H>y&&(y=H)}const b=Math.ceil((m-l)/o),x=Math.floor((y-l)/o),g={0:Rt.ODD_PARITY,1:Rt.OUTERMOST,2:Rt.THROUGH_ENTIRE_AREA},R=new md(u,g[e.style]??Rt.ODD_PARITY),Z=[],v=1,G=x-b;let S=G>1e3?Math.ceil(G/1e3):1;const V=new w,k=new w;for(let L=b;L<=x;L+=S){const W=l+L*o,U=d-v,H=p+v;V.set(i.x*U+a.x*W,i.y*U+a.y*W),k.set(i.x*H+a.x*W,i.y*H+a.y*W);const ae=R.ClipLine([{x:V.x,y:V.y},{x:k.x,y:k.y}]);for(const[oe,Y]of ae){const B=V.clone().lerp(k,oe),_=V.clone().lerp(k,Y);Z.push(B.x,B.y,0,_.x,_.y,0)}}if(!Z.length)return null;const X=new ie;X.setAttribute("position",new he(Z,3));const M=X.attributes.position.count,F=[];for(let L=0;L<M;L+=2)F.push(L,L+1);return X.setIndex(new q(new Uint16Array(F),1)),X}_stitchPolylines(e){const t=(i,a)=>Math.abs(i.x-a.x)<1e-6&&Math.abs(i.y-a.y)<1e-6,s=e.map(this._cleanPolyline).filter(i=>i.length>0),r=[];for(;s.length;){let i=s.shift().slice(),a=!0;for(;a;){a=!1;for(let o=0;o<s.length;o++){const l=s[o],c=i[0],h=i[i.length-1],u=l[0],d=l[l.length-1];if(t(h,u)){i=i.concat(l.slice(1)),s.splice(o,1),a=!0;break}if(t(h,d)){i=i.concat(l.slice(0,-1).reverse()),s.splice(o,1),a=!0;break}if(t(c,d)){i=l.slice(0,-1).concat(i),s.splice(o,1),a=!0;break}if(t(c,u)){i=l.slice(1).reverse().concat(i),s.splice(o,1),a=!0;break}}}i.length>=3&&t(i[0],i[i.length-1])&&i.pop(),i.length>=3&&r.push(i)}return r}_cleanPolyline(e){if(!e||e.length<2)return[];const t=1e-6,s=(i,a)=>Math.abs(i.x-a.x)<t&&Math.abs(i.y-a.y)<t,r=[e[0]];for(let i=1;i<e.length;i++){const a=e[i],o=r[r.length-1];s(a,o)||r.push(a)}return r.length>=3&&s(r[0],r[r.length-1])&&r.pop(),r}_geometryToVector2Arrays(e){if(!e)return[];const t=e.getAttribute("position");if(!t)return[];const s=t.array,r=t.itemSize||3,i=o=>{const l=o*r;return{x:s[l],y:s[l+1]}},a=[];if(e.index&&e.index.count){const o=e.index.array;let l=[],c=-1;for(let h=0;h<o.length;h++){const u=o[h];c>=0&&Math.abs(u-c)>1&&(l.length>1&&a.push(l),l=[]),l.push(i(u)),c=u}l.length>1&&a.push(l)}else{const o=Math.floor(s.length/r),l=[];for(let c=0;c<o;c++)l.push(i(c));l.length>1&&a.push(l)}return a}_getPointsFromEntities(e){const t=[];if(!Array.isArray(e))return t;for(const s of e){if(!s||!s.geometry)continue;const r=this._geometryToVector2Arrays(s.geometry);for(const i of r)i.length>1&&t.push(i)}return t}}const yd="data:text/javascript;base64,IWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW10sZSk6Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuV01GSlM9ZSgpOnQuV01GSlM9ZSgpfSh0aGlzLCgoKT0+KCgpPT57InVzZSBzdHJpY3QiO3ZhciB0PXtkOihlLGkpPT57Zm9yKHZhciBzIGluIGkpdC5vKGkscykmJiF0Lm8oZSxzKSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUscyx7ZW51bWVyYWJsZTohMCxnZXQ6aVtzXX0pfSxvOih0LGUpPT5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxlKSxyOnQ9PnsidW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkodCxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOiJNb2R1bGUifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pfX0sZT17fTt0LnIoZSksdC5kKGUse0Vycm9yOigpPT5hLFJlbmRlcmVyOigpPT54LGxvZ2dpbmdFbmFibGVkOigpPT5sfSk7dmFyIGkscz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQucHJvdG90eXBlLmZsb29kPWZ1bmN0aW9uKHQsZSxpLHMsbil7dmFyIG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsImZlRmxvb2QiKTtlJiZvLnNldEF0dHJpYnV0ZSgiaWQiLGUpLG8uc2V0QXR0cmlidXRlKCJmbG9vZC1jb2xvciIsaSksby5zZXRBdHRyaWJ1dGUoImZsb29kLW9wYWNpdHkiLHMudG9TdHJpbmcoKSksdC5hcHBlbmRDaGlsZChvKX0sdC5wcm90b3R5cGUuY29tcG9zaXRlPWZ1bmN0aW9uKHQsZSxpLHMsbixvLHIsYSxoKXt2YXIgbD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwiZmVDb21wb3NpdGUiKTtlJiZsLnNldEF0dHJpYnV0ZSgiaWQiLGUpLGwuc2V0QXR0cmlidXRlKCJpbiIsaSksbC5zZXRBdHRyaWJ1dGUoImluMiIscyksdC5hcHBlbmRDaGlsZChsKX0sdH0oKSxuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuX3BhdGg9IiJ9cmV0dXJuIHQucHJvdG90eXBlLm1vdmU9ZnVuY3Rpb24odCxlKXt0aGlzLl9wYXRoKz0iIE0gIi5jb25jYXQodCwiICIpLmNvbmNhdChlKX0sdC5wcm90b3R5cGUucGF0aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9wYXRoLnN1YnN0cigxKX0sdC5wcm90b3R5cGUubGluZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzO3QuZm9yRWFjaCgoZnVuY3Rpb24odCl7ZS5fcGF0aCs9IiBMICIuY29uY2F0KHRbMF0sIiAiKS5jb25jYXQodFsxXSl9KSl9LHQucHJvdG90eXBlLmN1cnZlQz1mdW5jdGlvbih0LGUsaSxzLG4sbyl7dGhpcy5fcGF0aCs9IiBDICIuY29uY2F0KHQsIiAiKS5jb25jYXQoZSwiLCAiKS5jb25jYXQoaSwiICIpLmNvbmNhdChzLCIsICIpLmNvbmNhdChuLCIgIikuY29uY2F0KG8pfSx0LnByb3RvdHlwZS5jbG9zZT1mdW5jdGlvbigpe3RoaXMuX3BhdGgrPSIgWiJ9LHR9KCksbz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5maWx0ZXJzPW5ldyBzLHRoaXMuX2RlZnM9dm9pZCAwLHRoaXMuX3N2Zz10fXJldHVybiB0LnByb3RvdHlwZS5zdmc9ZnVuY3Rpb24odCxlLGkscyxuLG8pe3ZhciByPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJzdmciKTtyZXR1cm4gci5zZXRBdHRyaWJ1dGUoIngiLGUudG9TdHJpbmcoKSksci5zZXRBdHRyaWJ1dGUoInkiLGkudG9TdHJpbmcoKSksci5zZXRBdHRyaWJ1dGUoIndpZHRoIixzLnRvU3RyaW5nKCkpLHIuc2V0QXR0cmlidXRlKCJoZWlnaHQiLG4udG9TdHJpbmcoKSksdGhpcy5fYXBwZW5kU2V0dGluZ3MobyxyKSxudWxsIT10P3QuYXBwZW5kQ2hpbGQocik6dGhpcy5fc3ZnLmFwcGVuZENoaWxkKHIpLHJ9LHQucHJvdG90eXBlLmltYWdlPWZ1bmN0aW9uKHQsZSxpLHMsbixvLHIpe3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJpbWFnZSIpO3JldHVybiBhLnNldEF0dHJpYnV0ZSgieCIsZS50b1N0cmluZygpKSxhLnNldEF0dHJpYnV0ZSgieSIsaS50b1N0cmluZygpKSxhLnNldEF0dHJpYnV0ZSgid2lkdGgiLHMudG9TdHJpbmcoKSksYS5zZXRBdHRyaWJ1dGUoImhlaWdodCIsbi50b1N0cmluZygpKSxhLnNldEF0dHJpYnV0ZU5TKCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiwiaHJlZiIsbyksdGhpcy5fYXBwZW5kU2V0dGluZ3MocixhKSx0LmFwcGVuZENoaWxkKGEpLGF9LHQucHJvdG90eXBlLnJlY3Q9ZnVuY3Rpb24odCxlLGkscyxuLG8scixhKXt2YXIgaD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwicmVjdCIpO3JldHVybiBoLnNldEF0dHJpYnV0ZSgieCIsZS50b1N0cmluZygpKSxoLnNldEF0dHJpYnV0ZSgieSIsaS50b1N0cmluZygpKSxoLnNldEF0dHJpYnV0ZSgid2lkdGgiLHMudG9TdHJpbmcoKSksaC5zZXRBdHRyaWJ1dGUoImhlaWdodCIsbi50b1N0cmluZygpKSx2b2lkIDAhPT1vJiYobyBpbnN0YW5jZW9mIE51bWJlcj9oLnNldEF0dHJpYnV0ZSgicngiLG8udG9TdHJpbmcoKSk6byBpbnN0YW5jZW9mIE9iamVjdCYmdGhpcy5fYXBwZW5kU2V0dGluZ3MobyxoKSksdm9pZCAwIT09ciYmaC5zZXRBdHRyaWJ1dGUoInJ5IixyLnRvU3RyaW5nKCkpLHRoaXMuX2FwcGVuZFNldHRpbmdzKGEsaCksdC5hcHBlbmRDaGlsZChoKSxofSx0LnByb3RvdHlwZS5saW5lPWZ1bmN0aW9uKHQsZSxpLHMsbixvKXt2YXIgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwibGluZSIpO3JldHVybiByLnNldEF0dHJpYnV0ZSgieDEiLGUudG9TdHJpbmcoKSksci5zZXRBdHRyaWJ1dGUoInkxIixpLnRvU3RyaW5nKCkpLHIuc2V0QXR0cmlidXRlKCJ4MiIscy50b1N0cmluZygpKSxyLnNldEF0dHJpYnV0ZSgieTIiLG4udG9TdHJpbmcoKSksdGhpcy5fYXBwZW5kU2V0dGluZ3MobyxyKSx0LmFwcGVuZENoaWxkKHIpLHJ9LHQucHJvdG90eXBlLnBvbHlnb249ZnVuY3Rpb24odCxlLGkpe3ZhciBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJwb2x5Z29uIik7cmV0dXJuIHMuc2V0QXR0cmlidXRlKCJwb2ludHMiLGUubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gdC5qb2luKCIsIil9KSkuam9pbigiICIpKSx0aGlzLl9hcHBlbmRTZXR0aW5ncyhpLHMpLHQuYXBwZW5kQ2hpbGQocyksc30sdC5wcm90b3R5cGUucG9seWxpbmU9ZnVuY3Rpb24odCxlLGkpe3ZhciBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJwb2x5bGluZSIpO3JldHVybiBzLnNldEF0dHJpYnV0ZSgicG9pbnRzIixlLm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIHQuam9pbigiLCIpfSkpLmpvaW4oIiAiKSksdGhpcy5fYXBwZW5kU2V0dGluZ3MoaSxzKSx0LmFwcGVuZENoaWxkKHMpLHN9LHQucHJvdG90eXBlLmVsbGlwc2U9ZnVuY3Rpb24odCxlLGkscyxuLG8pe3ZhciByPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJlbGxpcHNlIik7cmV0dXJuIHIuc2V0QXR0cmlidXRlKCJjeCIsZS50b1N0cmluZygpKSxyLnNldEF0dHJpYnV0ZSgiY3kiLGkudG9TdHJpbmcoKSksci5zZXRBdHRyaWJ1dGUoInJ4IixzLnRvU3RyaW5nKCkpLHIuc2V0QXR0cmlidXRlKCJyeSIsbi50b1N0cmluZygpKSx0aGlzLl9hcHBlbmRTZXR0aW5ncyhvLHIpLHQuYXBwZW5kQ2hpbGQocikscn0sdC5wcm90b3R5cGUucGF0aD1mdW5jdGlvbih0LGUsaSl7dmFyIHM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsInBhdGgiKTtyZXR1cm4gcy5zZXRBdHRyaWJ1dGUoImQiLGUucGF0aCgpKSx0aGlzLl9hcHBlbmRTZXR0aW5ncyhpLHMpLHQuYXBwZW5kQ2hpbGQocyksc30sdC5wcm90b3R5cGUudGV4dD1mdW5jdGlvbih0LGUsaSxzLG4pe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJ0ZXh0Iik7by5zZXRBdHRyaWJ1dGUoIngiLGUudG9TdHJpbmcoKSksby5zZXRBdHRyaWJ1dGUoInkiLGkudG9TdHJpbmcoKSksdGhpcy5fYXBwZW5kU2V0dGluZ3MobixvKTt2YXIgcj1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzKTtyZXR1cm4gby5hcHBlbmRDaGlsZChyKSx0LmFwcGVuZENoaWxkKG8pLG99LHQucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbih0LGUsaSxzLG4sbyxyKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwiZmlsdGVyIik7cmV0dXJuIGEuc2V0QXR0cmlidXRlKCJ4IixpLnRvU3RyaW5nKCkpLGEuc2V0QXR0cmlidXRlKCJ5IixzLnRvU3RyaW5nKCkpLGEuc2V0QXR0cmlidXRlKCJ3aWR0aCIsbi50b1N0cmluZygpKSxhLnNldEF0dHJpYnV0ZSgiaGVpZ2h0IixvLnRvU3RyaW5nKCkpLHRoaXMuX2FwcGVuZFNldHRpbmdzKHIsYSksdC5hcHBlbmRDaGlsZChhKSxhfSx0LnByb3RvdHlwZS5wYXR0ZXJuPWZ1bmN0aW9uKHQsZSxpLHMsbixvLHIpe3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJwYXR0ZXJuIik7cmV0dXJuIGUmJmEuc2V0QXR0cmlidXRlKCJpZCIsZSksYS5zZXRBdHRyaWJ1dGUoIngiLGkudG9TdHJpbmcoKSksYS5zZXRBdHRyaWJ1dGUoInkiLHMudG9TdHJpbmcoKSksYS5zZXRBdHRyaWJ1dGUoIndpZHRoIixuLnRvU3RyaW5nKCkpLGEuc2V0QXR0cmlidXRlKCJoZWlnaHQiLG8udG9TdHJpbmcoKSksdGhpcy5fYXBwZW5kU2V0dGluZ3MocixhKSx0LmFwcGVuZENoaWxkKGEpLGF9LHQucHJvdG90eXBlLmRlZnM9ZnVuY3Rpb24oKXtpZih2b2lkIDA9PT10aGlzLl9kZWZzKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwiZGVmcyIpO3RoaXMuX3N2Zy5hcHBlbmRDaGlsZCh0KSx0aGlzLl9kZWZzPXR9cmV0dXJuIHRoaXMuX2RlZnN9LHQucHJvdG90eXBlLmNsaXBQYXRoPWZ1bmN0aW9uKHQsZSxpLHMpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJjbGlwUGF0aCIpO3JldHVybiBlJiZuLnNldEF0dHJpYnV0ZSgiaWQiLGUpLHZvaWQgMD09PWkmJihpPSJ1c2VyU3BhY2VPblVzZSIpLG4uc2V0QXR0cmlidXRlKCJjbGlwUGF0aFVuaXRzIixpKSx0aGlzLl9hcHBlbmRTZXR0aW5ncyhzLG4pLHQuYXBwZW5kQ2hpbGQobiksbn0sdC5wcm90b3R5cGUuY3JlYXRlUGF0aD1mdW5jdGlvbigpe3JldHVybiBuZXcgbn0sdC5wcm90b3R5cGUuX2FwcGVuZFNldHRpbmdzPWZ1bmN0aW9uKHQsZSl7dm9pZCAwIT09dCYmT2JqZWN0LmtleXModCkuZm9yRWFjaCgoZnVuY3Rpb24oaSl7ZS5zZXRBdHRyaWJ1dGUoaSx0W2ldKX0pKX0sdH0oKSxyPShpPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGk9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKHQsZSl7dC5fX3Byb3RvX189ZX18fGZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsaSkmJih0W2ldPWVbaV0pfSxpKHQsZSl9LGZ1bmN0aW9uKHQsZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUmJm51bGwhPT1lKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcoZSkrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZnVuY3Rpb24gcygpe3RoaXMuY29uc3RydWN0b3I9dH1pKHQsZSksdC5wcm90b3R5cGU9bnVsbD09PWU/T2JqZWN0LmNyZWF0ZShlKToocy5wcm90b3R5cGU9ZS5wcm90b3R5cGUsbmV3IHMpfSksYT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUpe3ZhciBpPXRoaXMuY29uc3RydWN0b3Iscz10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKHMsaS5wcm90b3R5cGUpLHN9cmV0dXJuIHIoZSx0KSxlfShFcnJvciksaD0hMDtmdW5jdGlvbiBsKHQpe2g9dH12YXIgYz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQubG9nPWZ1bmN0aW9uKHQpe2gmJmNvbnNvbGUubG9nKHQpfSx0Ll9tYWtlVW5pcXVlSWQ9ZnVuY3Rpb24odCl7cmV0dXJuIndtZmpzXyIrdCt0aGlzLl91bmlxdWVJZCsrfSx0Ll93cml0ZVVpbnQzMlZhbD1mdW5jdGlvbih0LGUsaSl7dFtlKytdPTI1NSZpLHRbZSsrXT1pPj4+OCYyNTUsdFtlKytdPWk+Pj4xNiYyNTUsdFtlKytdPWk+Pj4yNCYyNTV9LHQuX2Jsb2JUb0JpbmFyeT1mdW5jdGlvbih0KXtmb3IodmFyIGU9IiIsaT10Lmxlbmd0aCxzPTA7czxpO3MrKyllKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRbc10pO3JldHVybiBlfSx0LkdEST17TUVUQUhFQURFUl9TSVpFOjE4LEJJVE1BUElORk9IRUFERVJfU0laRTo0MCxCSVRNQVBDT1JFSEVBREVSX1NJWkU6MTIsTWV0YWZpbGVUeXBlOntNRU1PUllNRVRBRklMRToxLERJU0tNRVRBRklMRToyfSxNZXRhZmlsZVZlcnNpb246e01FVEFWRVJTSU9OMTAwOjI1NixNRVRBVkVSU0lPTjMwMDo3Njh9LFJlY29yZFR5cGU6e01FVEFfRU9GOjAsTUVUQV9SRUFMSVpFUEFMRVRURTo1MyxNRVRBX1NFVFBBTEVOVFJJRVM6NTUsTUVUQV9TRVRCS01PREU6MjU4LE1FVEFfU0VUTUFQTU9ERToyNTksTUVUQV9TRVRST1AyOjI2MCxNRVRBX1NFVFJFTEFCUzoyNjEsTUVUQV9TRVRQT0xZRklMTE1PREU6MjYyLE1FVEFfU0VUU1RSRVRDSEJMVE1PREU6MjYzLE1FVEFfU0VUVEVYVENIQVJFWFRSQToyNjQsTUVUQV9SRVNUT1JFREM6Mjk1LE1FVEFfUkVTSVpFUEFMRVRURTozMTMsTUVUQV9ESUJDUkVBVEVQQVRURVJOQlJVU0g6MzIyLE1FVEFfU0VUTEFZT1VUOjMyOSxNRVRBX1NFVEJLQ09MT1I6NTEzLE1FVEFfU0VUVEVYVENPTE9SOjUyMSxNRVRBX09GRlNFVFZJRVdQT1JUT1JHOjUyOSxNRVRBX0xJTkVUTzo1MzEsTUVUQV9NT1ZFVE86NTMyLE1FVEFfT0ZGU0VUQ0xJUFJHTjo1NDQsTUVUQV9GSUxMUkVHSU9OOjU1MixNRVRBX1NFVE1BUFBFUkZMQUdTOjU2MSxNRVRBX1NFTEVDVFBBTEVUVEU6NTY0LE1FVEFfUE9MWUdPTjo4MDQsTUVUQV9QT0xZTElORTo4MDUsTUVUQV9TRVRURVhUSlVTVElGSUNBVElPTjo1MjIsTUVUQV9TRVRXSU5ET1dPUkc6NTIzLE1FVEFfU0VUV0lORE9XRVhUOjUyNCxNRVRBX1NFVFZJRVdQT1JUT1JHOjUyNSxNRVRBX1NFVFZJRVdQT1JURVhUOjUyNixNRVRBX09GRlNFVFdJTkRPV09SRzo1MjcsTUVUQV9TQ0FMRVdJTkRPV0VYVDoxMDQwLE1FVEFfU0NBTEVWSUVXUE9SVEVYVDoxMDQyLE1FVEFfRVhDTFVERUNMSVBSRUNUOjEwNDUsTUVUQV9JTlRFUlNFQ1RDTElQUkVDVDoxMDQ2LE1FVEFfRUxMSVBTRToxMDQ4LE1FVEFfRkxPT0RGSUxMOjEwNDksTUVUQV9GUkFNRVJFR0lPTjoxMDY1LE1FVEFfQU5JTUFURVBBTEVUVEU6MTA3OCxNRVRBX1RFWFRPVVQ6MTMxMyxNRVRBX1BPTFlQT0xZR09OOjEzMzYsTUVUQV9FWFRGTE9PREZJTEw6MTM1MixNRVRBX1JFQ1RBTkdMRToxMDUxLE1FVEFfU0VUUElYRUw6MTA1NSxNRVRBX1JPVU5EUkVDVDoxNTY0LE1FVEFfUEFUQkxUOjE1NjUsTUVUQV9TQVZFREM6MzAsTUVUQV9QSUU6MjA3NCxNRVRBX1NUUkVUQ0hCTFQ6Mjg1MSxNRVRBX0VTQ0FQRToxNTc0LE1FVEFfSU5WRVJUUkVHSU9OOjI5OCxNRVRBX1BBSU5UUkVHSU9OOjI5OSxNRVRBX1NFTEVDVENMSVBSRUdJT046MzAwLE1FVEFfU0VMRUNUT0JKRUNUOjMwMSxNRVRBX1NFVFRFWFRBTElHTjozMDIsTUVUQV9BUkM6MjA3MSxNRVRBX0NIT1JEOjIwOTYsTUVUQV9CSVRCTFQ6MjMzOCxNRVRBX0VYVFRFWFRPVVQ6MjYxMCxNRVRBX1NFVERJQlRPREVWOjMzNzksTUVUQV9ESUJCSVRCTFQ6MjM2OCxNRVRBX0RJQlNUUkVUQ0hCTFQ6Mjg4MSxNRVRBX1NUUkVUQ0hESUI6MzkwNyxNRVRBX0RFTEVURU9CSkVDVDo0OTYsTUVUQV9DUkVBVEVQQUxFVFRFOjI0NyxNRVRBX0NSRUFURVBBVFRFUk5CUlVTSDo1MDUsTUVUQV9DUkVBVEVQRU5JTkRJUkVDVDo3NjIsTUVUQV9DUkVBVEVGT05USU5ESVJFQ1Q6NzYzLE1FVEFfQ1JFQVRFQlJVU0hJTkRJUkVDVDo3NjQsTUVUQV9DUkVBVEVSRUdJT046MTc5MX0sTWV0YWZpbGVFc2NhcGVzOntORVdGUkFNRToxLEFCT1JURE9DOjIsTkVYVEJBTkQ6MyxTRVRDT0xPUlRBQkxFOjQsR0VUQ09MT1JUQUJMRTo1LEZMVVNIT1VUOjYsRFJBRlRNT0RFOjcsUVVFUllFU0NTVVBQT1JUOjgsU0VUQUJPUlRQUk9DOjksU1RBUlRET0M6MTAsRU5ERE9DOjExLEdFVFBIWVNQQUdFU0laRToxMixHRVRQUklOVElOR09GRlNFVDoxMyxHRVRTQ0FMSU5HRkFDVE9SOjE0LE1FVEFfRVNDQVBFX0VOSEFOQ0VEX01FVEFGSUxFOjE1LFNFVFBFTldJRFRIOjE2LFNFVENPUFlDT1VOVDoxNyxTRVRQQVBFUlNPVVJDRToxOCxQQVNTVEhST1VHSDoxOSxHRVRURUNITk9MT0dZOjIwLFNFVExJTkVDQVA6MjEsU0VUTElORUpPSU46MjIsU0VUTUlURVJMSU1JVDoyMyxCQU5ESU5GTzoyNCxEUkFXUEFUVEVSTlJFQ1Q6MjUsR0VUVkVDVE9SUEVOU0laRToyNixHRVRWRUNUT1JCUlVTSFNJWkU6MjcsRU5BQkxFRFVQTEVYOjI4LEdFVFNFVFBBUEVSQklOUzoyOSxHRVRTRVRQUklOVE9SSUVOVDozMCxFTlVNUEFQRVJCSU5TOjMxLFNFVERJQlNDQUxJTkc6MzIsRVBTUFJJTlRJTkc6MzMsRU5VTVBBUEVSTUVUUklDUzozNCxHRVRTRVRQQVBFUk1FVFJJQ1M6MzUsUE9TVFNDUklQVF9EQVRBOjM3LFBPU1RTQ1JJUFRfSUdOT1JFOjM4LEdFVERFVklDRVVOSVRTOjQyLEdFVEVYVEVOREVEVEVYVE1FVFJJQ1M6MjU2LEdFVFBBSVJLRVJOVEFCTEU6MjU4LEVYVFRFWFRPVVQ6NTEyLEdFVEZBQ0VOQU1FOjUxMyxET1dOTE9BREZBQ0U6NTE0LE1FVEFGSUxFX0RSSVZFUjoyMDQ5LFFVRVJZRElCU1VQUE9SVDozMDczLEJFR0lOX1BBVEg6NDA5NixDTElQX1RPX1BBVEg6NDA5NyxFTkRfUEFUSDo0MDk4LE9QRU5fQ0hBTk5FTDo0MTEwLERPV05MT0FESEVBREVSOjQxMTEsQ0xPU0VfQ0hBTk5FTDo0MTEyLFBPU1RTQ1JJUFRfUEFTU1RIUk9VR0g6NDExNSxFTkNBUFNVTEFURURfUE9TVFNDUklQVDo0MTE2LFBPU1RTQ1JJUFRfSURFTlRJRlk6NDExNyxQT1NUU0NSSVBUX0lOSkVDVElPTjo0MTE4LENIRUNLSlBFR0ZPUk1BVDo0MTE5LENIRUNLUE5HRk9STUFUOjQxMjAsR0VUX1BTX0ZFQVRVUkVTRVRUSU5HOjQxMjEsTVhEQ19FU0NBUEU6NDEyMixTUENMUEFTU1RIUk9VR0gyOjQ1Njh9LE1hcE1vZGU6e01NX1RFWFQ6MSxNTV9MT01FVFJJQzoyLE1NX0hJTUVUUklDOjMsTU1fTE9FTkdMSVNIOjQsTU1fSElFTkdMSVNIOjUsTU1fVFdJUFM6NixNTV9JU09UUk9QSUM6NyxNTV9BTklTT1RST1BJQzo4fSxTdHJldGNoTW9kZTp7QkxBQ0tPTldISVRFOjEsV0hJVEVPTkJMQUNLOjIsQ09MT1JPTkNPTE9SOjMsSEFMRlRPTkU6NH0sVGV4dEFsaWdubWVudE1vZGU6e1RBX1VQREFURUNQOjEsVEFfUklHSFQ6MixUQV9DRU5URVI6NixUQV9CT1RUT006OCxUQV9CQVNFTElORToyNCxUQV9SVExSRUFESU5HOjI1Nn0sTWl4TW9kZTp7VFJBTlNQQVJFTlQ6MSxPUEFRVUU6Mn0sVmVydGljYWxUZXh0QWxpZ25tZW50TW9kZTp7VlRBX0JPVFRPTToyLFZUQV9DRU5URVI6NixWVEFfTEVGVDo4LFZUQV9CQVNFTElORToyNH0sQnJ1c2hTdHlsZTp7QlNfU09MSUQ6MCxCU19OVUxMOjEsQlNfSEFUQ0hFRDoyLEJTX1BBVFRFUk46MyxCU19JTkRFWEVEOjQsQlNfRElCUEFUVEVSTjo1LEJTX0RJQlBBVFRFUk5QVDo2LEJTX1BBVFRFUk44WDg6NyxCU19ESUJQQVRURVJOOFg4OjgsQlNfTU9OT1BBVFRFUk46OX0sUGVuU3R5bGU6e1BTX1NPTElEOjAsUFNfREFTSDoxLFBTX0RPVDoyLFBTX0RBU0hET1Q6MyxQU19EQVNIRE9URE9UOjQsUFNfTlVMTDo1LFBTX0lOU0lERUZSQU1FOjYsUFNfVVNFUlNUWUxFOjcsUFNfQUxURVJOQVRFOjgsUFNfRU5EQ0FQX1NRVUFSRToyNTYsUFNfRU5EQ0FQX0ZMQVQ6NTEyLFBTX0pPSU5fQkVWRUw6NDA5NixQU19KT0lOX01JVEVSOjgxOTJ9LFBvbHlGaWxsTW9kZTp7QUxURVJOQVRFOjEsV0lORElORzoyfSxDb2xvclVzYWdlOntESUJfUkdCX0NPTE9SUzowLERJQl9QQUxfQ09MT1JTOjEsRElCX1BBTF9JTkRJQ0VTOjJ9LFBhbGV0dGVFbnRyeUZsYWc6e1BDX1JFU0VSVkVEOjEsUENfRVhQTElDSVQ6MixQQ19OT0NPTExBUFNFOjR9LEJpdG1hcENvbXByZXNzaW9uOntCSV9SR0I6MCxCSV9STEU4OjEsQklfUkxFNDoyLEJJX0JJVEZJRUxEUzozLEJJX0pQRUc6NCxCSV9QTkc6NX19LHQuX3VuaXF1ZUlkPTAsdH0oKSxwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLGkpe2UgaW5zdGFuY2VvZiB0Pyh0aGlzLmJsb2I9ZS5ibG9iLHRoaXMuZGF0YT1lLmRhdGEsdGhpcy5wb3M9aXx8ZS5wb3MpOih0aGlzLmJsb2I9ZSx0aGlzLmRhdGE9bmV3IFVpbnQ4QXJyYXkoZSksdGhpcy5wb3M9aXx8MCl9cmV0dXJuIHQucHJvdG90eXBlLmVvZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBvcz49dGhpcy5kYXRhLmxlbmd0aH0sdC5wcm90b3R5cGUuc2Vlaz1mdW5jdGlvbih0KXtpZih0PDB8fHQ+dGhpcy5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgYSgiSW52YWxpZCBzZWVrIHBvc2l0aW9uIik7dGhpcy5wb3M9dH0sdC5wcm90b3R5cGUuc2tpcD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLnBvcyt0O2lmKGU+dGhpcy5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgYSgiVW5leHBlY3RlZCBlbmQgb2YgZmlsZSIpO3RoaXMucG9zPWV9LHQucHJvdG90eXBlLnJlYWRCaW5hcnk9ZnVuY3Rpb24odCl7aWYodGhpcy5wb3MrdD50aGlzLmRhdGEubGVuZ3RoKXRocm93IG5ldyBhKCJVbmV4cGVjdGVkIGVuZCBvZiBmaWxlIik7Zm9yKHZhciBlPSIiO3QtLSA+MDspZSs9U3RyaW5nLmZyb21DaGFyQ29kZSh0aGlzLmRhdGFbdGhpcy5wb3MrK10pO3JldHVybiBlfSx0LnByb3RvdHlwZS5yZWFkSW50OD1mdW5jdGlvbigpe2lmKHRoaXMucG9zKzE+dGhpcy5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgYSgiVW5leHBlY3RlZCBlbmQgb2YgZmlsZSIpO3JldHVybiB0aGlzLmRhdGFbdGhpcy5wb3MrK119LHQucHJvdG90eXBlLnJlYWRVaW50OD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRJbnQ4KCk+Pj4wfSx0LnByb3RvdHlwZS5yZWFkSW50MzI9ZnVuY3Rpb24oKXtpZih0aGlzLnBvcys0PnRoaXMuZGF0YS5sZW5ndGgpdGhyb3cgbmV3IGEoIlVuZXhwZWN0ZWQgZW5kIG9mIGZpbGUiKTt2YXIgdD10aGlzLmRhdGFbdGhpcy5wb3MrK107cmV0dXJuIHR8PXRoaXMuZGF0YVt0aGlzLnBvcysrXTw8OCwodHw9dGhpcy5kYXRhW3RoaXMucG9zKytdPDwxNil8dGhpcy5kYXRhW3RoaXMucG9zKytdPDwyNH0sdC5wcm90b3R5cGUucmVhZFVpbnQzMj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRJbnQzMigpPj4+MH0sdC5wcm90b3R5cGUucmVhZFVpbnQxNj1mdW5jdGlvbigpe2lmKHRoaXMucG9zKzI+dGhpcy5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgYSgiVW5leHBlY3RlZCBlbmQgb2YgZmlsZSIpO3JldHVybiB0aGlzLmRhdGFbdGhpcy5wb3MrK118dGhpcy5kYXRhW3RoaXMucG9zKytdPDw4fSx0LnByb3RvdHlwZS5yZWFkSW50MTY9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnJlYWRVaW50MTYoKTtyZXR1cm4gdD4zMjc2NyYmKHQtPTY1NTM2KSx0fSx0LnByb3RvdHlwZS5yZWFkU3RyaW5nPWZ1bmN0aW9uKHQpe2lmKHRoaXMucG9zK3Q+dGhpcy5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgYSgiVW5leHBlY3RlZCBlbmQgb2YgZmlsZSIpO2Zvcih2YXIgZT0iIixpPTA7aTx0O2krKyllKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMuZGF0YVt0aGlzLnBvcysrXT4+PjApO3JldHVybiBlfSx0LnByb3RvdHlwZS5yZWFkTnVsbFRlcm1TdHJpbmc9ZnVuY3Rpb24odCl7dmFyIGU9IiI7aWYodD4wKXt0LS07Zm9yKHZhciBpPTA7aTx0O2krKyl7aWYodGhpcy5wb3MraSsxPnRoaXMuZGF0YS5sZW5ndGgpdGhyb3cgbmV3IGEoIlVuZXhwZWN0ZWQgZW5kIG9mIGZpbGUiKTt2YXIgcz10aGlzLmRhdGFbdGhpcy5wb3MraV0+Pj4wO2lmKDA9PT1zKWJyZWFrO2UrPVN0cmluZy5mcm9tQ2hhckNvZGUocyl9fXJldHVybiBlfSx0fSgpLHU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpKXtudWxsIT10Pyh0aGlzLng9dC5yZWFkSW50MTYoKSx0aGlzLnk9dC5yZWFkSW50MTYoKSk6KHRoaXMueD1lLHRoaXMueT1pKX1yZXR1cm4gdC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHQobnVsbCx0aGlzLngsdGhpcy55KX0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4ie3g6ICIrdGhpcy54KyIsIHk6ICIrdGhpcy55KyJ9In0sdH0oKSxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxzLG4pe251bGwhPXQ/KHRoaXMuYm90dG9tPXQucmVhZEludDE2KCksdGhpcy5yaWdodD10LnJlYWRJbnQxNigpLHRoaXMudG9wPXQucmVhZEludDE2KCksdGhpcy5sZWZ0PXQucmVhZEludDE2KCkpOih0aGlzLmJvdHRvbT1uLHRoaXMucmlnaHQ9cyx0aGlzLnRvcD1pLHRoaXMubGVmdD1lKX1yZXR1cm4gdC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHQobnVsbCx0aGlzLmxlZnQsdGhpcy50b3AsdGhpcy5yaWdodCx0aGlzLmJvdHRvbSl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIntsZWZ0OiAiK3RoaXMubGVmdCsiLCB0b3A6ICIrdGhpcy50b3ArIiwgcmlnaHQ6ICIrdGhpcy5yaWdodCsiLCBib3R0b206ICIrdGhpcy5ib3R0b20rIn0ifSx0LnByb3RvdHlwZS5lbXB0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlZnQ+PXRoaXMucmlnaHR8fHRoaXMudG9wPj10aGlzLmJvdHRvbX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVtcHR5KCl8fGUuZW1wdHkoKXx8dGhpcy5sZWZ0Pj1lLnJpZ2h0fHx0aGlzLnRvcD49ZS5ib3R0b218fHRoaXMucmlnaHQ8PWUubGVmdHx8dGhpcy5ib3R0b208PWUudG9wP251bGw6bmV3IHQobnVsbCxNYXRoLm1heCh0aGlzLmxlZnQsZS5sZWZ0KSxNYXRoLm1heCh0aGlzLnRvcCxlLnRvcCksTWF0aC5taW4odGhpcy5yaWdodCxlLnJpZ2h0KSxNYXRoLm1pbih0aGlzLmJvdHRvbSxlLmJvdHRvbSkpfSx0fSgpLFQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMudHlwZT10fXJldHVybiB0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3Rocm93IG5ldyBhKCJjbG9uZSBub3QgaW1wbGVtZW50ZWQiKX0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgYSgidG9TdHJpbmcgbm90IGltcGxlbWVudGVkIil9LHR9KCksZj1mdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQ9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKHQsZSl7dC5fX3Byb3RvX189ZX18fGZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsaSkmJih0W2ldPWVbaV0pfSx0KGUsaSl9O3JldHVybiBmdW5jdGlvbihlLGkpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBpJiZudWxsIT09aSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDbGFzcyBleHRlbmRzIHZhbHVlICIrU3RyaW5nKGkpKyIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbCIpO2Z1bmN0aW9uIHMoKXt0aGlzLmNvbnN0cnVjdG9yPWV9dChlLGkpLGUucHJvdG90eXBlPW51bGw9PT1pP09iamVjdC5jcmVhdGUoaSk6KHMucHJvdG90eXBlPWkucHJvdG90eXBlLG5ldyBzKX19KCksRT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIHM9dC5jYWxsKHRoaXMsInJlZ2lvbiIpfHx0aGlzO2lmKG51bGwhPWUpe2lmKGUuc2tpcCgyKSw2IT09ZS5yZWFkSW50MTYoKSl0aHJvdyBuZXcgYSgiSW52YWxpZCByZWdpb24gaWRlbnRpZmllciIpO2Uuc2tpcCgyKSxlLnJlYWRJbnQxNigpO3ZhciBuPWUucmVhZEludDE2KCk7ZS5za2lwKDIpO3ZhciBvPWUucmVhZEludDE2KCkscj1lLnJlYWRJbnQxNigpLGg9ZS5yZWFkSW50MTYoKSxsPWUucmVhZEludDE2KCk7cy5ib3VuZHM9bmV3IGQobnVsbCxvLHIsaCxsKSxzLnNjYW5zPVtdO2Zvcih2YXIgYz0wO2M8bjtjKyspcy5zY2Fucy5wdXNoKG5ldyBnKGUpKTtzLl91cGRhdGVDb21wbGV4aXR5KCl9ZWxzZSBpZihudWxsIT1pKXtpZihzLmJvdW5kcz1udWxsIT1pLmJvdW5kcz9pLmJvdW5kcy5jbG9uZSgpOm51bGwsbnVsbCE9aS5zY2Fucylmb3Iocy5zY2Fucz1bXSxjPTA7YzxpLnNjYW5zLmxlbmd0aDtjKyspcy5zY2Fucy5wdXNoKGkuc2NhbnNbY10uY2xvbmUoKSk7ZWxzZSBzLnNjYW5zPW51bGw7cy5jb21wbGV4aXR5PWkuY29tcGxleGl0eX1lbHNlIHMuYm91bmRzPW51bGwscy5zY2Fucz1udWxsLHMuY29tcGxleGl0eT0wO3JldHVybiBzfXJldHVybiBmKGUsdCksZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUobnVsbCx0aGlzKX0sZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4ie2NvbXBsZXhpdHk6ICIrWyJudWxsIiwic2ltcGxlIiwiY29tcGxleCJdW3RoaXMuY29tcGxleGl0eV0rIiBib3VuZHM6ICIrKG51bGwhPXRoaXMuYm91bmRzP3RoaXMuYm91bmRzLnRvU3RyaW5nKCk6Iltub25lXSIpKyIgI3NjYW5zOiAiKyhudWxsIT10aGlzLnNjYW5zP3RoaXMuc2NhbnMubGVuZ3RoOiJbbm9uZV0iKSsifSJ9LGUucHJvdG90eXBlLl91cGRhdGVDb21wbGV4aXR5PWZ1bmN0aW9uKCl7aWYobnVsbD09dGhpcy5ib3VuZHMpdGhpcy5jb21wbGV4aXR5PTAsdGhpcy5zY2Fucz1udWxsO2Vsc2UgaWYodGhpcy5ib3VuZHMuZW1wdHkoKSl0aGlzLmNvbXBsZXhpdHk9MCx0aGlzLnNjYW5zPW51bGwsdGhpcy5ib3VuZHM9bnVsbDtlbHNlIGlmKG51bGw9PXRoaXMuc2NhbnMpdGhpcy5jb21wbGV4aXR5PTE7ZWxzZSBpZih0aGlzLmNvbXBsZXhpdHk9MiwxPT09dGhpcy5zY2Fucy5sZW5ndGgpe3ZhciB0PXRoaXMuc2NhbnNbMF07aWYodC50b3A9PT10aGlzLmJvdW5kcy50b3AmJnQuYm90dG9tPT09dGhpcy5ib3VuZHMuYm90dG9tJiYxPT09dC5zY2FubGluZXMubGVuZ3RoKXt2YXIgZT10LnNjYW5saW5lc1swXTtlLmxlZnQ9PT10aGlzLmJvdW5kcy5sZWZ0JiZlLnJpZ2h0PT09dGhpcy5ib3VuZHMucmlnaHQmJih0aGlzLnNjYW5zPW51bGwsdGhpcy5jb21wbGV4aXR5PTEpfX19LGUucHJvdG90eXBlLnN1YnRyYWN0PWZ1bmN0aW9uKHQpe2lmKGMubG9nKCJbd21mXSBSZWdpb24gIit0aGlzLnRvU3RyaW5nKCkrIiBzdWJ0cmFjdCAiK3QudG9TdHJpbmcoKSksbnVsbCE9dGhpcy5ib3VuZHMmJm51bGwhPXRoaXMuYm91bmRzLmludGVyc2VjdCh0KSl7bnVsbD09dGhpcy5zY2FucyYmKHRoaXMuc2NhbnM9W10sdGhpcy5zY2Fucy5wdXNoKG5ldyBnKG51bGwsbnVsbCx0aGlzLmJvdW5kcy50b3AsdGhpcy5ib3VuZHMuYm90dG9tLFt7bGVmdDp0aGlzLmJvdW5kcy5sZWZ0LHJpZ2h0OnRoaXMuYm91bmRzLnJpZ2h0fV0pKSx0aGlzLmNvbXBsZXhpdHk9Mik7Zm9yKHZhciBlPTA7ZTx0aGlzLnNjYW5zLmxlbmd0aDspe2lmKCh1PXRoaXMuc2NhbnNbZV0pLmJvdHRvbT49dC50b3Ape3ZhciBpPXUuY2xvbmUoKTt1LmJvdHRvbT10LnRvcC0xLGkudG9wPXQudG9wLHUudG9wPj11LmJvdHRvbT90aGlzLnNjYW5zW2VdPWk6KGMubG9nKCJbd21mXSBSZWdpb24gc3BsaXQgdG9wIHNjYW4gIitlKyIgZm9yIHN1YnN0cmFjdGlvbiIpLHRoaXMuc2NhbnMuc3BsaWNlKCsrZSwwLGkpKTticmVha31lKyt9Zm9yKHZhciBzPWU7ZTx0aGlzLnNjYW5zLmxlbmd0aCYmISgodT10aGlzLnNjYW5zW2VdKS50b3A+dC5ib3R0b20pOyl7aWYodS5ib3R0b20+dC5ib3R0b20pe2k9dS5jbG9uZSgpLHUuYm90dG9tPXQuYm90dG9tLGkudG9wPXQuYm90dG9tKzEsdS50b3A+PXUuYm90dG9tP3RoaXMuc2NhbnNbZV09aTooYy5sb2coIlt3bWZdIFJlZ2lvbiBzcGxpdCBib3R0b20gc2NhbiAiK2UrIiBmb3Igc3Vic3RyYWN0aW9uIiksdGhpcy5zY2Fucy5zcGxpY2UoKytlLDAsaSkpO2JyZWFrfWUrK31pZihzPHRoaXMuc2NhbnMubGVuZ3RoKXt2YXIgbj1lO2ZvcihlPXM7ZTxuOykodT10aGlzLnNjYW5zW2VdKS5zdWJ0cmFjdCh0LmxlZnQsdC5yaWdodCk/ZSsrOihjLmxvZygiW3dtZl0gUmVnaW9uIHJlbW92ZSBub3cgZW1wdHkgc2NhbiAiK2UrIiBkdWUgdG8gc3VidHJhY3Rpb24iKSx0aGlzLnNjYW5zLnNwbGljZShlLDEpLG4tLSl9aWYobnVsbCE9dGhpcy5zY2Fucyl7Zm9yKHZhciBvLHI9dm9pZCAwLGE9dm9pZCAwLGg9dm9pZCAwLGw9dGhpcy5zY2Fucy5sZW5ndGgscD0wO3A8bDtwKyspe3ZhciB1PXRoaXMuc2NhbnNbcF07MD09PXAmJihvPXUudG9wKSxwPT09bC0xJiYoaD11LmJvdHRvbSk7dmFyIFQ9dS5zY2FubGluZXMubGVuZ3RoO2lmKFQ+MCl7dmFyIGY9dS5zY2FubGluZXNbMF07KG51bGw9PXJ8fGYubGVmdDxyKSYmKHI9Zi5sZWZ0KSxmPXUuc2NhbmxpbmVzW1QtMV0sKG51bGw9PWF8fGYucmlnaHQ+YSkmJihhPWYucmlnaHQpfX1udWxsIT1yJiZudWxsIT1vJiZudWxsIT1hJiZudWxsIT1oPyh0aGlzLmJvdW5kcz1uZXcgZChudWxsLHIsbyxhLGgpLHRoaXMuX3VwZGF0ZUNvbXBsZXhpdHkoKSk6KHRoaXMuYm91bmRzPW51bGwsdGhpcy5zY2Fucz1udWxsLHRoaXMuY29tcGxleGl0eT0wKX1lbHNlIHRoaXMuX3VwZGF0ZUNvbXBsZXhpdHkoKX1jLmxvZygiW3dtZl0gUmVnaW9uIHN1YnRyYWN0aW9uIC0+ICIrdGhpcy50b1N0cmluZygpKX0sZS5wcm90b3R5cGUuaW50ZXJzZWN0PWZ1bmN0aW9uKHQpe2lmKGMubG9nKCJbd21mXSBSZWdpb24gIit0aGlzLnRvU3RyaW5nKCkrIiBpbnRlcnNlY3Qgd2l0aCAiK3QudG9TdHJpbmcoKSksbnVsbCE9dGhpcy5ib3VuZHMpaWYodGhpcy5ib3VuZHM9dGhpcy5ib3VuZHMuaW50ZXJzZWN0KHQpLG51bGwhPXRoaXMuYm91bmRzKXtpZihudWxsIT10aGlzLnNjYW5zKXtmb3IodmFyIGU9MDtlPHRoaXMuc2NhbnMubGVuZ3RoJiYoaT10aGlzLnNjYW5zW2VdKS5ib3R0b208dGhpcy5ib3VuZHMudG9wOyllKys7Zm9yKGU+MCYmKGMubG9nKCJbd21mXSBSZWdpb24gcmVtb3ZlICIrZSsiIHNjYW5zIGZyb20gdG9wIiksdGhpcy5zY2Fucy5zcGxpY2UoMCxlKSx0aGlzLnNjYW5zLmxlbmd0aD4wJiYodGhpcy5zY2Fuc1swXS50b3A9dGhpcy5ib3VuZHMudG9wKSksZT0wO2U8dGhpcy5zY2Fucy5sZW5ndGg7KXt2YXIgaTtpZigoaT10aGlzLnNjYW5zW2VdKS50b3A+dGhpcy5ib3VuZHMuYm90dG9tKXtjLmxvZygiW3dtZl0gUmVnaW9uIHJlbW92ZSAiKyh0aGlzLnNjYW5zLmxlbmd0aC1lKSsiIHNjYW5zIGZyb20gYm90dG9tIiksdGhpcy5zY2Fucy5zcGxpY2UoZSx0aGlzLnNjYW5zLmxlbmd0aC1lKTticmVha31pLmludGVyc2VjdCh0aGlzLmJvdW5kcy5sZWZ0LHRoaXMuYm91bmRzLnJpZ2h0KT9lKys6KGMubG9nKCJbd21mXSBSZWdpb24gcmVtb3ZlIG5vdyBlbXB0eSBzY2FuICIrZSsiIGR1ZSB0byBpbnRlcnNlY3Rpb24iKSx0aGlzLnNjYW5zLnNwbGljZShlLDEpKX10aGlzLnNjYW5zLmxlbmd0aD4wJiYodGhpcy5zY2Fuc1t0aGlzLnNjYW5zLmxlbmd0aC0xXS5ib3R0b209dGhpcy5ib3VuZHMuYm90dG9tKSx0aGlzLl91cGRhdGVDb21wbGV4aXR5KCl9fWVsc2UgdGhpcy5zY2Fucz1udWxsLHRoaXMuY29tcGxleGl0eT0wO2MubG9nKCJbd21mXSBSZWdpb24gaW50ZXJzZWN0aW9uIC0+ICIrdGhpcy50b1N0cmluZygpKX0sZS5wcm90b3R5cGUub2Zmc2V0PWZ1bmN0aW9uKHQsZSl7aWYobnVsbCE9dGhpcy5ib3VuZHMmJih0aGlzLmJvdW5kcy5sZWZ0Kz10LHRoaXMuYm91bmRzLnRvcCs9ZSx0aGlzLmJvdW5kcy5yaWdodCs9dCx0aGlzLmJvdW5kcy5ib3R0b20rPWUpLG51bGwhPXRoaXMuc2NhbnMpZm9yKHZhciBpPXRoaXMuc2NhbnMubGVuZ3RoLHM9MDtzPGk7cysrKXt2YXIgbj10aGlzLnNjYW5zW3NdO24udG9wKz1lLG4uYm90dG9tKz1lO2Zvcih2YXIgbz1uLnNjYW5saW5lcy5sZW5ndGgscj0wO3I8bztyKyspe3ZhciBhPW4uc2NhbmxpbmVzW3JdO2EubGVmdCs9dCxhLnJpZ2h0Kz10fX19LGV9KFQpLGc9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpLHMsbil7aWYobnVsbCE9dCl7dmFyIG89dC5yZWFkVWludDE2KCk7dGhpcy50b3A9dC5yZWFkVWludDE2KCksdGhpcy5ib3R0b209dC5yZWFkVWludDE2KCksdGhpcy5zY2FubGluZXM9W107Zm9yKHZhciByPTA7cjxvO3IrKyl7dmFyIGE9dC5yZWFkVWludDE2KCksaD10LnJlYWRVaW50MTYoKTt0aGlzLnNjYW5saW5lcy5wdXNoKHtsZWZ0OmEscmlnaHQ6aH0pfXQuc2tpcCgyKX1lbHNlIGlmKG51bGwhPWUpZm9yKHRoaXMudG9wPWUudG9wLHRoaXMuYm90dG9tPWUuYm90dG9tLHRoaXMuc2NhbmxpbmVzPVtdLHI9MDtyPGUuc2NhbmxpbmVzLmxlbmd0aDtyKyspe3ZhciBsPWUuc2NhbmxpbmVzW3JdO3RoaXMuc2NhbmxpbmVzLnB1c2goe2xlZnQ6bC5sZWZ0LHJpZ2h0OmwucmlnaHR9KX1lbHNlIHRoaXMudG9wPWksdGhpcy5ib3R0b209cyx0aGlzLnNjYW5saW5lcz1ufXJldHVybiB0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgdChudWxsLHRoaXMpfSx0LnByb3RvdHlwZS5zdWJ0cmFjdD1mdW5jdGlvbih0LGUpe3ZhciBpO2ZvcihpPTA7aTx0aGlzLnNjYW5saW5lcy5sZW5ndGgmJihvPXRoaXMuc2NhbmxpbmVzW2ldKS5sZWZ0PD10OylvLnJpZ2h0Pj10JiYoby5yaWdodD10LTEsby5sZWZ0Pj1vLnJpZ2h0KT90aGlzLnNjYW5saW5lcy5zcGxpY2UoaSwxKTppKys7Zm9yKHZhciBzPWksbj0wO2k8dGhpcy5zY2FubGluZXMubGVuZ3RoOyl7dmFyIG87aWYoKG89dGhpcy5zY2FubGluZXNbaV0pLnJpZ2h0PmUpe28ubGVmdD1lLG49aS1zLG8ubGVmdD49by5yaWdodCYmbisrO2JyZWFrfWkrK31yZXR1cm4gbj4wJiZzPHRoaXMuc2NhbmxpbmVzLmxlbmd0aCYmdGhpcy5zY2FubGluZXMuc3BsaWNlKHMsbiksdGhpcy5zY2FubGluZXMubGVuZ3RoPjB9LHQucHJvdG90eXBlLmludGVyc2VjdD1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wO2k8dGhpcy5zY2FubGluZXMubGVuZ3RoO2krKylpZigocz10aGlzLnNjYW5saW5lc1tpXSkubGVmdD49dHx8cy5yaWdodD49dCl7aT4wJiZ0aGlzLnNjYW5saW5lcy5zcGxpY2UoMCxpKTticmVha31pZih0aGlzLnNjYW5saW5lcy5sZW5ndGg+MCl7dmFyIHM7Zm9yKChzPXRoaXMuc2NhbmxpbmVzWzBdKS5sZWZ0PHQmJihzLmxlZnQ9dCksaT0wO2k8dGhpcy5zY2FubGluZXMubGVuZ3RoO2krKylpZigocz10aGlzLnNjYW5saW5lc1tpXSkubGVmdD5lKXt0aGlzLnNjYW5saW5lcy5zcGxpY2UoaSx0aGlzLnNjYW5saW5lcy5sZW5ndGgtaSk7YnJlYWt9dGhpcy5zY2FubGluZXMubGVuZ3RoPjAmJihzPXRoaXMuc2NhbmxpbmVzW3RoaXMuc2NhbmxpbmVzLmxlbmd0aC0xXSkucmlnaHQ+ZSYmKHMucmlnaHQ9ZSl9cmV0dXJuIHRoaXMuc2NhbmxpbmVzLmxlbmd0aD4wfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJ7ICNzY2FubGluZXM6ICIrdGhpcy5zY2FubGluZXMubGVuZ3RoKyJ9In0sdH0oKSxfPWZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdD1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24odCxlKXt0Ll9fcHJvdG9fXz1lfXx8ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxpKSYmKHRbaV09ZVtpXSl9LHQoZSxpKX07cmV0dXJuIGZ1bmN0aW9uKGUsaSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGkmJm51bGwhPT1pKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcoaSkrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZnVuY3Rpb24gcygpe3RoaXMuY29uc3RydWN0b3I9ZX10KGUsaSksZS5wcm90b3R5cGU9bnVsbD09PWk/T2JqZWN0LmNyZWF0ZShpKToocy5wcm90b3R5cGU9aS5wcm90b3R5cGUsbmV3IHMpfX0oKSx5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2UmJnQuc2tpcCg0KSx0aGlzLndpZHRoPXQucmVhZFVpbnQxNigpLHRoaXMuaGVpZ2h0PXQucmVhZFVpbnQxNigpLHRoaXMucGxhbmVzPXQucmVhZFVpbnQxNigpLHRoaXMuYml0Y291bnQ9dC5yZWFkVWludDE2KCl9cmV0dXJuIHQucHJvdG90eXBlLmNvbG9ycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJpdGNvdW50PD04PzE8PHRoaXMuYml0Y291bnQ6MH0sdH0oKSxTPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2UmJnQuc2tpcCg0KSx0aGlzLndpZHRoPXQucmVhZEludDMyKCksdGhpcy5oZWlnaHQ9dC5yZWFkSW50MzIoKSx0aGlzLnBsYW5lcz10LnJlYWRVaW50MTYoKSx0aGlzLmJpdGNvdW50PXQucmVhZFVpbnQxNigpLHRoaXMuY29tcHJlc3Npb249dC5yZWFkVWludDMyKCksdGhpcy5zaXplaW1hZ2U9dC5yZWFkVWludDMyKCksdGhpcy54cGVsc3Blcm1ldGVyPXQucmVhZEludDMyKCksdGhpcy55cGVsc3Blcm1ldGVyPXQucmVhZEludDMyKCksdGhpcy5jbHJ1c2VkPXQucmVhZFVpbnQzMigpLHRoaXMuY2xyaW1wb3J0YW50PXQucmVhZFVpbnQzMigpfXJldHVybiB0LnByb3RvdHlwZS5jb2xvcnM9ZnVuY3Rpb24oKXtyZXR1cm4gMCE9PXRoaXMuY2xydXNlZD90aGlzLmNscnVzZWQ8MjU2P3RoaXMuY2xydXNlZDoyNTY6dGhpcy5iaXRjb3VudD44PzA6MTw8dGhpcy5iaXRjb3VudH0sdH0oKSxJPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuX3JlYWRlcj10LHRoaXMuX29mZnNldD10LnBvcyx0aGlzLl91c2VyZ2I9ZTt2YXIgaT10LnJlYWRVaW50MzIoKTtpZih0aGlzLl9pbmZvc2l6ZT1pLGk9PT1jLkdESS5CSVRNQVBDT1JFSEVBREVSX1NJWkUpdGhpcy5faGVhZGVyPW5ldyB5KHQsITEpLHRoaXMuX2luZm9zaXplKz10aGlzLl9oZWFkZXIuY29sb3JzKCkqKGU/MzoyKTtlbHNle3RoaXMuX2hlYWRlcj1uZXcgUyh0LCExKTt2YXIgcz10aGlzLl9oZWFkZXIuY29tcHJlc3Npb249PT1jLkdESS5CaXRtYXBDb21wcmVzc2lvbi5CSV9CSVRGSUVMRFM/MzowO2k8PWMuR0RJLkJJVE1BUElORk9IRUFERVJfU0laRSs0KnMmJih0aGlzLl9pbmZvc2l6ZT1jLkdESS5CSVRNQVBJTkZPSEVBREVSX1NJWkUrNCpzKSx0aGlzLl9pbmZvc2l6ZSs9dGhpcy5faGVhZGVyLmNvbG9ycygpKihlPzQ6Mil9fXJldHVybiB0LnByb3RvdHlwZS5nZXRXaWR0aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oZWFkZXIud2lkdGh9LHQucHJvdG90eXBlLmdldEhlaWdodD1mdW5jdGlvbigpe3JldHVybiBNYXRoLmFicyh0aGlzLl9oZWFkZXIuaGVpZ2h0KX0sdC5wcm90b3R5cGUuaW5mb3NpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW5mb3NpemV9LHQucHJvdG90eXBlLmhlYWRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oZWFkZXJ9LHR9KCksdj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt0aGlzLl9yZWFkZXI9dCx0aGlzLl9vZmZzZXQ9dC5wb3MsdGhpcy5fc2l6ZT1lLHRoaXMuX2luZm89bmV3IEkodCwhMCl9cmV0dXJuIHQucHJvdG90eXBlLmdldFdpZHRoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2luZm8uZ2V0V2lkdGgoKX0sdC5wcm90b3R5cGUuZ2V0SGVpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2luZm8uZ2V0SGVpZ2h0KCl9LHQucHJvdG90eXBlLmJhc2U2NHJlZj1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX3JlYWRlci5wb3M7dGhpcy5fcmVhZGVyLnNlZWsodGhpcy5fb2Zmc2V0KTt2YXIgZSxpPSJpbWFnZS9ibXAiLHM9dGhpcy5faW5mby5oZWFkZXIoKTtpZihzIGluc3RhbmNlb2YgUyYmbnVsbCE9cy5jb21wcmVzc2lvbilzd2l0Y2gocy5jb21wcmVzc2lvbil7Y2FzZSBjLkdESS5CaXRtYXBDb21wcmVzc2lvbi5CSV9KUEVHOmk9ImRhdGE6aW1hZ2UvanBlZyI7YnJlYWs7Y2FzZSBjLkdESS5CaXRtYXBDb21wcmVzc2lvbi5CSV9QTkc6aT0iZGF0YTppbWFnZS9wbmciO2JyZWFrO2RlZmF1bHQ6ZT10aGlzLm1ha2VCaXRtYXBGaWxlSGVhZGVyKCl9ZWxzZSBlPXRoaXMubWFrZUJpdG1hcEZpbGVIZWFkZXIoKTtudWxsIT1lP2UrPXRoaXMuX3JlYWRlci5yZWFkQmluYXJ5KHRoaXMuX3NpemUpOmU9dGhpcy5fcmVhZGVyLnJlYWRCaW5hcnkodGhpcy5fc2l6ZSk7dmFyIG49ImRhdGE6IitpKyI7YmFzZTY0LCIrYnRvYShlKTtyZXR1cm4gdGhpcy5fcmVhZGVyLnNlZWsodCksbn0sdC5wcm90b3R5cGUubWFrZUJpdG1hcEZpbGVIZWFkZXI9ZnVuY3Rpb24oKXt2YXIgdD1uZXcgQXJyYXlCdWZmZXIoMTQpLGU9bmV3IFVpbnQ4QXJyYXkodCk7cmV0dXJuIGVbMF09NjYsZVsxXT03NyxjLl93cml0ZVVpbnQzMlZhbChlLDIsdGhpcy5fc2l6ZSsxNCksYy5fd3JpdGVVaW50MzJWYWwoZSwxMCx0aGlzLl9pbmZvLmluZm9zaXplKCkrMTQpLGMuX2Jsb2JUb0JpbmFyeShlKX0sdH0oKSxBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2lmKG51bGwhPXQpe2lmKGU9ZSx0aGlzLl9yZWFkZXI9dCx0aGlzLl9vZmZzZXQ9dC5wb3MsdGhpcy5fc2l6ZT1lLHRoaXMudHlwZT10LnJlYWRJbnQxNigpLHRoaXMud2lkdGg9dC5yZWFkSW50MTYoKSx0aGlzLmhlaWdodD10LnJlYWRJbnQxNigpLHRoaXMud2lkdGhCeXRlcz10LnJlYWRJbnQxNigpLHRoaXMucGxhbmVzPXQucmVhZFVpbnQ4KCksdGhpcy5iaXRzUGl4ZWw9dC5yZWFkVWludDgoKSx0aGlzLmJpdHNPZmZzZXQ9dC5wb3MsdGhpcy5iaXRzU2l6ZT0odGhpcy53aWR0aCp0aGlzLmJpdHNQaXhlbCsxNT4+NDw8MSkqdGhpcy5oZWlnaHQsdGhpcy5iaXRzU2l6ZT5lLTEwKXRocm93IG5ldyBhKCJCaXRtYXAgc2hvdWxkIGhhdmUgIit0aGlzLmJpdHNTaXplKyIgYnl0ZXMsIGJ1dCBoYXMgIisoZS0xMCkpfWVsc2V7dmFyIGk9ZTt0aGlzLl9yZWFkZXI9aS5fcmVhZGVyLHRoaXMuX29mZnNldD1pLl9vZmZzZXQsdGhpcy5fc2l6ZT1pLl9zaXplLHRoaXMudHlwZT1pLnR5cGUsdGhpcy53aWR0aD1pLndpZHRoLHRoaXMuaGVpZ2h0PWkuaGVpZ2h0LHRoaXMud2lkdGhCeXRlcz1pLndpZHRoQnl0ZXMsdGhpcy5wbGFuZXM9aS5wbGFuZXMsdGhpcy5iaXRzUGl4ZWw9aS5iaXRzUGl4ZWwsdGhpcy5iaXRzT2Zmc2V0PWkuYml0c09mZnNldCx0aGlzLmJpdHNTaXplPWkuYml0c1NpemV9fXJldHVybiB0LnByb3RvdHlwZS5nZXRXaWR0aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLndpZHRofSx0LnByb3RvdHlwZS5nZXRIZWlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZWlnaHR9LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KG51bGwsdGhpcyl9LHR9KCksYj1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIHM9dC5jYWxsKHRoaXMsZSxpKXx8dGhpcztyZXR1cm4gbnVsbCE9ZSYmKHMuYml0c09mZnNldCs9MjIpLHN9cmV0dXJuIF8oZSx0KSxlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgZShudWxsLHRoaXMpfSxlfShBKSx3PWZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdD1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24odCxlKXt0Ll9fcHJvdG9fXz1lfXx8ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxpKSYmKHRbaV09ZVtpXSl9LHQoZSxpKX07cmV0dXJuIGZ1bmN0aW9uKGUsaSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGkmJm51bGwhPT1pKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcoaSkrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZnVuY3Rpb24gcygpe3RoaXMuY29uc3RydWN0b3I9ZX10KGUsaSksZS5wcm90b3R5cGU9bnVsbD09PWk/T2JqZWN0LmNyZWF0ZShpKToocy5wcm90b3R5cGU9aS5wcm90b3R5cGUsbmV3IHMpfX0oKSxSPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxzKXtudWxsIT10Pyh0aGlzLnI9dC5yZWFkVWludDgoKSx0aGlzLmc9dC5yZWFkVWludDgoKSx0aGlzLmI9dC5yZWFkVWludDgoKSx0LnNraXAoMSkpOih0aGlzLnI9ZSx0aGlzLmc9aSx0aGlzLmI9cyl9cmV0dXJuIHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KG51bGwsdGhpcy5yLHRoaXMuZyx0aGlzLmIpfSx0LnByb3RvdHlwZS50b0hleD1mdW5jdGlvbigpe3JldHVybigxNjc3NzIxNisodGhpcy5yPDwxNnx0aGlzLmc8PDh8dGhpcy5iKSkudG9TdHJpbmcoMTYpLnNsaWNlKDEpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJ7cjogIit0aGlzLnIrIiwgZzogIit0aGlzLmcrIiwgYjogIit0aGlzLmIrIn0ifSx0fSgpLE89ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3ZhciBzPXQuY2FsbCh0aGlzLCJmb250Iil8fHRoaXM7aWYobnVsbCE9ZSl7cy5oZWlnaHQ9ZS5yZWFkSW50MTYoKSxzLndpZHRoPWUucmVhZEludDE2KCkscy5lc2NhcGVtZW50PWUucmVhZEludDE2KCkscy5vcmllbnRhdGlvbj1lLnJlYWRJbnQxNigpLHMud2VpZ2h0PWUucmVhZEludDE2KCkscy5pdGFsaWM9ZS5yZWFkVWludDgoKSxzLnVuZGVybGluZT1lLnJlYWRVaW50OCgpLHMuc3RyaWtlb3V0PWUucmVhZFVpbnQ4KCkscy5jaGFyc2V0PWUucmVhZFVpbnQ4KCkscy5vdXRwcmVjaXNpb249ZS5yZWFkVWludDgoKSxzLmNsaXBwcmVjaXNpb249ZS5yZWFkVWludDgoKSxzLnF1YWxpdHk9ZS5yZWFkVWludDgoKTt2YXIgbj1lLnJlYWRVaW50OCgpO3MucGl0Y2g9MTUmbixzLmZhbWlseT1uPj42JjM7dmFyIG89aSxyPWUucG9zO3MuZmFjZW5hbWU9ZS5yZWFkTnVsbFRlcm1TdHJpbmcoTWF0aC5taW4oby0oZS5wb3MtciksMzIpKX1lbHNlIG51bGwhPWk/KGk9aSxzLmhlaWdodD1pLmhlaWdodCxzLndpZHRoPWkud2lkdGgscy5lc2NhcGVtZW50PWkuZXNjYXBlbWVudCxzLm9yaWVudGF0aW9uPWkub3JpZW50YXRpb24scy53ZWlnaHQ9aS53ZWlnaHQscy5pdGFsaWM9aS5pdGFsaWMscy51bmRlcmxpbmU9aS51bmRlcmxpbmUscy5zdHJpa2VvdXQ9aS5zdHJpa2VvdXQscy5jaGFyc2V0PWkuY2hhcnNldCxzLm91dHByZWNpc2lvbj1pLm91dHByZWNpc2lvbixzLmNsaXBwcmVjaXNpb249aS5jbGlwcHJlY2lzaW9uLHMucXVhbGl0eT1pLnF1YWxpdHkscy5waXRjaD1pLnBpdGNoLHMuZmFtaWx5PWkuZmFtaWx5LHMuZmFjZW5hbWU9aS5mYWNlbmFtZSk6KHMuaGVpZ2h0PS04MCxzLndpZHRoPTAscy5lc2NhcGVtZW50PTAscy5vcmllbnRhdGlvbj0wLHMud2VpZ2h0PTQwMCxzLml0YWxpYz0wLHMudW5kZXJsaW5lPTAscy5zdHJpa2VvdXQ9MCxzLmNoYXJzZXQ9MCxzLm91dHByZWNpc2lvbj0wLHMuY2xpcHByZWNpc2lvbj0wLHMucXVhbGl0eT0wLHMucGl0Y2g9MCxzLmZhbWlseT0wLHMuZmFjZW5hbWU9IkhlbHZldGljYSIpO3JldHVybiBzfXJldHVybiB3KGUsdCksZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUobnVsbCx0aGlzKX0sZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyl9LGV9KFQpLEQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkscyl7dmFyIG49dC5jYWxsKHRoaXMsImJydXNoIil8fHRoaXM7aWYobnVsbCE9ZSl7dmFyIG89aSxyPWUucG9zO2lmKCEwPT09c3x8ITE9PT1zKXN3aXRjaChuLnN0eWxlPWUucmVhZFVpbnQxNigpLHMmJm4uc3R5bGUhPT1jLkdESS5CcnVzaFN0eWxlLkJTX1BBVFRFUk4mJihuLnN0eWxlPWMuR0RJLkJydXNoU3R5bGUuQlNfRElCUEFUVEVSTlBUKSxuLnN0eWxlKXtjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfU09MSUQ6bi5jb2xvcj1uZXcgUihlKTticmVhaztjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfUEFUVEVSTjplLnNraXAocz8yOjYpLG4ucGF0dGVybj1uZXcgQShlLG8tKGUucG9zLXIpKTticmVhaztjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfRElCUEFUVEVSTlBUOm4uY29sb3J1c2FnZT1zP2UucmVhZFVpbnQxNigpOmUucmVhZFVpbnQzMigpLHN8fGUuc2tpcCgyKSxuLmRpYnBhdHRlcm5wdD1uZXcgdihlLG8tKGUucG9zLXIpKTticmVhaztjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfSEFUQ0hFRDpuLmNvbG9yPW5ldyBSKGUpLG4uaGF0Y2hzdHlsZT1lLnJlYWRVaW50MTYoKX1lbHNlIHMgaW5zdGFuY2VvZiBiJiYobi5zdHlsZT1jLkdESS5CcnVzaFN0eWxlLkJTX1BBVFRFUk4sbi5wYXR0ZXJuPXMpfWVsc2UgaWYobnVsbCE9aSlzd2l0Y2goaT1pLG4uc3R5bGU9aS5zdHlsZSxuLnN0eWxlKXtjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfU09MSUQ6bi5jb2xvcj1pLmNvbG9yLmNsb25lKCk7YnJlYWs7Y2FzZSBjLkdESS5CcnVzaFN0eWxlLkJTX1BBVFRFUk46bi5wYXR0ZXJuPWkucGF0dGVybi5jbG9uZSgpO2JyZWFrO2Nhc2UgYy5HREkuQnJ1c2hTdHlsZS5CU19ESUJQQVRURVJOUFQ6bi5jb2xvcnVzYWdlPWkuY29sb3J1c2FnZSxuLmRpYnBhdHRlcm5wdD1pLmRpYnBhdHRlcm5wdDticmVhaztjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfSEFUQ0hFRDpuLmNvbG9yPWkuY29sb3IuY2xvbmUoKSxuLmhhdGNoc3R5bGU9aS5oYXRjaHN0eWxlfXJldHVybiBufXJldHVybiB3KGUsdCksZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUobnVsbCx0aGlzKX0sZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgdD0ie3N0eWxlOiAiK3RoaXMuc3R5bGU7c3dpdGNoKHRoaXMuc3R5bGUpe2Nhc2UgYy5HREkuQnJ1c2hTdHlsZS5CU19TT0xJRDp0Kz0iLCBjb2xvcjogIit0aGlzLmNvbG9yLnRvU3RyaW5nKCk7YnJlYWs7Y2FzZSBjLkdESS5CcnVzaFN0eWxlLkJTX0RJQlBBVFRFUk5QVDp0Kz0iLCBjb2xvcnVzYWdlOiAiK3RoaXMuY29sb3J1c2FnZTticmVhaztjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfSEFUQ0hFRDp0Kz0iLCBjb2xvcjogIit0aGlzLmNvbG9yLnRvU3RyaW5nKCkrIiwgaGF0Y2hzdHlsZTogIit0aGlzLmhhdGNoc3R5bGV9cmV0dXJuIHQrIn0ifSxlfShUKSxNPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpLHMsbixvLHIpe3ZhciBhPXQuY2FsbCh0aGlzLCJwZW4iKXx8dGhpcztyZXR1cm4gbnVsbCE9ZT8oaT1lLnJlYWRVaW50MTYoKSxhLnN0eWxlPTI1NSZpLGEud2lkdGg9bmV3IHUoZSksYS5jb2xvcj1uZXcgUihlKSxhLmxpbmVjYXA9aSYoYy5HREkuUGVuU3R5bGUuUFNfRU5EQ0FQX1NRVUFSRXxjLkdESS5QZW5TdHlsZS5QU19FTkRDQVBfRkxBVCksYS5qb2luPWkmKGMuR0RJLlBlblN0eWxlLlBTX0pPSU5fQkVWRUx8Yy5HREkuUGVuU3R5bGUuUFNfSk9JTl9NSVRFUikpOihhLnN0eWxlPWksYS53aWR0aD1zLGEuY29sb3I9bixhLmxpbmVjYXA9byxhLmpvaW49ciksYX1yZXR1cm4gdyhlLHQpLGUucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKG51bGwsdGhpcy5zdHlsZSx0aGlzLndpZHRoLmNsb25lKCksdGhpcy5jb2xvci5jbG9uZSgpLHRoaXMubGluZWNhcCx0aGlzLmpvaW4pfSxlLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJ7c3R5bGU6ICIrdGhpcy5zdHlsZSsiLCB3aWR0aDogIit0aGlzLndpZHRoLnRvU3RyaW5nKCkrIiwgY29sb3I6ICIrdGhpcy5jb2xvci50b1N0cmluZygpKyIsIGxpbmVjYXA6ICIrdGhpcy5saW5lY2FwKyIsIGpvaW46ICIrdGhpcy5qb2luKyJ9In0sZX0oVCksUD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtudWxsIT10Pyh0aGlzLmZsYWc9dC5yZWFkVWludDgoKSx0aGlzLmI9dC5yZWFkVWludDgoKSx0aGlzLmc9dC5yZWFkVWludDgoKSx0aGlzLnI9dC5yZWFkVWludDgoKSk6KHRoaXMuZmxhZz1lLmZsYWcsdGhpcy5iPWUuYix0aGlzLmc9ZS5nLHRoaXMucj1lLnIpfXJldHVybiB0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgdChudWxsLHRoaXMpfSx0fSgpLG09ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3ZhciBzPXQuY2FsbCh0aGlzLCJwYWxldHRlIil8fHRoaXM7aWYobnVsbCE9ZSl7cy5zdGFydD1lLnJlYWRVaW50MTYoKTt2YXIgbj1lLnJlYWRVaW50MTYoKTtmb3Iocy5lbnRyaWVzPVtdO24+MDspcy5lbnRyaWVzLnB1c2gobmV3IFAoZSkpLG4tLX1lbHNle3Muc3RhcnQ9aS5zdGFydCxzLmVudHJpZXM9W107Zm9yKHZhciBvPWkuZW50cmllcy5sZW5ndGgscj0wO3I8bztyKyspcy5lbnRyaWVzLnB1c2goaS5lbnRyaWVzW3JdKX1yZXR1cm4gc31yZXR1cm4gdyhlLHQpLGUucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKG51bGwsdGhpcyl9LGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuInsgI2VudHJpZXM6ICIrdGhpcy5lbnRyaWVzLmxlbmd0aCsifSJ9LGV9KFQpLEM9ZnVuY3Rpb24odCxlKXtpZihudWxsIT10KWZvcih2YXIgaSBpbiB0aGlzLl9zdmdncm91cD10Ll9zdmdncm91cCx0aGlzLl9zdmdjbGlwQ2hhbmdlZD10Ll9zdmdjbGlwQ2hhbmdlZCx0aGlzLl9zdmd0ZXh0YmtmaWx0ZXI9dC5fc3ZndGV4dGJrZmlsdGVyLHRoaXMubWFwbW9kZT10Lm1hcG1vZGUsdGhpcy5zdHJldGNobW9kZT10LnN0cmV0Y2htb2RlLHRoaXMudGV4dGFsaWduPXQudGV4dGFsaWduLHRoaXMuYmttb2RlPXQuYmttb2RlLHRoaXMudGV4dGNvbG9yPXQudGV4dGNvbG9yLmNsb25lKCksdGhpcy5ia2NvbG9yPXQuYmtjb2xvci5jbG9uZSgpLHRoaXMucG9seWZpbGxtb2RlPXQucG9seWZpbGxtb2RlLHRoaXMud3g9dC53eCx0aGlzLnd5PXQud3ksdGhpcy53dz10Lnd3LHRoaXMud2g9dC53aCx0aGlzLnZ4PXQudngsdGhpcy52eT10LnZ5LHRoaXMudnc9dC52dyx0aGlzLnZoPXQudmgsdGhpcy54PXQueCx0aGlzLnk9dC55LHRoaXMuY2xpcD10LmNsaXAsdGhpcy5vd25jbGlwPSExLHRoaXMuc2VsZWN0ZWQ9e30sdC5zZWxlY3RlZCl0aGlzLnNlbGVjdGVkW2ldPXQuc2VsZWN0ZWRbaV07ZWxzZSBmb3IodmFyIGkgaW4gdGhpcy5fc3ZnZ3JvdXA9bnVsbCx0aGlzLl9zdmdjbGlwQ2hhbmdlZD0hMSx0aGlzLl9zdmd0ZXh0YmtmaWx0ZXI9bnVsbCx0aGlzLm1hcG1vZGU9Yy5HREkuTWFwTW9kZS5NTV9BTklTT1RST1BJQyx0aGlzLnN0cmV0Y2htb2RlPWMuR0RJLlN0cmV0Y2hNb2RlLkNPTE9ST05DT0xPUix0aGlzLnRleHRhbGlnbj0wLHRoaXMuYmttb2RlPWMuR0RJLk1peE1vZGUuT1BBUVVFLHRoaXMudGV4dGNvbG9yPW5ldyBSKG51bGwsMCwwLDApLHRoaXMuYmtjb2xvcj1uZXcgUihudWxsLDI1NSwyNTUsMjU1KSx0aGlzLnBvbHlmaWxsbW9kZT1jLkdESS5Qb2x5RmlsbE1vZGUuQUxURVJOQVRFLHRoaXMud3g9MCx0aGlzLnd5PTAsdGhpcy53dz0wLHRoaXMud2g9MCx0aGlzLnZ4PTAsdGhpcy52eT0wLHRoaXMudnc9MCx0aGlzLnZoPTAsdGhpcy54PTAsdGhpcy55PTAsdGhpcy5jbGlwPW51bGwsdGhpcy5vd25jbGlwPSExLHRoaXMuc2VsZWN0ZWQ9e30sZSl7dmFyIHM9ZVtpXTt0aGlzLnNlbGVjdGVkW2ldPW51bGwhPXM/cy5jbG9uZSgpOm51bGx9fSxOPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLl9zdmc9dCx0aGlzLl9zdmdkZWZzPW51bGwsdGhpcy5fc3ZnUGF0dGVybnM9e30sdGhpcy5fc3ZnQ2xpcFBhdGhzPXt9LHRoaXMuZGVmT2JqZWN0cz17YnJ1c2g6bmV3IEQobnVsbCxudWxsKSxwZW46bmV3IE0obnVsbCxjLkdESS5QZW5TdHlsZS5QU19TT0xJRCxuZXcgdShudWxsLDEsMSksbmV3IFIobnVsbCwwLDAsMCksMCwwKSxmb250Om5ldyBPKG51bGwsbnVsbCkscGFsZXR0ZTpudWxsLHJlZ2lvbjpudWxsfSx0aGlzLnN0YXRlPW5ldyBDKG51bGwsdGhpcy5kZWZPYmplY3RzKSx0aGlzLnN0YXRlc3RhY2s9W3RoaXMuc3RhdGVdLHRoaXMub2JqZWN0cz17fX1yZXR1cm4gdC5wcm90b3R5cGUuc2V0TWFwTW9kZT1mdW5jdGlvbih0KXtjLmxvZygiW2dkaV0gc2V0TWFwTW9kZTogbW9kZT0iK3QpLHRoaXMuc3RhdGUubWFwbW9kZT10LHRoaXMuc3RhdGUuX3N2Z2dyb3VwPW51bGx9LHQucHJvdG90eXBlLnNldFdpbmRvd09yZz1mdW5jdGlvbih0LGUpe2MubG9nKCJbZ2RpXSBzZXRXaW5kb3dPcmc6IHg9Iit0KyIgeT0iK2UpLHRoaXMuc3RhdGUud3g9dCx0aGlzLnN0YXRlLnd5PWUsdGhpcy5zdGF0ZS5fc3ZnZ3JvdXA9bnVsbH0sdC5wcm90b3R5cGUuc2V0V2luZG93RXh0PWZ1bmN0aW9uKHQsZSl7Yy5sb2coIltnZGldIHNldFdpbmRvd0V4dDogeD0iK3QrIiB5PSIrZSksdGhpcy5zdGF0ZS53dz10LHRoaXMuc3RhdGUud2g9ZSx0aGlzLnN0YXRlLl9zdmdncm91cD1udWxsfSx0LnByb3RvdHlwZS5vZmZzZXRXaW5kb3dPcmc9ZnVuY3Rpb24odCxlKXtjLmxvZygiW2dkaV0gb2Zmc2V0V2luZG93T3JnOiBvZmZYPSIrdCsiIG9mZlk9IitlKSx0aGlzLnN0YXRlLnd4Kz10LHRoaXMuc3RhdGUud3krPWUsdGhpcy5zdGF0ZS5fc3ZnZ3JvdXA9bnVsbH0sdC5wcm90b3R5cGUuc2V0Vmlld3BvcnRPcmc9ZnVuY3Rpb24odCxlKXtjLmxvZygiW2dkaV0gc2V0Vmlld3BvcnRPcmc6IHg9Iit0KyIgeT0iK2UpLHRoaXMuc3RhdGUudng9dCx0aGlzLnN0YXRlLnZ5PWUsdGhpcy5zdGF0ZS5fc3ZnZ3JvdXA9bnVsbH0sdC5wcm90b3R5cGUuc2V0Vmlld3BvcnRFeHQ9ZnVuY3Rpb24odCxlKXtjLmxvZygiW2dkaV0gc2V0Vmlld3BvcnRFeHQ6IHg9Iit0KyIgeT0iK2UpLHRoaXMuc3RhdGUudnc9dCx0aGlzLnN0YXRlLnZoPWUsdGhpcy5zdGF0ZS5fc3ZnZ3JvdXA9bnVsbH0sdC5wcm90b3R5cGUub2Zmc2V0Vmlld3BvcnRPcmc9ZnVuY3Rpb24odCxlKXtjLmxvZygiW2dkaV0gb2Zmc2V0Vmlld3BvcnRPcmc6IG9mZlg9Iit0KyIgb2ZmWT0iK2UpLHRoaXMuc3RhdGUudngrPXQsdGhpcy5zdGF0ZS52eSs9ZSx0aGlzLnN0YXRlLl9zdmdncm91cD1udWxsfSx0LnByb3RvdHlwZS5zYXZlREM9ZnVuY3Rpb24oKXtjLmxvZygiW2dkaV0gc2F2ZURDIik7dmFyIHQ9dGhpcy5zdGF0ZTt0aGlzLnN0YXRlPW5ldyBDKHRoaXMuc3RhdGUpLHRoaXMuc3RhdGVzdGFjay5wdXNoKHQpLHRoaXMuc3RhdGUuX3N2Z2dyb3VwPW51bGx9LHQucHJvdG90eXBlLnJlc3RvcmVEQz1mdW5jdGlvbih0KXtpZihjLmxvZygiW2dkaV0gcmVzdG9yZURDOiBzYXZlZD0iK3QpLCEodGhpcy5zdGF0ZXN0YWNrLmxlbmd0aD4xKSl0aHJvdyBuZXcgYSgiTm8gc2F2ZWQgY29udGV4dHMiKTtpZigtMT09PXQpdGhpcy5zdGF0ZT10aGlzLnN0YXRlc3RhY2sucG9wKCk7ZWxzZXtpZih0PC0xKXRocm93IG5ldyBhKCJyZXN0b3JlREM6IHJlbGF0aXZlIHJlc3RvcmUgbm90IGltcGxlbWVudGVkIik7aWYodD4xKXRocm93IG5ldyBhKCJyZXN0b3JlREM6IGFic29sdXRlIHJlc3RvcmUgbm90IGltcGxlbWVudGVkIil9dGhpcy5zdGF0ZS5fc3ZnZ3JvdXA9bnVsbH0sdC5wcm90b3R5cGUuZXNjYXBlPWZ1bmN0aW9uKHQsZSxpLHMpe2MubG9nKCJbZ2RpXSBlc2NhcGU6IGZ1bmM9Iit0KyIgb2Zmc2V0PSIraSsiIGNvdW50PSIrcyl9LHQucHJvdG90eXBlLnNldFN0cmV0Y2hCbHRNb2RlPWZ1bmN0aW9uKHQpe2MubG9nKCJbZ2RpXSBzZXRTdHJldGNoQmx0TW9kZTogc3RyZXRjaE1vZGU9Iit0KX0sdC5wcm90b3R5cGUuc3RyZXRjaERpYj1mdW5jdGlvbih0LGUsaSxzLG4sbyxyLGEsaCxsLHApe2MubG9nKCJbZ2RpXSBzdHJldGNoRGliOiBzcmNYPSIrdCsiIHNyY1k9IitlKyIgc3JjVz0iK2krIiBzcmNIPSIrcysiIGRzdFg9IituKyIgZHN0WT0iK28rIiBkc3RXPSIrcisiIGRzdEg9IithKyIgcmFzdGVyT3A9MHgiK2gudG9TdHJpbmcoMTYpKSx0PXRoaXMuX3RvZGV2WCh0KSxlPXRoaXMuX3RvZGV2WShlKSxpPXRoaXMuX3RvZGV2VyhpKSxzPXRoaXMuX3RvZGV2SChzKSxuPXRoaXMuX3RvZGV2WChuKSxvPXRoaXMuX3RvZGV2WShvKSxyPXRoaXMuX3RvZGV2VyhyKSxhPXRoaXMuX3RvZGV2SChhKSxjLmxvZygiW2dkaV0gc3RyZXRjaERpYjogVFJBTlNMQVRFRDogc3JjWD0iK3QrIiBzcmNZPSIrZSsiIHNyY1c9IitpKyIgc3JjSD0iK3MrIiBkc3RYPSIrbisiIGRzdFk9IitvKyIgZHN0Vz0iK3IrIiBkc3RIPSIrYSsiIHJhc3Rlck9wPTB4IitoLnRvU3RyaW5nKDE2KSsiIGNvbG9yVXNhZ2U9MHgiK2wudG9TdHJpbmcoMTYpKSx0aGlzLl9wdXNoR3JvdXAoKSx0aGlzLl9zdmcuaW1hZ2UodGhpcy5zdGF0ZS5fc3ZnZ3JvdXAsbixvLHIsYSxwLmJhc2U2NHJlZigpKX0sdC5wcm90b3R5cGUuZGliQml0cz1mdW5jdGlvbih0LGUsaSxzLG4sbyxyLGEpe2MubG9nKCJbZ2RpXSBzdHJldGNoRGliQml0czogc3JjWD0iK3QrIiBzcmNZPSIrZSsiIGRzdFg9IitpKyIgZHN0WT0iK3MrIiB3aWR0aD0iK24rIiBoZWlnaHQ9IitvKyIgcmFzdGVyT3A9MHgiK3IudG9TdHJpbmcoMTYpKSx0PXRoaXMuX3RvZGV2WCh0KSxlPXRoaXMuX3RvZGV2WShlKSxpPXRoaXMuX3RvZGV2WChpKSxzPXRoaXMuX3RvZGV2WShzKSxuPXRoaXMuX3RvZGV2VyhuKSxvPXRoaXMuX3RvZGV2SChvKSxjLmxvZygiW2dkaV0gZGliQml0czogVFJBTlNMQVRFRDogc3JjWD0iK3QrIiBzcmNZPSIrZStOYU4raSsiIGRzdFk9IitzKyIgd2lkdGg9IituKyIgaGVpZ2h0PSIrbysiIHJhc3Rlck9wPTB4IityLnRvU3RyaW5nKDE2KSksdGhpcy5fcHVzaEdyb3VwKCksdGhpcy5fc3ZnLmltYWdlKHRoaXMuc3RhdGUuX3N2Z2dyb3VwLGkscyxuLG8sYS5iYXNlNjRyZWYoKSl9LHQucHJvdG90eXBlLnN0cmV0Y2hEaWJCaXRzPWZ1bmN0aW9uKHQsZSxpLHMsbixvLHIsYSxoLGwpe2MubG9nKCJbZ2RpXSBzdHJldGNoRGliQml0czogc3JjWD0iK3QrIiBzcmNZPSIrZSsiIHNyY1c9IitpKyIgc3JjSD0iK3MrIiBkc3RYPSIrbisiIGRzdFk9IitvKyIgZHN0Vz0iK3IrIiBkc3RIPSIrYSsiIHJhc3Rlck9wPTB4IitoLnRvU3RyaW5nKDE2KSksdD10aGlzLl90b2RldlgodCksZT10aGlzLl90b2RldlkoZSksaT10aGlzLl90b2RldlcoaSkscz10aGlzLl90b2Rldkgocyksbj10aGlzLl90b2Rldlgobiksbz10aGlzLl90b2Rldlkobykscj10aGlzLl90b2RldlcociksYT10aGlzLl90b2RldkgoYSksYy5sb2coIltnZGldIHN0cmV0Y2hEaWJCaXRzOiBUUkFOU0xBVEVEOiBzcmNYPSIrdCsiIHNyY1k9IitlKyIgc3JjVz0iK2krIiBzcmNIPSIrcysiIGRzdFg9IituKyIgZHN0WT0iK28rIiBkc3RXPSIrcisiIGRzdEg9IithKyIgcmFzdGVyT3A9MHgiK2gudG9TdHJpbmcoMTYpKSx0aGlzLl9wdXNoR3JvdXAoKSx0aGlzLl9zdmcuaW1hZ2UodGhpcy5zdGF0ZS5fc3ZnZ3JvdXAsbixvLHIsYSxsLmJhc2U2NHJlZigpKX0sdC5wcm90b3R5cGUucmVjdGFuZ2xlPWZ1bmN0aW9uKHQsZSxpKXtjLmxvZygiW2dkaV0gcmVjdGFuZ2xlOiByZWN0PSIrdC50b1N0cmluZygpKyIgd2l0aCBwZW4gIit0aGlzLnN0YXRlLnNlbGVjdGVkLnBlbi50b1N0cmluZygpKyIgYW5kIGJydXNoICIrdGhpcy5zdGF0ZS5zZWxlY3RlZC5icnVzaC50b1N0cmluZygpKTt2YXIgcz10aGlzLl90b2RldlkodC5ib3R0b20pLG49dGhpcy5fdG9kZXZYKHQucmlnaHQpLG89dGhpcy5fdG9kZXZZKHQudG9wKSxyPXRoaXMuX3RvZGV2WCh0LmxlZnQpO2U9dGhpcy5fdG9kZXZIKGUpLGk9dGhpcy5fdG9kZXZIKGkpLGMubG9nKCJbZ2RpXSByZWN0YW5nbGU6IFRSQU5TTEFURUQ6IGJvdHRvbT0iK3MrIiByaWdodD0iK24rIiB0b3A9IitvKyIgbGVmdD0iK3IrIiByaD0iK2krIiBydz0iK2UpLHRoaXMuX3B1c2hHcm91cCgpO3ZhciBhPXRoaXMuX2FwcGx5T3B0cyhudWxsLCEwLCEwLCExKTt0aGlzLl9zdmcucmVjdCh0aGlzLnN0YXRlLl9zdmdncm91cCxyLG8sbi1yLHMtbyxlLzIsaS8yLGEpfSx0LnByb3RvdHlwZS50ZXh0T3V0PWZ1bmN0aW9uKHQsZSxpKXtjLmxvZygiW2dkaV0gdGV4dE91dDogeD0iK3QrIiB5PSIrZSsiIHRleHQ9IitpKyIgd2l0aCBmb250ICIrdGhpcy5zdGF0ZS5zZWxlY3RlZC5mb250LnRvU3RyaW5nKCkpLHQ9dGhpcy5fdG9kZXZYKHQpLGU9dGhpcy5fdG9kZXZZKGUpLGMubG9nKCJbZ2RpXSB0ZXh0T3V0OiBUUkFOU0xBVEVEOiB4PSIrdCsiIHk9IitlKSx0aGlzLl9wdXNoR3JvdXAoKTt2YXIgcz10aGlzLl9hcHBseU9wdHMobnVsbCwhMSwhMSwhMCk7aWYoMCE9PXRoaXMuc3RhdGUuc2VsZWN0ZWQuZm9udC5lc2NhcGVtZW50JiYocy50cmFuc2Zvcm09InJvdGF0ZSgiK1stdGhpcy5zdGF0ZS5zZWxlY3RlZC5mb250LmVzY2FwZW1lbnQvMTAsdCxlXSsiKSIscy5zdHlsZT0iZG9taW5hbnQtYmFzZWxpbmU6IG1pZGRsZTsgdGV4dC1hbmNob3I6IHN0YXJ0OyIpLHRoaXMuc3RhdGUuYmttb2RlPT09Yy5HREkuTWl4TW9kZS5PUEFRVUUpe2lmKG51bGw9PXRoaXMuc3RhdGUuX3N2Z3RleHRia2ZpbHRlcil7dmFyIG49Yy5fbWFrZVVuaXF1ZUlkKCJmIiksbz10aGlzLl9zdmcuZmlsdGVyKHRoaXMuX2dldFN2Z0RlZigpLG4sMCwwLDEsMSk7dGhpcy5fc3ZnLmZpbHRlcnMuZmxvb2QobyxudWxsLCIjIit0aGlzLnN0YXRlLmJrY29sb3IudG9IZXgoKSwxKSx0aGlzLl9zdmcuZmlsdGVycy5jb21wb3NpdGUobyxudWxsLG51bGwsIlNvdXJjZUdyYXBoaWMiKSx0aGlzLnN0YXRlLl9zdmd0ZXh0YmtmaWx0ZXI9b31zLmZpbHRlcj0idXJsKCMiK3RoaXMuc3RhdGUuX3N2Z3RleHRia2ZpbHRlci5pZCsiKSJ9dGhpcy5fc3ZnLnRleHQodGhpcy5zdGF0ZS5fc3ZnZ3JvdXAsdCxlLGkscyl9LHQucHJvdG90eXBlLmV4dFRleHRPdXQ9ZnVuY3Rpb24odCxlLGkscyxuLG8pe2MubG9nKCJbZ2RpXSBleHRUZXh0T3V0OiB4PSIrdCsiIHk9IitlKyIgdGV4dD0iK2krIiB3aXRoIGZvbnQgIit0aGlzLnN0YXRlLnNlbGVjdGVkLmZvbnQudG9TdHJpbmcoKSksdD10aGlzLl90b2RldlgodCksZT10aGlzLl90b2RldlkoZSksYy5sb2coIltnZGldIGV4dFRleHRPdXQ6IFRSQU5TTEFURUQ6IHg9Iit0KyIgeT0iK2UpLHRoaXMuX3B1c2hHcm91cCgpO3ZhciByPXRoaXMuX2FwcGx5T3B0cyhudWxsLCExLCExLCEwKTtpZigwIT09dGhpcy5zdGF0ZS5zZWxlY3RlZC5mb250LmVzY2FwZW1lbnQmJihyLnRyYW5zZm9ybT0icm90YXRlKCIrWy10aGlzLnN0YXRlLnNlbGVjdGVkLmZvbnQuZXNjYXBlbWVudC8xMCx0LGVdKyIpIixyLnN0eWxlPSJkb21pbmFudC1iYXNlbGluZTogbWlkZGxlOyB0ZXh0LWFuY2hvcjogc3RhcnQ7IiksdGhpcy5zdGF0ZS5ia21vZGU9PT1jLkdESS5NaXhNb2RlLk9QQVFVRSl7aWYobnVsbD09dGhpcy5zdGF0ZS5fc3ZndGV4dGJrZmlsdGVyKXt2YXIgYT1jLl9tYWtlVW5pcXVlSWQoImYiKSxoPXRoaXMuX3N2Zy5maWx0ZXIodGhpcy5fZ2V0U3ZnRGVmKCksYSwwLDAsMSwxKTt0aGlzLl9zdmcuZmlsdGVycy5mbG9vZChoLG51bGwsIiMiK3RoaXMuc3RhdGUuYmtjb2xvci50b0hleCgpLDEpLHRoaXMuX3N2Zy5maWx0ZXJzLmNvbXBvc2l0ZShoLG51bGwsbnVsbCwiU291cmNlR3JhcGhpYyIpLHRoaXMuc3RhdGUuX3N2Z3RleHRia2ZpbHRlcj1ofXIuZmlsdGVyPSJ1cmwoIyIrdGhpcy5zdGF0ZS5fc3ZndGV4dGJrZmlsdGVyLmlkKyIpIn10aGlzLl9zdmcudGV4dCh0aGlzLnN0YXRlLl9zdmdncm91cCx0LGUsaSxyKX0sdC5wcm90b3R5cGUubGluZVRvPWZ1bmN0aW9uKHQsZSl7Yy5sb2coIltnZGldIGxpbmVUbzogeD0iK3QrIiB5PSIrZSsiIHdpdGggcGVuICIrdGhpcy5zdGF0ZS5zZWxlY3RlZC5wZW4udG9TdHJpbmcoKSk7dmFyIGk9dGhpcy5fdG9kZXZYKHQpLHM9dGhpcy5fdG9kZXZZKGUpLG49dGhpcy5fdG9kZXZYKHRoaXMuc3RhdGUueCksbz10aGlzLl90b2RldlkodGhpcy5zdGF0ZS55KTt0aGlzLnN0YXRlLng9dCx0aGlzLnN0YXRlLnk9ZSxjLmxvZygiW2dkaV0gbGluZVRvOiBUUkFOU0xBVEVEOiB0b1g9IitpKyIgdG9ZPSIrcysiIGZyb21YPSIrbisiIGZyb21ZPSIrbyksdGhpcy5fcHVzaEdyb3VwKCk7dmFyIHI9dGhpcy5fYXBwbHlPcHRzKG51bGwsITAsITEsITEpO3RoaXMuX3N2Zy5saW5lKHRoaXMuc3RhdGUuX3N2Z2dyb3VwLG4sbyxpLHMscil9LHQucHJvdG90eXBlLm1vdmVUbz1mdW5jdGlvbih0LGUpe2MubG9nKCJbZ2RpXSBtb3ZlVG86IHg9Iit0KyIgeT0iK2UpLHRoaXMuc3RhdGUueD10LHRoaXMuc3RhdGUueT1lfSx0LnByb3RvdHlwZS5wb2x5Z29uPWZ1bmN0aW9uKHQsZSl7Yy5sb2coIltnZGldIHBvbHlnb246IHBvaW50cz0iK3QrIiB3aXRoIHBlbiAiK3RoaXMuc3RhdGUuc2VsZWN0ZWQucGVuLnRvU3RyaW5nKCkrIiBhbmQgYnJ1c2ggIit0aGlzLnN0YXRlLnNlbGVjdGVkLmJydXNoLnRvU3RyaW5nKCkpO2Zvcih2YXIgaT1bXSxzPTA7czx0Lmxlbmd0aDtzKyspe3ZhciBuPXRbc107aS5wdXNoKFt0aGlzLl90b2Rldlgobi54KSx0aGlzLl90b2Rldlkobi55KV0pfWMubG9nKCJbZ2RpXSBwb2x5Z29uOiBUUkFOU0xBVEVEOiBwdHM9IitpKSxlJiZ0aGlzLl9wdXNoR3JvdXAoKTt2YXIgbz17ImZpbGwtcnVsZSI6dGhpcy5zdGF0ZS5wb2x5ZmlsbG1vZGU9PT1jLkdESS5Qb2x5RmlsbE1vZGUuQUxURVJOQVRFPyJldmVub2RkIjoibm9uemVybyJ9O3RoaXMuX2FwcGx5T3B0cyhvLCEwLCEwLCExKSx0aGlzLl9zdmcucG9seWdvbih0aGlzLnN0YXRlLl9zdmdncm91cCxpLG8pfSx0LnByb3RvdHlwZS5wb2x5UG9seWdvbj1mdW5jdGlvbih0KXtjLmxvZygiW2dkaV0gcG9seVBvbHlnb246IHBvbHlnb25zLmxlbmd0aD0iK3QubGVuZ3RoKyIgd2l0aCBwZW4gIit0aGlzLnN0YXRlLnNlbGVjdGVkLnBlbi50b1N0cmluZygpKyIgYW5kIGJydXNoICIrdGhpcy5zdGF0ZS5zZWxlY3RlZC5icnVzaC50b1N0cmluZygpKTtmb3IodmFyIGU9dC5sZW5ndGgsaT0wO2k8ZTtpKyspdGhpcy5wb2x5Z29uKHRbaV0sMD09PWkpfSx0LnByb3RvdHlwZS5wb2x5bGluZT1mdW5jdGlvbih0KXtjLmxvZygiW2dkaV0gcG9seWxpbmU6IHBvaW50cz0iK3QrIiB3aXRoIHBlbiAiK3RoaXMuc3RhdGUuc2VsZWN0ZWQucGVuLnRvU3RyaW5nKCkpO2Zvcih2YXIgZT1bXSxpPTA7aTx0Lmxlbmd0aDtpKyspe3ZhciBzPXRbaV07ZS5wdXNoKFt0aGlzLl90b2Rldlgocy54KSx0aGlzLl90b2Rldlkocy55KV0pfWMubG9nKCJbZ2RpXSBwb2x5bGluZTogVFJBTlNMQVRFRDogcHRzPSIrZSksdGhpcy5fcHVzaEdyb3VwKCk7dmFyIG49dGhpcy5fYXBwbHlPcHRzKHtmaWxsOiJub25lIn0sITAsITEsITEpO3RoaXMuX3N2Zy5wb2x5bGluZSh0aGlzLnN0YXRlLl9zdmdncm91cCxlLG4pfSx0LnByb3RvdHlwZS5lbGxpcHNlPWZ1bmN0aW9uKHQpe2MubG9nKCJbZ2RpXSBlbGxpcHNlOiByZWN0PSIrdC50b1N0cmluZygpKyIgd2l0aCBwZW4gIit0aGlzLnN0YXRlLnNlbGVjdGVkLnBlbi50b1N0cmluZygpKyIgYW5kIGJydXNoICIrdGhpcy5zdGF0ZS5zZWxlY3RlZC5icnVzaC50b1N0cmluZygpKTt2YXIgZT10aGlzLl90b2RldlkodC5ib3R0b20pLGk9dGhpcy5fdG9kZXZYKHQucmlnaHQpLHM9dGhpcy5fdG9kZXZZKHQudG9wKSxuPXRoaXMuX3RvZGV2WCh0LmxlZnQpO2MubG9nKCJbZ2RpXSBlbGxpcHNlOiBUUkFOU0xBVEVEOiBib3R0b209IitlKyIgcmlnaHQ9IitpKyIgdG9wPSIrcysiIGxlZnQ9IituKSx0aGlzLl9wdXNoR3JvdXAoKTt2YXIgbz0oaS1uKS8yLHI9KGUtcykvMixhPXRoaXMuX2FwcGx5T3B0cyhudWxsLCEwLCEwLCExKTt0aGlzLl9zdmcuZWxsaXBzZSh0aGlzLnN0YXRlLl9zdmdncm91cCxuK28scytyLG8scixhKX0sdC5wcm90b3R5cGUuZXhjbHVkZUNsaXBSZWN0PWZ1bmN0aW9uKHQpe2MubG9nKCJbZ2RpXSBleGNsdWRlQ2xpcFJlY3Q6IHJlY3Q9Iit0LnRvU3RyaW5nKCkpLHRoaXMuX2dldENsaXBSZ24oKS5zdWJ0cmFjdCh0KX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0Q2xpcFJlY3Q9ZnVuY3Rpb24odCl7Yy5sb2coIltnZGldIGludGVyc2VjdENsaXBSZWN0OiByZWN0PSIrdC50b1N0cmluZygpKSx0aGlzLl9nZXRDbGlwUmduKCkuaW50ZXJzZWN0KHQpfSx0LnByb3RvdHlwZS5vZmZzZXRDbGlwUmduPWZ1bmN0aW9uKHQsZSl7Yy5sb2coIltnZGldIG9mZnNldENsaXBSZ246IG9mZlg9Iit0KyIgb2ZmWT0iK2UpLHRoaXMuX2dldENsaXBSZ24oKS5vZmZzZXQodCxlKX0sdC5wcm90b3R5cGUuc2V0VGV4dEFsaWduPWZ1bmN0aW9uKHQpe2MubG9nKCJbZ2RpXSBzZXRUZXh0QWxpZ246IHRleHRBbGlnbm1lbnRNb2RlPTB4Iit0LnRvU3RyaW5nKDE2KSksdGhpcy5zdGF0ZS50ZXh0YWxpZ249dH0sdC5wcm90b3R5cGUuc2V0QmtNb2RlPWZ1bmN0aW9uKHQpe2MubG9nKCJbZ2RpXSBzZXRCa01vZGU6IGJrTW9kZT0weCIrdC50b1N0cmluZygxNikpLHRoaXMuc3RhdGUuYmttb2RlPXR9LHQucHJvdG90eXBlLnNldFRleHRDb2xvcj1mdW5jdGlvbih0KXtjLmxvZygiW2dkaV0gc2V0VGV4dENvbG9yOiB0ZXh0Q29sb3I9Iit0LnRvU3RyaW5nKCkpLHRoaXMuc3RhdGUudGV4dGNvbG9yPXR9LHQucHJvdG90eXBlLnNldEJrQ29sb3I9ZnVuY3Rpb24odCl7Yy5sb2coIltnZGldIHNldEJrQ29sb3I6IGJrQ29sb3I9Iit0LnRvU3RyaW5nKCkpLHRoaXMuc3RhdGUuYmtjb2xvcj10LHRoaXMuc3RhdGUuX3N2Z3RleHRia2ZpbHRlcj1udWxsfSx0LnByb3RvdHlwZS5zZXRQb2x5RmlsbE1vZGU9ZnVuY3Rpb24odCl7Yy5sb2coIltnZGldIHNldFBvbHlGaWxsTW9kZTogcG9seUZpbGxNb2RlPSIrdCksdGhpcy5zdGF0ZS5wb2x5ZmlsbG1vZGU9dH0sdC5wcm90b3R5cGUuY3JlYXRlQnJ1c2g9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3RvcmVPYmplY3QodCk7Yy5sb2coIltnZGldIGNyZWF0ZUJydXNoOiBicnVzaD0iK3QudG9TdHJpbmcoKSsiIHdpdGggaGFuZGxlICIrZSl9LHQucHJvdG90eXBlLmNyZWF0ZUZvbnQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3RvcmVPYmplY3QodCk7Yy5sb2coIltnZGldIGNyZWF0ZUZvbnQ6IGZvbnQ9Iit0LnRvU3RyaW5nKCkrIiB3aXRoIGhhbmRsZSAiK2UpfSx0LnByb3RvdHlwZS5jcmVhdGVQZW49ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3RvcmVPYmplY3QodCk7Yy5sb2coIltnZGldIGNyZWF0ZVBlbjogcGVuPSIrdC50b1N0cmluZygpKyIgd2lkdGggaGFuZGxlICIrZSl9LHQucHJvdG90eXBlLmNyZWF0ZVBhbGV0dGU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3RvcmVPYmplY3QodCk7Yy5sb2coIltnZGldIGNyZWF0ZVBhbGV0dGU6IHBhbGV0dGU9Iit0LnRvU3RyaW5nKCkrIiB3aWR0aCBoYW5kbGUgIitlKX0sdC5wcm90b3R5cGUuY3JlYXRlUmVnaW9uPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3N0b3JlT2JqZWN0KHQpO2MubG9nKCJbZ2RpXSBjcmVhdGVSZWdpb246IHJlZ2lvbj0iK3QudG9TdHJpbmcoKSsiIHdpZHRoIGhhbmRsZSAiK2UpfSx0LnByb3RvdHlwZS5jcmVhdGVQYXR0ZXJuQnJ1c2g9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3RvcmVPYmplY3QodCk7Yy5sb2coIltnZGldIGNyZWF0ZVJlZ2lvbjogcmVnaW9uPSIrdC50b1N0cmluZygpKyIgd2lkdGggaGFuZGxlICIrZSl9LHQucHJvdG90eXBlLnNlbGVjdE9iamVjdD1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2dldE9iamVjdCh0KTtudWxsPT1pfHxudWxsIT1lJiZpLnR5cGUhPT1lP2MubG9nKCJbZ2RpXSBzZWxlY3RPYmplY3Q6IG9iaklkeD0iK3QrKGk/IiBpbnZhbGlkIG9iamVjdCB0eXBlOiAiK2kudHlwZToiW2ludmFsaWQgaW5kZXhdIikpOih0aGlzLl9zZWxlY3RPYmplY3QoaSksYy5sb2coIltnZGldIHNlbGVjdE9iamVjdDogb2JqSWR4PSIrdCsoaT8iIHNlbGVjdGVkICIraS50eXBlKyI6ICIraS50b1N0cmluZygpOiJbaW52YWxpZCBpbmRleF0iKSkpfSx0LnByb3RvdHlwZS5kZWxldGVPYmplY3Q9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZGVsZXRlT2JqZWN0KHQpO2MubG9nKCJbZ2RpXSBkZWxldGVPYmplY3Q6IG9iaklkeD0iK3QrKGU/IiBkZWxldGVkIG9iamVjdCI6IltpbnZhbGlkIGluZGV4XSIpKX0sdC5wcm90b3R5cGUuX3B1c2hHcm91cD1mdW5jdGlvbigpe2lmKG51bGw9PXRoaXMuc3RhdGUuX3N2Z2dyb3VwfHx0aGlzLnN0YXRlLl9zdmdjbGlwQ2hhbmdlZCl7dGhpcy5zdGF0ZS5fc3ZnY2xpcENoYW5nZWQ9ITEsdGhpcy5zdGF0ZS5fc3ZndGV4dGJrZmlsdGVyPW51bGw7dmFyIHQ9e3ZpZXdCb3g6W3RoaXMuc3RhdGUudngsdGhpcy5zdGF0ZS52eSx0aGlzLnN0YXRlLnZ3LHRoaXMuc3RhdGUudmhdLmpvaW4oIiAiKSxwcmVzZXJ2ZUFzcGVjdFJhdGlvOiJub25lIn07bnVsbCE9dGhpcy5zdGF0ZS5jbGlwPyhjLmxvZygiW2dkaV0gbmV3IHN2ZyB4PSIrdGhpcy5zdGF0ZS52eCsiIHk9Iit0aGlzLnN0YXRlLnZ5KyIgd2lkdGg9Iit0aGlzLnN0YXRlLnZ3KyIgaGVpZ2h0PSIrdGhpcy5zdGF0ZS52aCsiIHdpdGggY2xpcHBpbmciKSx0WyJjbGlwLXBhdGgiXT0idXJsKCMiK3RoaXMuX2dldFN2Z0NsaXBQYXRoRm9yUmVnaW9uKHRoaXMuc3RhdGUuY2xpcCkrIikiKTpjLmxvZygiW2dkaV0gbmV3IHN2ZyB4PSIrdGhpcy5zdGF0ZS52eCsiIHk9Iit0aGlzLnN0YXRlLnZ5KyIgd2lkdGg9Iit0aGlzLnN0YXRlLnZ3KyIgaGVpZ2h0PSIrdGhpcy5zdGF0ZS52aCsiIHdpdGhvdXQgY2xpcHBpbmciKSx0aGlzLnN0YXRlLl9zdmdncm91cD10aGlzLl9zdmcuc3ZnKHRoaXMuc3RhdGUuX3N2Z2dyb3VwLHRoaXMuc3RhdGUudngsdGhpcy5zdGF0ZS52eSx0aGlzLnN0YXRlLnZ3LHRoaXMuc3RhdGUudmgsdCl9fSx0LnByb3RvdHlwZS5fc3RvcmVPYmplY3Q9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7bnVsbCE9dGhpcy5vYmplY3RzW2UudG9TdHJpbmcoKV0mJmU8PTY1NTM1OyllKys7cmV0dXJuIGU+NjU1MzU/KGMubG9nKCJbZ2RpXSBUb28gbWFueSBvYmplY3RzISIpLC0xKToodGhpcy5vYmplY3RzW2UudG9TdHJpbmcoKV09dCxlKX0sdC5wcm90b3R5cGUuX2dldE9iamVjdD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLm9iamVjdHNbdC50b1N0cmluZygpXTtyZXR1cm4gbnVsbD09ZSYmYy5sb2coIltnZGldIE5vIG9iamVjdCB3aXRoIGhhbmRsZSAiK3QpLGV9LHQucHJvdG90eXBlLl9nZXRTdmdEZWY9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5fc3ZnZGVmcyYmKHRoaXMuX3N2Z2RlZnM9dGhpcy5fc3ZnLmRlZnMoKSksdGhpcy5fc3ZnZGVmc30sdC5wcm90b3R5cGUuX2dldFN2Z0NsaXBQYXRoRm9yUmVnaW9uPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0aGlzLl9zdmdDbGlwUGF0aHMpaWYodGhpcy5fc3ZnQ2xpcFBhdGhzW2VdPT09dClyZXR1cm4gZTt2YXIgaT1jLl9tYWtlVW5pcXVlSWQoImMiKSxzPXRoaXMuX3N2Zy5jbGlwUGF0aCh0aGlzLl9nZXRTdmdEZWYoKSxpLCJ1c2VyU3BhY2VPblVzZSIpO3N3aXRjaCh0LmNvbXBsZXhpdHkpe2Nhc2UgMTp0aGlzLl9zdmcucmVjdChzLHRoaXMuX3RvZGV2WCh0LmJvdW5kcy5sZWZ0KSx0aGlzLl90b2RldlkodC5ib3VuZHMudG9wKSx0aGlzLl90b2RldlcodC5ib3VuZHMucmlnaHQtdC5ib3VuZHMubGVmdCksdGhpcy5fdG9kZXZIKHQuYm91bmRzLmJvdHRvbS10LmJvdW5kcy50b3ApLHtmaWxsOiJibGFjayIsInN0cm9rZS13aWR0aCI6MH0pO2JyZWFrO2Nhc2UgMjpmb3IodmFyIG49MDtuPHQuc2NhbnMubGVuZ3RoO24rKylmb3IodmFyIG89dC5zY2Fuc1tuXSxyPTA7cjxvLnNjYW5saW5lcy5sZW5ndGg7cisrKXt2YXIgYT1vLnNjYW5saW5lc1tyXTt0aGlzLl9zdmcucmVjdChzLHRoaXMuX3RvZGV2WChhLmxlZnQpLHRoaXMuX3RvZGV2WShvLnRvcCksdGhpcy5fdG9kZXZXKGEucmlnaHQtYS5sZWZ0KSx0aGlzLl90b2Rldkgoby5ib3R0b20tby50b3ApLHtmaWxsOiJibGFjayIsInN0cm9rZS13aWR0aCI6MH0pfX1yZXR1cm4gdGhpcy5fc3ZnQ2xpcFBhdGhzW2ldPXQsaX0sdC5wcm90b3R5cGUuX2dldFN2Z1BhdHRlcm5Gb3JCcnVzaD1mdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdGhpcy5fc3ZnUGF0dGVybnMpaWYodGhpcy5fc3ZnUGF0dGVybnNbZV09PT10KXJldHVybiBlO3ZhciBpLHMsbjtzd2l0Y2godC5zdHlsZSl7Y2FzZSBjLkdESS5CcnVzaFN0eWxlLkJTX1BBVFRFUk46aT10LnBhdHRlcm4uZ2V0V2lkdGgoKSxzPXQucGF0dGVybi5nZXRIZWlnaHQoKTticmVhaztjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfRElCUEFUVEVSTlBUOmk9dC5kaWJwYXR0ZXJucHQuZ2V0V2lkdGgoKSxzPXQuZGlicGF0dGVybnB0LmdldEhlaWdodCgpLG49dC5kaWJwYXR0ZXJucHQuYmFzZTY0cmVmKCk7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgYSgiSW52YWxpZCBicnVzaCBzdHlsZSIpfXZhciBvPWMuX21ha2VVbmlxdWVJZCgicCIpLHI9dGhpcy5fc3ZnLnBhdHRlcm4odGhpcy5fZ2V0U3ZnRGVmKCksbywwLDAsaSxzLHtwYXR0ZXJuVW5pdHM6InVzZXJTcGFjZU9uVXNlIn0pO3JldHVybiB0aGlzLl9zdmcuaW1hZ2UociwwLDAsaSxzLG4pLHRoaXMuX3N2Z1BhdHRlcm5zW29dPXQsb30sdC5wcm90b3R5cGUuX3NlbGVjdE9iamVjdD1mdW5jdGlvbih0KXt0aGlzLnN0YXRlLnNlbGVjdGVkW3QudHlwZV09dCwicmVnaW9uIj09PXQudHlwZSYmKHRoaXMuc3RhdGUuX3N2Z2NsaXBDaGFuZ2VkPSEwKX0sdC5wcm90b3R5cGUuX2RlbGV0ZU9iamVjdD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLm9iamVjdHNbdC50b1N0cmluZygpXTtpZihudWxsIT1lKXtmb3IodmFyIGk9MDtpPHRoaXMuc3RhdGVzdGFjay5sZW5ndGg7aSsrKXt2YXIgcz10aGlzLnN0YXRlc3RhY2tbaV07cy5zZWxlY3RlZFtlLnR5cGVdPT09ZSYmKHMuc2VsZWN0ZWRbZS50eXBlXT10aGlzLmRlZk9iamVjdHNbZS50eXBlXS5jbG9uZSgpKX1yZXR1cm4gZGVsZXRlIHRoaXMub2JqZWN0c1t0LnRvU3RyaW5nKCldLCEwfXJldHVybiBjLmxvZygiW2dkaV0gQ2Fubm90IGRlbGV0ZSBvYmplY3Qgd2l0aCBpbnZhbGlkIGhhbmRsZSAiK3QpLCExfSx0LnByb3RvdHlwZS5fZ2V0Q2xpcFJnbj1mdW5jdGlvbigpe3ZhciB0LGUsaSxzLG47cmV0dXJuIG51bGwhPXRoaXMuc3RhdGUuY2xpcD90aGlzLnN0YXRlLm93bmNsaXB8fCh0aGlzLnN0YXRlLmNsaXA9dGhpcy5zdGF0ZS5jbGlwLmNsb25lKCkpOm51bGwhPXRoaXMuc3RhdGUuc2VsZWN0ZWQucmVnaW9uP3RoaXMuc3RhdGUuY2xpcD10aGlzLnN0YXRlLnNlbGVjdGVkLnJlZ2lvbi5jbG9uZSgpOnRoaXMuc3RhdGUuY2xpcD0odD10aGlzLnN0YXRlLnd4LGU9dGhpcy5zdGF0ZS53eSxpPXRoaXMuc3RhdGUud3grdGhpcy5zdGF0ZS53dyxzPXRoaXMuc3RhdGUud3krdGhpcy5zdGF0ZS53aCwobj1uZXcgRShudWxsLG51bGwpKS5ib3VuZHM9bmV3IGQobnVsbCx0LGUsaSxzKSxuLl91cGRhdGVDb21wbGV4aXR5KCksbiksdGhpcy5zdGF0ZS5vd25jbGlwPSEwLHRoaXMuc3RhdGUuY2xpcH0sdC5wcm90b3R5cGUuX3RvZGV2WD1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5mbG9vcigodC10aGlzLnN0YXRlLnd4KSoodGhpcy5zdGF0ZS52dy90aGlzLnN0YXRlLnd3KSkrdGhpcy5zdGF0ZS52eH0sdC5wcm90b3R5cGUuX3RvZGV2WT1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5mbG9vcigodC10aGlzLnN0YXRlLnd5KSoodGhpcy5zdGF0ZS52aC90aGlzLnN0YXRlLndoKSkrdGhpcy5zdGF0ZS52eX0sdC5wcm90b3R5cGUuX3RvZGV2Vz1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5mbG9vcih0Kih0aGlzLnN0YXRlLnZ3L3RoaXMuc3RhdGUud3cpKSt0aGlzLnN0YXRlLnZ4fSx0LnByb3RvdHlwZS5fdG9kZXZIPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmZsb29yKHQqKHRoaXMuc3RhdGUudmgvdGhpcy5zdGF0ZS53aCkpK3RoaXMuc3RhdGUudnl9LHQucHJvdG90eXBlLl90b2xvZ2ljYWxYPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmZsb29yKCh0LXRoaXMuc3RhdGUudngpLyh0aGlzLnN0YXRlLnZ3L3RoaXMuc3RhdGUud3cpKSt0aGlzLnN0YXRlLnd4fSx0LnByb3RvdHlwZS5fdG9sb2dpY2FsWT1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5mbG9vcigodC10aGlzLnN0YXRlLnZ5KS8odGhpcy5zdGF0ZS52aC90aGlzLnN0YXRlLndoKSkrdGhpcy5zdGF0ZS53eX0sdC5wcm90b3R5cGUuX3RvbG9naWNhbFc9ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguZmxvb3IodC8odGhpcy5zdGF0ZS52dy90aGlzLnN0YXRlLnd3KSkrdGhpcy5zdGF0ZS53eH0sdC5wcm90b3R5cGUuX3RvbG9naWNhbEg9ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguZmxvb3IodC8odGhpcy5zdGF0ZS52aC90aGlzLnN0YXRlLndoKSkrdGhpcy5zdGF0ZS53eX0sdC5wcm90b3R5cGUuX2FwcGx5T3B0cz1mdW5jdGlvbih0LGUsaSxzKXtpZihudWxsPT10JiYodD17fSksZSl7dmFyIG49dGhpcy5zdGF0ZS5zZWxlY3RlZC5wZW47aWYobi5zdHlsZSE9PWMuR0RJLlBlblN0eWxlLlBTX05VTEwpe3Quc3Ryb2tlPSIjIituLmNvbG9yLnRvSGV4KCksdFsic3Ryb2tlLXdpZHRoIl09dGhpcy5fdG9kZXZXKG4ud2lkdGgueCk7dmFyIG89dm9pZCAwOzAhPShuLmxpbmVjYXAmYy5HREkuUGVuU3R5bGUuUFNfRU5EQ0FQX1NRVUFSRSk/KHRbInN0cm9rZS1saW5lY2FwIl09InNxdWFyZSIsbz0xKTowIT0obi5saW5lY2FwJmMuR0RJLlBlblN0eWxlLlBTX0VORENBUF9GTEFUKT8odFsic3Ryb2tlLWxpbmVjYXAiXT0iYnV0dCIsbz10WyJzdHJva2Utd2lkdGgiXSk6KHRbInN0cm9rZS1saW5lY2FwIl09InJvdW5kIixvPTEpLDAhPShuLmpvaW4mYy5HREkuUGVuU3R5bGUuUFNfSk9JTl9CRVZFTCk/dFsic3Ryb2tlLWxpbmVqb2luIl09ImJldmVsIjowIT0obi5qb2luJmMuR0RJLlBlblN0eWxlLlBTX0pPSU5fTUlURVIpP3RbInN0cm9rZS1saW5lam9pbiJdPSJtaXRlciI6dFsic3Ryb2tlLWxpbmVqb2luIl09InJvdW5kIjt2YXIgcj00KnRbInN0cm9rZS13aWR0aCJdLGE9Mip0WyJzdHJva2Utd2lkdGgiXTtzd2l0Y2gobi5zdHlsZSl7Y2FzZSBjLkdESS5QZW5TdHlsZS5QU19EQVNIOnRbInN0cm9rZS1kYXNoYXJyYXkiXT1bcixhXS50b1N0cmluZygpO2JyZWFrO2Nhc2UgYy5HREkuUGVuU3R5bGUuUFNfRE9UOnRbInN0cm9rZS1kYXNoYXJyYXkiXT1bbyxhXS50b1N0cmluZygpO2JyZWFrO2Nhc2UgYy5HREkuUGVuU3R5bGUuUFNfREFTSERPVDp0WyJzdHJva2UtZGFzaGFycmF5Il09W3IsYSxvLGFdLnRvU3RyaW5nKCk7YnJlYWs7Y2FzZSBjLkdESS5QZW5TdHlsZS5QU19EQVNIRE9URE9UOnRbInN0cm9rZS1kYXNoYXJyYXkiXT1bcixhLG8sYSxvLGFdLnRvU3RyaW5nKCl9fX1pZihpKXt2YXIgaD10aGlzLnN0YXRlLnNlbGVjdGVkLmJydXNoO3N3aXRjaChoLnN0eWxlKXtjYXNlIGMuR0RJLkJydXNoU3R5bGUuQlNfU09MSUQ6dC5maWxsPSIjIitoLmNvbG9yLnRvSGV4KCk7YnJlYWs7Y2FzZSBjLkdESS5CcnVzaFN0eWxlLkJTX1BBVFRFUk46Y2FzZSBjLkdESS5CcnVzaFN0eWxlLkJTX0RJQlBBVFRFUk5QVDp0LmZpbGw9InVybCgjIit0aGlzLl9nZXRTdmdQYXR0ZXJuRm9yQnJ1c2goaCkrIikiO2JyZWFrO2Nhc2UgYy5HREkuQnJ1c2hTdHlsZS5CU19OVUxMOnQuZmlsbD0ibm9uZSI7YnJlYWs7ZGVmYXVsdDpjLmxvZygiW2dkaV0gdW5zdXBwb3J0ZWQgYnJ1c2ggc3R5bGU6ICIraC5zdHlsZSksdC5maWxsPSJub25lIn19aWYocyl7dmFyIGw9dGhpcy5zdGF0ZS5zZWxlY3RlZC5mb250O3RbImZvbnQtZmFtaWx5Il09bC5mYWNlbmFtZSx0WyJmb250LXNpemUiXT10aGlzLl90b2RldkgoTWF0aC5hYnMobC5oZWlnaHQpKSx0LmZpbGw9IiMiK3RoaXMuc3RhdGUudGV4dGNvbG9yLnRvSGV4KCl9cmV0dXJuIHR9LHR9KCksRz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt0aGlzLl9yZWNvcmRzPVtdO3ZhciBpPSExLHM9ZSxuPWZ1bmN0aW9uKCl7dC5zZWVrKHMpO3ZhciBlPXQucmVhZFVpbnQzMigpO2lmKGU8Myl0aHJvdyBuZXcgYSgiSW52YWxpZCByZWNvcmQgc2l6ZSIpO3ZhciBuPXQucmVhZFVpbnQxNigpO3N3aXRjaChuKXtjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9FT0Y6cmV0dXJuIGk9ITAsImJyZWFrLW1haW5fbG9vcCI7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUTUFQTU9ERTp2YXIgcj10LnJlYWRVaW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0TWFwTW9kZShyKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRXSU5ET1dPUkc6dmFyIGg9dC5yZWFkSW50MTYoKSxsPXQucmVhZEludDE2KCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnNldFdpbmRvd09yZyhsLGgpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1NFVFdJTkRPV0VYVDp2YXIgVD10LnJlYWRJbnQxNigpLGY9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0V2luZG93RXh0KGYsVCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfT0ZGU0VUV0lORE9XT1JHOnZhciBnPXQucmVhZEludDE2KCksXz10LnJlYWRJbnQxNigpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5vZmZzZXRXaW5kb3dPcmcoXyxnKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRWSUVXUE9SVE9SRzp2YXIgeT10LnJlYWRJbnQxNigpLFM9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0Vmlld3BvcnRPcmcoUyx5KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRWSUVXUE9SVEVYVDp2YXIgST10LnJlYWRJbnQxNigpLEE9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0Vmlld3BvcnRFeHQoQSxJKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9PRkZTRVRWSUVXUE9SVE9SRzp2YXIgdz10LnJlYWRJbnQxNigpLFA9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Qub2Zmc2V0Vmlld3BvcnRPcmcoUCx3KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TQVZFREM6by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnNhdmVEQygpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1JFU1RPUkVEQzp2YXIgQz10LnJlYWRJbnQxNigpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5yZXN0b3JlREMoQyl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUU1RSRVRDSEJMVE1PREU6dmFyIE49dC5yZWFkVWludDE2KCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnNldFN0cmV0Y2hCbHRNb2RlKE4pfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0RJQkJJVEJMVDp2YXIgRz0zKyhuPj44KSE9PWUseD10LnJlYWRVaW50MTYoKXx0LnJlYWRVaW50MTYoKTw8MTYsQj10LnJlYWRJbnQxNigpLEw9dC5yZWFkSW50MTYoKTtHfHx0LnNraXAoMik7dmFyIGs9dC5yZWFkSW50MTYoKSxVPXQucmVhZEludDE2KCksSD10LnJlYWRJbnQxNigpLEY9dC5yZWFkSW50MTYoKTtpZihHKXt2YXIgaj0yKmUtKHQucG9zLXMpLFg9bmV3IHYodCxqKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QuZGliQml0cyhMLEIsRixILFUsayx4LFgpfSkpfWJyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0RJQlNUUkVUQ0hCTFQ6Rz0zKyhuPj44KSE9PWU7dmFyIFc9dC5yZWFkVWludDE2KCl8dC5yZWFkVWludDE2KCk8PDE2LFk9dC5yZWFkSW50MTYoKSxWPXQucmVhZEludDE2KCksej10LnJlYWRJbnQxNigpLEo9dC5yZWFkSW50MTYoKSxaPXQucmVhZEludDE2KCkscT10LnJlYWRJbnQxNigpLEs9dC5yZWFkSW50MTYoKSxRPXQucmVhZEludDE2KCksJD0oaj0yKmUtKHQucG9zLXMpLG5ldyB2KHQsaikpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5zdHJldGNoRGliQml0cyhKLHosVixZLFEsSyxxLFosVywkKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TVFJFVENIRElCOnZhciB0dD10LnJlYWRVaW50MTYoKXx0LnJlYWRVaW50MTYoKTw8MTYsZXQ9dC5yZWFkSW50MTYoKSxpdD10LnJlYWRJbnQxNigpLHN0PXQucmVhZEludDE2KCksbnQ9dC5yZWFkSW50MTYoKSxvdD10LnJlYWRJbnQxNigpLHJ0PXQucmVhZEludDE2KCksYXQ9dC5yZWFkSW50MTYoKSxodD10LnJlYWRJbnQxNigpLGx0PXQucmVhZEludDE2KCksY3Q9KGo9MiplLSh0LnBvcy1zKSxuZXcgdih0LGopKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc3RyZXRjaERpYihvdCxudCxzdCxpdCxsdCxodCxhdCxydCx0dCxldCxjdCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfRVNDQVBFOnZhciBwdD10LnJlYWRVaW50MTYoKSx1dD10LnJlYWRVaW50MTYoKSxkdD10LnBvcyxUdD1uZXcgcCh0LGR0KTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QuZXNjYXBlKHB0LFR0LGR0LHV0KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRURVhUQUxJR046dmFyIGZ0PXQucmVhZFVpbnQxNigpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5zZXRUZXh0QWxpZ24oZnQpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1NFVEJLTU9ERTp2YXIgRXQ9dC5yZWFkVWludDE2KCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnNldEJrTW9kZShFdCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUVEVYVENPTE9SOnZhciBndD1uZXcgUih0KTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0VGV4dENvbG9yKGd0KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRCS0NPTE9SOnZhciBfdD1uZXcgUih0KTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0QmtDb2xvcihfdCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfQ1JFQVRFQlJVU0hJTkRJUkVDVDpqPTIqZS0odC5wb3Mtcyk7dmFyIHl0PW5ldyBEKHQsaiwhMSk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LmNyZWF0ZUJydXNoKHl0KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9ESUJDUkVBVEVQQVRURVJOQlJVU0g6aj0yKmUtKHQucG9zLXMpO3ZhciBTdD1uZXcgRCh0LGosITApO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5jcmVhdGVCcnVzaChTdCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfQ1JFQVRFUEVOSU5ESVJFQ1Q6dmFyIEl0PW5ldyBNKHQpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5jcmVhdGVQZW4oSXQpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0NSRUFURUZPTlRJTkRJUkVDVDpqPTIqZS0odC5wb3Mtcyk7dmFyIHZ0PW5ldyBPKHQsaik7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LmNyZWF0ZUZvbnQodnQpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1NFTEVDVE9CSkVDVDp2YXIgQXQ9dC5yZWFkVWludDE2KCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnNlbGVjdE9iamVjdChBdCxudWxsKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRUxFQ1RQQUxFVFRFOnZhciBidD10LnJlYWRVaW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2VsZWN0T2JqZWN0KGJ0LCJwYWxldHRlIil9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VMRUNUQ0xJUFJFR0lPTjp2YXIgd3Q9dC5yZWFkVWludDE2KCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnNlbGVjdE9iamVjdCh3dCwicmVnaW9uIil9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfREVMRVRFT0JKRUNUOnZhciBSdD10LnJlYWRVaW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QuZGVsZXRlT2JqZWN0KFJ0KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9SRUNUQU5HTEU6dmFyIE90PW5ldyBkKHQpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5yZWN0YW5nbGUoT3QsMCwwKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9ST1VORFJFQ1Q6dmFyIER0PXQucmVhZEludDE2KCksTXQ9dC5yZWFkSW50MTYoKSxQdD1uZXcgZCh0KTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QucmVjdGFuZ2xlKFB0LE10LER0KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9MSU5FVE86dmFyIG10PXQucmVhZEludDE2KCksQ3Q9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QubGluZVRvKEN0LG10KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9NT1ZFVE86dmFyIE50PXQucmVhZEludDE2KCksR3Q9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QubW92ZVRvKEd0LE50KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9URVhUT1VUOmlmKChIdD10LnJlYWRJbnQxNigpKT4wKXt2YXIgeHQ9dC5yZWFkU3RyaW5nKEh0KTt0LnNraXAoSHQlMik7dmFyIEJ0PXQucmVhZEludDE2KCksTHQ9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QudGV4dE91dChMdCxCdCx4dCl9KSl9YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfRVhUVEVYVE9VVDp2YXIga3Q9dC5yZWFkSW50MTYoKSxVdD10LnJlYWRJbnQxNigpLEh0PXQucmVhZEludDE2KCksRnQ9dC5yZWFkVWludDE2KCksanQ9bnVsbCxYdD1udWxsOzIqZT09PTE0K0h0K0h0JTImJihqdD0hMSxYdD0hMSksMiplPT09MjIrSHQrSHQlMiYmKGp0PSEwLFh0PSExKSwyKmU9PT0xNCtIdCtIdCUyKzIqSHQmJihqdD0hMSxYdD0hMCksMiplPT09MjIrSHQrSHQlMisyKkh0JiYoanQ9ITAsWHQ9ITApO3ZhciBXdD1qdD9uZXcgZCh0KTpudWxsO2lmKEh0PjApe3ZhciBZdD10LnJlYWRTdHJpbmcoSHQpO3Quc2tpcChIdCUyKTt2YXIgVnQ9W107aWYoWHQpZm9yKHZhciB6dD0wO3p0PFl0Lmxlbmd0aDt6dCsrKVZ0LnB1c2godC5yZWFkSW50MTYoKSk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LmV4dFRleHRPdXQoVXQsa3QsWXQsRnQsV3QsVnQpfSkpfWJyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0VYQ0xVREVDTElQUkVDVDp2YXIgSnQ9bmV3IGQodCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LmV4Y2x1ZGVDbGlwUmVjdChKdCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfSU5URVJTRUNUQ0xJUFJFQ1Q6dmFyIFp0PW5ldyBkKHQpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5pbnRlcnNlY3RDbGlwUmVjdChadCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfUE9MWUdPTjpmb3IodmFyIHF0PXQucmVhZEludDE2KCksS3Q9W107cXQ+MDspS3QucHVzaChuZXcgdSh0KSkscXQtLTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QucG9seWdvbihLdCwhMCl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUUE9MWUZJTExNT0RFOnZhciBRdD10LnJlYWRVaW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Quc2V0UG9seUZpbGxNb2RlKFF0KX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9QT0xZUE9MWUdPTjpxdD10LnJlYWRVaW50MTYoKTt2YXIgJHQ9W107Zm9yKHp0PTA7enQ8cXQ7enQrKykkdC5wdXNoKHQucmVhZFVpbnQxNigpKTt2YXIgdGU9W107Zm9yKHp0PTA7enQ8cXQ7enQrKyl7Zm9yKHZhciBlZT0kdFt6dF0saWU9W10sc2U9MDtzZTxlZTtzZSsrKWllLnB1c2gobmV3IHUodCkpO3RlLnB1c2goaWUpfW8uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5wb2x5UG9seWdvbih0ZSl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfUE9MWUxJTkU6cXQ9dC5yZWFkSW50MTYoKTtmb3IodmFyIG5lPVtdO3F0PjA7KW5lLnB1c2gobmV3IHUodCkpLHF0LS07by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LnBvbHlsaW5lKG5lKX0pKTticmVhaztjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9FTExJUFNFOnZhciBvZT1uZXcgZCh0KTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3QuZWxsaXBzZShvZSl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfQ1JFQVRFUEFMRVRURTp2YXIgcmU9bmV3IG0odCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LmNyZWF0ZVBhbGV0dGUocmUpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0NSRUFURVJFR0lPTjp2YXIgYWU9bmV3IEUodCk7by5fcmVjb3Jkcy5wdXNoKChmdW5jdGlvbih0KXt0LmNyZWF0ZVJlZ2lvbihhZSl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfQ1JFQVRFUEFUVEVSTkJSVVNIOmo9MiplLSh0LnBvcy1zKTt2YXIgaGU9bmV3IGIodCxqKSxsZT1uZXcgRCh0LGosaGUpO28uX3JlY29yZHMucHVzaCgoZnVuY3Rpb24odCl7dC5jcmVhdGVQYXR0ZXJuQnJ1c2gobGUpfSkpO2JyZWFrO2Nhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX09GRlNFVENMSVBSR046dmFyIGNlPXQucmVhZEludDE2KCkscGU9dC5yZWFkSW50MTYoKTtvLl9yZWNvcmRzLnB1c2goKGZ1bmN0aW9uKHQpe3Qub2Zmc2V0Q2xpcFJnbihwZSxjZSl9KSk7YnJlYWs7Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfUkVBTElaRVBBTEVUVEU6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUUEFMRU5UUklFUzpjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRST1AyOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1NFVFJFTEFCUzpjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRURVhUQ0hBUkVYVFJBOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1JFU0laRVBBTEVUVEU6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUTEFZT1VUOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0ZJTExSRUdJT046Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUTUFQUEVSRkxBR1M6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0VUVEVYVEpVU1RJRklDQVRJT046Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0NBTEVXSU5ET1dFWFQ6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU0NBTEVWSUVXUE9SVEVYVDpjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9GTE9PREZJTEw6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfRlJBTUVSRUdJT046Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfQU5JTUFURVBBTEVUVEU6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfRVhURkxPT0RGSUxMOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1NFVFBJWEVMOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX1BBVEJMVDpjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9QSUU6Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfU1RSRVRDSEJMVDpjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9JTlZFUlRSRUdJT046Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfUEFJTlRSRUdJT046Y2FzZSBjLkdESS5SZWNvcmRUeXBlLk1FVEFfQVJDOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0NIT1JEOmNhc2UgYy5HREkuUmVjb3JkVHlwZS5NRVRBX0JJVEJMVDpjYXNlIGMuR0RJLlJlY29yZFR5cGUuTUVUQV9TRVRESUJUT0RFVjpkZWZhdWx0OnZhciB1ZT0iVU5LTk9XTiI7Zm9yKHZhciBkZSBpbiBjLkdESS5SZWNvcmRUeXBlKWlmKGMuR0RJLlJlY29yZFR5cGVbZGVdPT09bil7dWU9ZGU7YnJlYWt9Yy5sb2coIltXTUZdICIrdWUrIiByZWNvcmQgKDB4IituLnRvU3RyaW5nKDE2KSsiKSBhdCBvZmZzZXQgMHgiK3MudG9TdHJpbmcoMTYpKyIgd2l0aCAiKzIqZSsiIGJ5dGVzIil9cys9MiplfSxvPXRoaXM7dDpmb3IoOyFpJiYiYnJlYWstbWFpbl9sb29wIiE9PW4oKTspO2lmKCFpKXRocm93IG5ldyBhKCJDb3VsZCBub3QgcmVhZCBhbGwgcmVjb3JkcyIpfXJldHVybiB0LnByb3RvdHlwZS5wbGF5PWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLl9yZWNvcmRzLmxlbmd0aCxpPTA7aTxlO2krKyl0aGlzLl9yZWNvcmRzW2ldKHQpfSx0fSgpLHg9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMucGFyc2UodCksYy5sb2coIldNRkpTLlJlbmRlcmVyIGluc3RhbnRpYXRlZCIpfXJldHVybiB0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsInN2ZyIpO3JldHVybiB0aGlzLl9yZW5kZXIobmV3IG8oZSksdC5tYXBNb2RlLHQueEV4dCx0LnlFeHQpLGUuc2V0QXR0cmlidXRlKCJ2aWV3Qm94IixbMCwwLHQueEV4dCx0LnlFeHRdLmpvaW4oIiAiKSksZS5zZXRBdHRyaWJ1dGUoInByZXNlcnZlQXNwZWN0UmF0aW8iLCJub25lIiksZS5zZXRBdHRyaWJ1dGUoIndpZHRoIix0LndpZHRoKSxlLnNldEF0dHJpYnV0ZSgiaGVpZ2h0Iix0LmhlaWdodCksZX0sdC5wcm90b3R5cGUucGFyc2U9ZnVuY3Rpb24odCl7dGhpcy5faW1nPW51bGw7dmFyIGUsaSxzLG4sbz1uZXcgcCh0KSxyPW8ucmVhZFVpbnQzMigpO3N3aXRjaCgyNTk2NzIwMDg3PT09cj8ocz1uZXcgTChvKSxuPW8ucG9zLGU9by5yZWFkVWludDE2KCksaT1vLnJlYWRVaW50MTYoKSk6KG49MCxlPTY1NTM1JnIsaT1yPj4+MTYmNjU1MzUpLGUpe2Nhc2UgYy5HREkuTWV0YWZpbGVUeXBlLk1FTU9SWU1FVEFGSUxFOmNhc2UgYy5HREkuTWV0YWZpbGVUeXBlLkRJU0tNRVRBRklMRTppZihpPT09Yy5HREkuTUVUQUhFQURFUl9TSVpFLzIpe3ZhciBoPW8ucmVhZFVpbnQxNigpO3N3aXRjaChoKXtjYXNlIGMuR0RJLk1ldGFmaWxlVmVyc2lvbi5NRVRBVkVSU0lPTjEwMDpjYXNlIGMuR0RJLk1ldGFmaWxlVmVyc2lvbi5NRVRBVkVSU0lPTjMwMDp0aGlzLl9pbWc9bmV3IGsobyxzLGgsbisyKmkpfX19aWYobnVsbD09dGhpcy5faW1nKXRocm93IG5ldyBhKCJGb3JtYXQgbm90IHJlY29nbml6ZWQiKX0sdC5wcm90b3R5cGUuX3JlbmRlcj1mdW5jdGlvbih0LGUsaSxzKXt2YXIgbj1uZXcgTih0KTtuLnNldFZpZXdwb3J0RXh0KGkscyksbi5zZXRNYXBNb2RlKGUpLGMubG9nKCJbV01GXSBCRUdJTiBSRU5ERVJJTkcgLS0tXHgzZSIpLHRoaXMuX2ltZy5yZW5kZXIobiksYy5sb2coIltXTUZdIDwtLS0gRE9ORSBSRU5ERVJJTkciKX0sdH0oKSxCPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLmxlZnQ9dC5yZWFkSW50MTYoKSx0aGlzLnRvcD10LnJlYWRJbnQxNigpLHRoaXMucmlnaHQ9dC5yZWFkSW50MTYoKSx0aGlzLmJvdHRvbT10LnJlYWRJbnQxNigpfXJldHVybiB0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJ7bGVmdDogIit0aGlzLmxlZnQrIiwgdG9wOiAiK3RoaXMudG9wKyIsIHJpZ2h0OiAiK3RoaXMucmlnaHQrIiwgYm90dG9tOiAiK3RoaXMuYm90dG9tKyJ9In0sdH0oKSxMPWZ1bmN0aW9uKHQpe3Quc2tpcCgyKSx0aGlzLmJvdW5kaW5nQm94PW5ldyBCKHQpLHRoaXMudW5pdHNQZXJJbmNoPXQucmVhZEludDE2KCksdC5za2lwKDQpLHQuc2tpcCgyKSxjLmxvZygiR290IGJvdW5kaW5nIGJveCAiK3RoaXMuYm91bmRpbmdCb3grIiBhbmQgIit0aGlzLnVuaXRzUGVySW5jaCsiIHVuaXRzL2luY2giKX0saz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlLGkscyl7dGhpcy5fdmVyc2lvbj1pLHRoaXMuX2hkcnNpemU9cyx0aGlzLl9wbGFjYWJsZT1lLHRoaXMuX3JlY29yZHM9bmV3IEcodCx0aGlzLl9oZHJzaXplKX1yZXR1cm4gdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQpe3RoaXMuX3JlY29yZHMucGxheSh0KX0sdH0oKTtyZXR1cm4gZX0pKCkpKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9V01GSlMuYnVuZGxlLm1pbi5qcy5tYXA=";async function bd(){return window.WMFJS||await new Promise((n,e)=>{const t=document.createElement("script");t.src=yd,t.onload=n,t.onerror=e,document.head.appendChild(t)}),window.WMFJS}const oo=8;class xd{constructor(){this.lWMFJS()}async lWMFJS(){this.WMFJS||(this.WMFJS=await bd(),this.WMFJS.loggingEnabled(!1))}async render(e,t={dpi:96,rasterScale:2}){var s;const r=(t==null?void 0:t.dpi)??96,i=(t==null?void 0:t.rasterScale)??1,a=await this.renderWmfToSvgElement(e,r);document.body.appendChild(a);const o=((s=a.getAttribute("viewBox"))==null?void 0:s.split(/\s+/).map(Number))||[0,0,512,512],l=o[2]||512,c=o[3]||512,h=await this.rasterizeSvgToCanvas(a,Math.round(l*i),Math.round(c*i),(t==null?void 0:t.fillWhite)??!0);return new nu(h)}async rasterizeSvgToCanvas(e,t,s,r=!0){const i=new XMLSerializer().serializeToString(e),a=new Blob([i],{type:"image/svg+xml"}),o=URL.createObjectURL(a),l=await this._loadImg(o);let c=t,h=s;if(!c||!h){const p=/viewBox="([\d.\s-]+)"/.exec(i);if(p){const[,m]=p,[,,y,b]=m.trim().split(/\s+/).map(Number);c||(c=Math.max(1,Math.round(y))),h||(h=Math.max(1,Math.round(b)))}else c=c||l.naturalWidth||1024,h=h||l.naturalHeight||1024}const u=document.createElement("canvas");u.width=c,u.height=h;const d=u.getContext("2d");return r&&(d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height)),d.drawImage(l,0,0,u.width,u.height),URL.revokeObjectURL(o),u}async _loadImg(e){return new Promise((t,s)=>{const r=new Image;r.onload=()=>{t(r)},r.onerror=i=>{s(i)},r.src=e})}async renderWmfToSvgElement(e,t=96){await this.lWMFJS();const s=new this.WMFJS.Renderer(e),r=this.getIRendererSettingsFromWMF(e,{dpi:t});return s.render(r)}getIRendererSettingsFromWMF(e,t){var s,r;const i=(t==null?void 0:t.dpi)??96,a=e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(e);let o=0;const l=2596720087;let c=!1;const h=Math.min(a.byteLength-22,256);for(let p=0;p<=h;p+=2)if(a.getUint32(p,!0)===l){o=p,c=!0;break}if(c){const p=a.getInt16(o+6,!0),m=a.getInt16(o+8,!0),y=a.getInt16(o+10,!0),b=a.getInt16(o+12,!0),x=a.getInt16(o+14,!0),g=Math.max(1,y-p),R=Math.max(1,b-m),Z=Math.max(1,Math.round(g/x*i)),v=Math.max(1,Math.round(R/x*i));return{width:`${Z}px`,height:`${v}px`,xExt:g,yExt:R,mapMode:oo}}const u=((s=t==null?void 0:t.fallbackPx)==null?void 0:s.width)??512,d=((r=t==null?void 0:t.fallbackPx)==null?void 0:r.height)??512;return{width:`${u}px`,height:`${d}px`,xExt:u,yExt:d,mapMode:oo}}}class fd{constructor(){this.cfbSig=[208,207,17,224,161,177,26,225]}getImageData(e){const t={type:"",content:null},s=this._indexOfSeq(e,this.cfbSig);if(s>=0&&(e=e.slice(s)),this._isCFB(e)){const r=this._findEmbeddedPreview(e);r?(t.type=r.type,t.content=r.content,t.start=r.start,t.end=r.end):t.error="OLE container found, but no recognizable image/metafile stream was located."}return t}_indexOfSeq(e,t){e:for(let s=0;s<=e.length-t.length;s++){for(let r=0;r<t.length;r++)if(e[s+r]!==t[r])continue e;return s}return-1}_isCFB(e){return e.length>=8&&e[0]===this.cfbSig[0]&&e[1]===this.cfbSig[1]&&e[2]===this.cfbSig[2]&&e[3]===this.cfbSig[3]&&e[4]===this.cfbSig[4]&&e[5]===this.cfbSig[5]&&e[6]===this.cfbSig[6]&&e[7]===this.cfbSig[7]}_findEmbeddedPreview(e){const t=this._findJpeg(e);if(t)return t;const s=this._findGif(e);if(s)return s;const r=this._findBmp(e);if(r)return r;const i=this._findWmf(e);if(i)return i;const a=this._findPng(e);if(a)return a;const o=this._findEmf(e);return o||this._findDib(e)||null}_findPng(e){const t=[137,80,78,71,13,10,26,10],s=this._indexOfSeq(e,t);if(s<0)return null;let r=s+8;for(;r+12<=e.length;){const i=this._readU32BE(e,r),a=r+12+i;if(a>e.length)break;if(e[r+4]===73&&e[r+5]===69&&e[r+6]===78&&e[r+7]===68)return{type:"image/png",start:s,end:a,content:e.slice(s,a)};r=a}return null}_findJpeg(e){const t=this._indexOfSeq(e,[255,216,255]);if(t<0)return null;for(let s=t+2;s<e.length-1;s++)if(e[s]===255&&e[s+1]===217){const r=s+2;return{type:"image/jpeg",start:t,end:r,content:e.slice(t,r)}}return null}_findGif(e){let t=this._indexOfSeq(e,[71,73,70,56,57,97]);if(t<0&&(t=this._indexOfSeq(e,[71,73,70,56,55,97])),t<0)return null;for(let s=t+6;s<e.length;s++)if(e[s]===59){const r=s+1;return{type:"image/gif",start:t,end:r,content:e.slice(t,r)}}return null}_findBmp(e){const t=this._indexOfSeq(e,[66,77]);if(t<0||t+6>e.length)return null;const s=this._readU32LE(e,t+2);if(s>0&&t+s<=e.length){const r=t+s;return{type:"image/bmp",start:t,end:r,content:e.slice(t,r)}}return null}_findWmf(e){const t=[215,205,198,154],s=this._indexOfSeq(e,t);if(s<0)return null;const r=s+22;if(r+8>e.length)return null;this._readU16LE(e,r+2);const i=this._readU32LE(e,r+4)*2;if(i<=0)return null;const a=s+i;return a<=e.length?{type:"wmf",start:s,end:a,content:e.slice(s,a)}:{type:"wmf",start:s,end:e.length,content:e.slice(s)}}_findEmf(e){for(let t=0;t+44<=e.length;t++)if(e[t+40]===32&&e[t+41]===69&&e[t+42]===77&&e[t+43]===70){const s=t;if(s<40)continue;const r=s;if(r+52>e.length)continue;const i=this._readU32LE(e,r+48);if(i>0&&r+i<=e.length){const a=r+i;return{type:"emf",start:r,end:a,content:e.slice(r,a)}}}return null}_findDib(e){for(let t=0;t+40<=e.length;t++){if(this._readU32LE(e,t)!==40)continue;const s=this._readS32LE(e,t+4),r=this._readS32LE(e,t+8),i=this._readU16LE(e,t+12),a=this._readU16LE(e,t+14),o=this._readU32LE(e,t+16),l=this._readU32LE(e,t+20);if(i!==1||s<=0||Math.abs(r)<=0||![1,4,8,16,24,32].includes(a))continue;let c=0;a<=8?c=(this._readU32LE(e,t+32)||1<<a)*4:o===3&&(c=12);let h=l;if(h===0&&o===0){const p=a/8;h=Math.ceil(s*p/4)*4*Math.abs(r)}const u=40+c+(h||0),d=t+u;if(u>40&&d<=e.length)return{type:"image/dib",start:t,end:d,content:e.slice(t,d)}}return null}_readU16LE(e,t){return e[t]|e[t+1]<<8}_readU32LE(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}_readS32LE(e,t){return this._readU32LE(e,t)|0}_readU32BE(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}}class Uc extends Se{constructor(e){super(e),this._Ole2FrameCFBHelpers=new fd,this._wmfRenderer=new xd}async draw(e){let t=new ne;t.name="OLE2FRAMES";let s=e.entities.filter(r=>r.type==="OLE2FRAME");if(s.length===0)return null;for(let r=0;r<s.length;r++){let i=s[r];if(this._hideEntity(i))continue;let a=this._getCached(i),o=null,l=null;if(a)o=a.geometry,l=a.material;else{let h=await this.drawOle2Frame(i);o=h.geometry,l=h.material,l.side=2,this._setCache(i,h)}let c=new ge(o,l);c.userData={entity:i},t.add(c)}return t}async drawOle2Frame(e){const t=e.lowerRightX-e.upperLeftX,s=e.upperLeftY-e.lowerRightY;let r=new Xn(t,s);r.translate(e.upperLeftX+t/2,e.upperLeftY-s/2,0);let i=new Nu;return i.map=await this._createTextureFromImageData(e),i.color.setHex(16777215),i.color.convertSRGBToLinear(),{geometry:r,material:i}}async _createTextureFromImageData(e){let t=this.hexToUint8Array(e.data);Number.isFinite(e.length)&&e.length>0&&t.length>e.length&&(t=t.slice(0,e.length));const s=this._Ole2FrameCFBHelpers.getImageData(t);if(/wmf/.test(s.type))return await this._wmfRenderer.render(s.content);if(/emf/.test(s.type))return this.trigger("log",`Unsupported image type (mime=${s.type}).`),null;if(!s.type.startsWith("image/"))return this.trigger("log",`Unsupported image type (mime=${s.type}).`),null;const r=new Blob([s.content],{type:s.type}),i=URL.createObjectURL(r),a=new Ie;return await new Promise((o,l)=>{const c=new Image;c.onload=()=>{a.image=c,a.needsUpdate=!0,URL.revokeObjectURL(i),o()},c.onerror=()=>{URL.revokeObjectURL(i),l(new Error(`Failed to decode image (${s.type}) from OLE payload`))},c.src=i}),a}hexToUint8Array(e){const t=(e||"").replace(/\s+/g,"");if(t.length%2)throw new Error("Hex string has odd length.");const s=new Uint8Array(t.length>>>1);for(let r=0,i=0;r<t.length;r+=2,i++)s[i]=parseInt(t.substr(r,2),16);return s}}function lo(n,e=!1){const t=n[0].index!==null,s=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),i={},a={},o=n[0].morphTargetsRelative,l=new ie;let c=0;for(let h=0;h<n.length;++h){const u=n[h];let d=0;if(t!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const p in u.attributes){if(!s.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;i[p]===void 0&&(i[p]=[]),i[p].push(u.attributes[p]),d++}if(d!==s.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(o!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const p in u.morphAttributes){if(!r.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;a[p]===void 0&&(a[p]=[]),a[p].push(u.morphAttributes[p])}if(e){let p;if(t)p=u.index.count;else if(u.attributes.position!==void 0)p=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,p,h),c+=p}}if(t){let h=0;const u=[];for(let d=0;d<n.length;++d){const p=n[d].index;for(let m=0;m<p.count;++m)u.push(p.getX(m)+h);h+=n[d].attributes.position.count}l.setIndex(u)}for(const h in i){const u=co(i[h]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,u)}for(const h in a){const u=a[h][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let d=0;d<u;++d){const p=[];for(let y=0;y<a[h].length;++y)p.push(a[h][y][d]);const m=co(p);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(m)}}return l}function co(n){let e,t,s,r=-1,i=0;for(let c=0;c<n.length;++c){const h=n[c];if(e===void 0&&(e=h.array.constructor),e!==h.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=h.itemSize),t!==h.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(s===void 0&&(s=h.normalized),s!==h.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=h.gpuType),r!==h.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;i+=h.count*t}const a=new e(i),o=new q(a,t,s);let l=0;for(let c=0;c<n.length;++c){const h=n[c];if(h.isInterleavedBufferAttribute){const u=l/t;for(let d=0,p=h.count;d<p;d++)for(let m=0;m<t;m++){const y=h.getComponent(d,m);o.setComponent(d+u,m,y)}}else a.set(h.array,l);l+=h.count*t}return r!==void 0&&(o.gpuType=r),o}class gd{constructor(){}merge(e,t=!0,s=[]){let{mesh:r,line:i}=this._getMergedObjects(e,t,s);if((r||i)&&e.userData&&e.userData.entity){let a=e.userData.entity.scaleX?e.userData.entity.scaleX:1,o=e.userData.entity.scaleY?e.userData.entity.scaleY:1,l=e.userData.entity.scaleZ?e.userData.entity.scaleZ:1;r&&(r.scale.set(a,o,l),e.userData.entity.rotation&&(r.rotation.z=e.userData.entity.rotation*Math.PI/180),r.position.set(e.userData.entity.x,e.userData.entity.y,e.userData.entity.z),e.add(r)),i&&(i.scale.set(a,o,l),e.userData.entity.rotation&&(i.rotation.z=e.userData.entity.rotation*Math.PI/180),i.position.set(e.userData.entity.x,e.userData.entity.y,e.userData.entity.z),e.add(i))}else r&&e.add(r),i&&e.add(i);return this._removeEmptyGroups(e),e}_getMergedObjects(e,t,s){let{mesh:r,line:i}=this._getMergedGeometry(e,t,s);const a=r.geometry?new ge(r.geometry,r.materials):null,o=i.geometry?new Xs(i.geometry,i.materials):null;return a&&(a.userData={entities:r.userData,entity:e.userData.entity}),o&&(o.userData={entities:i.userData,entity:e.userData.entity}),{mesh:a,line:o}}_getMergedGeometry(e,t,s){let r=[],i=[],a=[],o=[],l=null;e.updateWorldMatrix(!1,!0);let c={};s.forEach(d=>c[d]=!0),this._removableTraverse(e,d=>{if(!(d.isMesh||d.isLineSegments||d.isLine)||s.length>0&&!c[d.uuid])return;let p=t?d.geometry.clone():d.geometry;if(p.applyMatrix4(d.matrixWorld),d.isMesh){p.index&&(p=p.toNonIndexed()),p.hasAttribute("normal")||p.computeVertexNormals();let b=p.getAttribute("uv");if(b||(b=new q(new Float32Array(p.attributes.position.count*2),2),p.setAttribute("uv",b)),p.attributes.uv.itemSize>2){let x=new q(new Float32Array(p.attributes.uv.count*2),2);for(let g=0;g<p.attributes.uv.count;g++)x.set(p.attributes.uv.getX(g),g*2),x.set(p.attributes.uv.getY(g),g*2+1);p.deleteAttribute("uv"),p.setAttribute("uv",x)}l=a}else p=d.geometry.clone(),p.applyMatrix4(d.matrixWorld),p.index||this._indexLineGeometry(p),p.deleteAttribute("lineDistance"),p.deleteAttribute("uv"),p.deleteAttribute("normal"),l=o;l.push({uuid:d.uuid,userData:d.userData});let m=d.isMesh?r:i,y=this._findGroup(m,d.material);y||(y={material:d.material,geometries:[]},m.push(y)),y.geometries.push(p),p.ent=d,d.parent&&d.parent.remove(d)});let h=r.length>0?this._mergeByMaterial(r):null,u=i.length>0?this._mergeByMaterial(i):null;return{mesh:{geometry:h?h.geometry:null,materials:h?h.materials:null,userData:a},line:{geometry:u?u.geometry:null,materials:u?u.materials:null,userData:o}}}_mergeByMaterial(e){let t=e.map(s=>s.material);return t=t.flat(),{geometry:lo(e.map(s=>lo(s.geometries,!1)),!0),materials:t}}_removeEmptyGroups(e){for(let t=e.children.length-1;t>-1;t--){let s=e.children[t];this._removeEmptyGroups(s),s.isGroup&&s.children.length===0&&e.remove(s)}}_indexLineGeometry(e){let t=[],s=e.attributes.position.count;for(let r=0;r<s;r++)r>0&&(t.push(r-1),t.push(r));e.index||e.setIndex(new q(new Uint16Array(t),1))}_findGroup(e,t){for(let s=0;s<e.length;s++)if(e[s].material===t)return e[s];return null}_removableTraverse(e,t){for(let s=e.children.length-1;s>-1;s--)this._removableTraverse(e.children[s],t);t(e)}}class Rd extends gd{constructor(){super()}merge(e,t=!0,s=[]){let{mesh:r,line:i}=this._getMergedObjects(e,t,s);if((r||i)&&e.userData&&e.userData.entity){let a=e.userData.entity.scaleX?e.userData.entity.scaleX:1,o=e.userData.entity.scaleY?e.userData.entity.scaleY:1,l=e.userData.entity.scaleZ?e.userData.entity.scaleZ:1;r&&(r.scale.set(a,o,l),e.userData.entity.rotation&&(r.rotation.z=e.userData.entity.rotation*Math.PI/180),r.position.set(e.userData.entity.x,e.userData.entity.y,e.userData.entity.z),e.add(r)),i&&(i.scale.set(a,o,l),e.userData.entity.rotation&&(i.rotation.z=e.userData.entity.rotation*Math.PI/180),i.position.set(e.userData.entity.x,e.userData.entity.y,e.userData.entity.z),e.add(i))}else r&&r.add(r),i&&e.add(i);return this._removeEmptyGroups(e),e}_getMergedObjects(e,t,s){let{mesh:r,line:i}=this._getMergedGeometry(e,t,s);const a=r.geometry?new ge(r.geometry,r.materials):null,o=i.geometry?new Xs(i.geometry,i.materials):null;return a&&(a.userData={entities:r.userData,entity:e.userData.entity}),o&&(o.userData={entities:i.userData,entity:e.userData.entity}),{mesh:a,line:o}}}class Nc extends Se{constructor(e,t){super(e),this._font=t,this._lineEntity=new Is(e,t),this._textEntity=new De(e,t),this._solidEntity=new Un(e),this._circleEntity=new Tc(e),this._splineEntity=new Nn(e),this._hatchEntity=new Ic(e),this._ole2FrameEntity=new Uc(e)}async drawBlock(e,t=1){let s=new ne;s.name="BLOCK",s.position.set(-e.x,-e.y,-e.z),s.userData={entity:e,entities:[]};const r=e.entities.filter(o=>o.type==="HATCH"),i=e.entities.filter(o=>o.type!=="HATCH");for(let o=0;o<i.length;o++){let l=i[o];if(this._hideEntity(l))continue;const c=await this._generateBlock3d(l,t);c&&s.add(c)}const a=o=>s.children.filter(l=>o.find(c=>c===l.userData.entity.handle));for(let o=0;o<r.length;o++){let l=r[o];if(this._hideEntity(l))continue;const c=await this._generateBlock3d(l,t,a);c&&s.add(c)}return this._mergeGroup(s),s}async _generateBlock3d(e,t,s){switch(e.type){case"LINE":{let r=this._lineEntity.drawLine(e,t),i=new We(r.geometry,r.material);return r.material.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(i),i.userData={entity:e},i}case"POLYLINE":case"LWPOLYLINE":{let r=this._lineEntity.drawPolyLine(e,t),i=new We(r.geometry,r.material);return r.material.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(i),i.userData={entity:e},i}case"ARC":case"CIRCLE":{let r=this._circleEntity.drawCircle(e,t),i=new We(r.geometry,r.material);return r.material.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(i),i.userData={entity:e},i}case"ELLIPSE":{let r=this._circleEntity.drawEllipse(e,t),i=new We(r.geometry,r.material);return r.material.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(i),i.userData={entity:e},i}case"SPLINE":{let r=this._splineEntity.drawSpline(e,t),i=new We(r.geometry,r.material);return r.material.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(i),i.userData={entity:e},i}case"SOLID":{let r=this._solidEntity.drawSolid(e,t),i=new ge(r.geometry,r.material);return i.userData={entity:e},i}case"ATTRIB":case"TEXT":case"MTEXT":{let r=this._textEntity.drawText(e,t);if(!r)return null;let i=new ge(r.geometry,r.material);return i.userData={entity:e},i}case"INSERT":{let r=e.blockObj?e.blockObj:this._getBlock(this.data.blocks,e.block);if(r&&r.entities.length>0&&!this._hideBlockEntity(r)){let i=new ne;i.name="INSERT",i.add(await this.drawBlock(r,t)),i.userData={entity:e};let a=e.scaleX?e.scaleX:1,o=e.scaleY?e.scaleY:1,l=e.scaleZ?e.scaleZ:1;return e.extrusionZ=e.extrusionZ<0?-1:1,i.scale.set(e.extrusionZ*a,o,l),e.rotation&&(i.rotation.z=e.extrusionZ*e.rotation*Math.PI/180),i.position.set(e.extrusionZ*e.x,e.y,e.z),i}}break;case"HATCH":{let r=this._hatchEntity.drawHatch(e,s);if(r.geometry&&r.geometry.attributes.position.count>0){let i=e.fillType==="SOLID"?new ge(r.geometry,r.material):new Xs(r.geometry,r.material);return r.material.type==="LineDashedMaterial"&&this._geometryHelper.fixMeshToDrawDashedLines(i),i.userData={entity:e},i.renderOrder=e.fillType==="SOLID"?-1:0,i.position.z=e.fillType==="SOLID"?-.1:0,i}}break;case"POINT":break;case"ATTDEF":break;case"DIMENSION":break;case"OLE2FRAME":{let r=await this._ole2FrameEntity.drawOle2Frame(e,t),i=new ge(r.geometry,r.material);return i.userData={entity:e},i}default:this.trigger("log","unknown entity type: "+e.type);break}return null}_rotate(e,t){!t||t===0||e.rotateOnAxis(this._geometryHelper.zAxis,t*Math.PI/180)}_hideBlockEntity(e){return e&&e.name.toLowerCase().startsWith("*paper_space")?!0:this._hideEntity(e)}_mergeGroup(e){const t=new Rd,s=a=>a.name==="BLOCK"||a.name==="INSERT"||a.name==="DIMENSION",r=[],i=[];for(let a=0;a<e.children.length;a++){const o=e.children[a];s(o)?r.push(o):i.push(o)}for(let a=0;a<r.length;a++)e.remove(r[a]);i.length>0&&(e.userData.entities=[],i.forEach(a=>e.userData.entities.push(a)),t.merge(e));for(let a=0;a<r.length;a++)e.add(r[a])}}class Fc extends Se{constructor(e,t){super(e),this._font=t,this._blockEntity=new Nc(e,t)}async draw(e){this.data=e;let t=e.entities.filter(r=>r.type==="INSERT");if(t.length===0)return null;for(let r=0;r<t.length;r++){let i=t[r];if(typeof i.blockObj<"u")continue;let a=this._getBlock(this.data.blocks,i.block);a&&(i.blockObj=a)}let s=new ne;s.name="INSERTS";for(let r=0;r<t.length;r++){let i=t[r];if(this._hideEntity(i))continue;let a=await this.drawInsert(i);a&&s.add(a)}return s}async drawInsert(e){let t=this._getCached(e);if(t)return t;let s=typeof e.scaleX<"u"?e.scaleX:1,r=typeof e.scaleY<"u"?e.scaleY:1,i=typeof e.scaleZ<"u"?e.scaleZ:1,a=e.blockObj?e.blockObj:this._getBlock(this.data.blocks,e.block),o=null;if(a&&!this._blockEntity._hideBlockEntity(a)){o=new ne,o.name="INSERT",o.userData={entity:e};const l=e.extrusionZ<0?-1:1;o.add(await this._blockEntity.drawBlock(a,l)),o.scale.set(l*s,r,i),e.rotation&&(o.rotation.z=l*(e.rotation*Math.PI/180)),o.position.set(l*e.x,e.y,e.z)}return this._setCache(e,o),o}}class Zd extends Se{constructor(e,t){super(e),this._font=t,this._lineEntity=new Is(e,t),this._textEntity=new De(e,t),this._insertEntity=new Fc(e,t),this._solidEntity=new Un(e),this._blockEntity=new Nc(e,t)}async draw(e){let t=e.entities.filter(r=>r.type==="DIMENSION");if(t.length===0)return null;for(let r=0;r<t.length;r++){let i=t[r],a=this._getBlock(e.blocks,i.block);a&&(i.blockObj=a)}let s=new ne;s.name="DIMENSIONS";for(let r=0;r<t.length;r++){let i=t[r];if(!i.blockObj)continue;let a=new ne;a.name="DIMENSION",a.userData={entity:i};let o=await this._blockEntity.drawBlock(i.blockObj);a.add(o),s.add(a)}return s}}function Gd(){}function Sd(){}function vd(){console.error.apply(void 0,arguments)}const tt={info:Gd,warn:Sd,error:vd},Vd=n=>{let e;const t={};return n.forEach(s=>{const r=s[0],i=s[1];switch(i){case"$MEASUREMENT":{e="measurement";break}case"$INSUNITS":{e="insUnits";break}case"$EXTMIN":t.extMin={},e="extMin";break;case"$EXTMAX":t.extMax={},e="extMax";break;case"$DIMASZ":t.dimArrowSize={},e="dimArrowSize";break;default:switch(e){case"extMin":case"extMax":{switch(r){case 10:t[e].x=i;break;case 20:t[e].y=i;break;case 30:t[e].z=i,e=void 0;break}break}case"measurement":case"insUnits":{switch(r){case 70:{t[e]=i,e=void 0;break}}break}case"dimArrowSize":{switch(r){case 40:{t[e]=i,e=void 0;break}}break}}}}),t},Md=n=>{let e=null,t=null;return n.reduce((s,r)=>{const i=r[0],a=r[1];switch(i){case 2:s.name=a;break;case 3:s.description=a;break;case 70:s.flag=a;break;case 72:s.alignment=a;break;case 73:s.elementCount=parseInt(a);break;case 40:s.patternLength=a;break;case 49:e=Object.create({scales:[],offset:[]}),e.length=a,s.pattern.push(e);break;case 74:e.shape=a;break;case 75:e.shapeNumber=a;break;case 340:e.styleHandle=a;break;case 46:e.scales.push(a);break;case 50:e.rotation=a;break;case 44:t=Object.create({x:a,y:0}),e.offset.push(t);break;case 45:t.y=a;break;case 9:e.text=a;break}return s},{type:"LTYPE",pattern:[]})},kd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 2:e.name=r;break;case 6:e.lineTypeName=r;break;case 62:e.colorNumber=r;break;case 70:e.flags=r;break;case 290:e.plot=parseInt(r)!==0;break;case 370:e.lineWeightEnum=r;break}return e},{type:"LAYER"}),wd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 2:e.name=r;break;case 6:e.lineTypeName=r;break;case 40:e.fixedTextHeight=r;break;case 41:e.widthFactor=r;break;case 50:e.obliqueAngle=r;break;case 71:e.flags=r;break;case 42:e.lastHeightUsed=r;break;case 3:e.primaryFontFileName=r;break;case 4:e.bigFontFileName=r;break}return e},{type:"STYLE"}),Ld=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 2:e.name=r;break;case 5:e.handle=r;break;case 70:e.flags=r;break;case 10:e.lowerLeft.x=parseFloat(r);break;case 20:e.lowerLeft.y=parseFloat(r);break;case 11:e.upperRight.x=parseFloat(r);break;case 21:e.upperRight.y=parseFloat(r);break;case 12:e.center.x=parseFloat(r);break;case 22:e.center.y=parseFloat(r);break;case 14:e.snapSpacing.x=parseFloat(r);break;case 24:e.snapSpacing.y=parseFloat(r);break;case 15:e.gridSpacing.x=parseFloat(r);break;case 25:e.gridSpacing.y=parseFloat(r);break;case 16:e.direction.x=parseFloat(r);break;case 26:e.direction.y=parseFloat(r);break;case 36:e.direction.z=parseFloat(r);break;case 17:e.target.x=parseFloat(r);break;case 27:e.target.y=parseFloat(r);break;case 37:e.target.z=parseFloat(r);break;case 45:e.height=parseFloat(r);break;case 50:e.snapAngle=parseFloat(r);break;case 51:e.angle=parseFloat(r);break;case 110:e.x=parseFloat(r);break;case 120:e.y=parseFloat(r);break;case 130:e.z=parseFloat(r);break;case 111:e.xAxisX=parseFloat(r);break;case 121:e.xAxisY=parseFloat(r);break;case 131:e.xAxisZ=parseFloat(r);break;case 112:e.xAxisX=parseFloat(r);break;case 122:e.xAxisY=parseFloat(r);break;case 132:e.xAxisZ=parseFloat(r);break;case 146:e.elevation=parseFloat(r);break}return e},{type:"VPORT",center:{},lowerLeft:{},upperRight:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}}),fs=(n,e,t)=>{const s=[];let r;return n.forEach(i=>{const a=i[0],o=i[1];(a===0||a===2)&&o===e?(r=[],s.push(r)):r.push(i)}),s.reduce((i,a)=>{const o=t(a);return o.name&&(i[o.name]=o),i},{})},Xd=n=>{const e=[];let t;n.forEach(o=>{const l=o[1];l==="TABLE"?(t=[],e.push(t)):l==="ENDTAB"?e.push(t):t.push(o)});let s=[],r=[],i=[],a=[];return e.forEach(o=>{o[0][1]==="STYLE"?s=o:o[0][1]==="LTYPE"?a=o:o[0][1]==="LAYER"?r=o:o[0][1]==="VPORT"&&(i=o)}),{layers:fs(r,"LAYER",kd),styles:fs(s,"STYLE",wd),vports:fs(i,"VPORT",Ld),ltypes:fs(a,"LTYPE",Md)}},A=(n,e)=>{switch(n){case 5:return{handle:e};case 6:return{lineTypeName:e};case 8:return{layer:e};case 48:return{lineTypeScale:e};case 60:return{visible:e===0};case 62:return{colorNumber:e};case 67:return e===0?{}:{paperSpace:e};case 68:return{viewportOn:e};case 69:return{viewport:e};case 210:return{extrusionX:e};case 220:return{extrusionY:e};case 230:return{extrusionZ:e};case 410:return{layout:e};default:return{}}},Cc="POINT",zd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.x=r;break;case 20:e.y=r;break;case 30:e.z=r;break;case 39:e.thickness=r;break;default:Object.assign(e,A(s,r));break}return e},{type:Cc}),Wd={TYPE:Cc,process:zd},Ec="LINE",Td=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.start.x=r;break;case 20:e.start.y=r;break;case 30:e.start.z=r;break;case 39:e.thickness=r;break;case 11:e.end.x=r;break;case 21:e.end.y=r;break;case 31:e.end.z=r;break;default:Object.assign(e,A(s,r));break}return e},{type:Ec,start:{},end:{}}),Id={TYPE:Ec,process:Td},Hc="LWPOLYLINE",Ud=n=>{let e;return n.reduce((t,s)=>{const r=s[0],i=s[1];switch(r){case 70:t.closed=(i&1)===1;break;case 10:e={x:i,y:0},t.vertices.push(e);break;case 20:e.y=i;break;case 39:t.thickness=i;break;case 42:e.bulge=i;break;default:Object.assign(t,A(r,i));break}return t},{type:Hc,vertices:[]})},Nd={TYPE:Hc,process:Ud},Yc="POLYLINE",Fd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 70:e.closed=(r&1)===1,e.polygonMesh=(r&16)===16,e.polyfaceMesh=(r&64)===64;break;case 39:e.thickness=r;break;default:Object.assign(e,A(s,r));break}return e},{type:Yc,vertices:[]}),Cd={TYPE:Yc,process:Fd},Ed="VERTEX",gs=n=>{n.faces=n.faces||[],"x"in n&&!n.x&&delete n.x,"y"in n&&!n.y&&delete n.y,"z"in n&&!n.z&&delete n.z},Hd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.x=r;break;case 20:e.y=r;break;case 30:e.z=r;break;case 42:e.bulge=r;break;case 71:gs(e),e.faces[0]=r;break;case 72:gs(e),e.faces[1]=r;break;case 73:gs(e),e.faces[2]=r;break;case 74:gs(e),e.faces[3]=r;break}return e},{}),Yd={TYPE:Ed,process:Hd},Bc="CIRCLE",Bd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.x=r;break;case 20:e.y=r;break;case 30:e.z=r;break;case 40:e.r=r;break;default:Object.assign(e,A(s,r));break}return e},{type:Bc}),Jd={TYPE:Bc,process:Bd},Jc="ARC",Kd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.x=r;break;case 20:e.y=r;break;case 30:e.z=r;break;case 39:e.thickness=r;break;case 40:e.r=r;break;case 50:e.startAngle=r/180*Math.PI;break;case 51:e.endAngle=r/180*Math.PI;break;default:Object.assign(e,A(s,r));break}return e},{type:Jc}),Pd={TYPE:Jc,process:Kd},Kc="ELLIPSE",_d=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.x=r;break;case 11:e.majorX=r;break;case 20:e.y=r;break;case 21:e.majorY=r;break;case 30:e.z=r;break;case 31:e.majorZ=r;break;case 40:e.axisRatio=r;break;case 41:e.startAngle=r;break;case 42:e.endAngle=r;break;default:Object.assign(e,A(s,r));break}return e},{type:Kc}),jd={TYPE:Kc,process:_d},Pc="SPLINE",Ad=n=>{let e;return n.reduce((t,s)=>{const r=s[0],i=s[1];switch(r){case 10:e={x:i,y:0},t.controlPoints.push(e);break;case 20:e.y=i;break;case 30:e.z=i;break;case 40:t.knots.push(i);break;case 41:t.weights||(t.weights=[]),t.weights.push(i);break;case 42:t.knotTolerance=i;break;case 43:t.controlPointTolerance=i;break;case 44:t.fitTolerance=i;break;case 70:t.flag=i,t.closed=(i&1)===1;break;case 71:t.degree=i;break;case 72:t.numberOfKnots=i;break;case 73:t.numberOfControlPoints=i;break;case 74:t.numberOfFitPoints=i;break;default:Object.assign(t,A(r,i));break}return t},{type:Pc,controlPoints:[],knots:[]})},Qd={TYPE:Pc,process:Ad},_c="SOLID",Od=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.corners[0].x=r;break;case 20:e.corners[0].y=r;break;case 30:e.corners[0].z=r;break;case 11:e.corners[1].x=r;break;case 21:e.corners[1].y=r;break;case 31:e.corners[1].z=r;break;case 12:e.corners[2].x=r;break;case 22:e.corners[2].y=r;break;case 32:e.corners[2].z=r;break;case 13:e.corners[3].x=r;break;case 23:e.corners[3].y=r;break;case 33:e.corners[3].z=r;break;case 39:e.thickness=r;break;default:Object.assign(e,A(s,r));break}return e},{type:_c,corners:[{},{},{},{}]}),Dd={TYPE:_c,process:Od},jc="HATCH";let $="IDLE",T={},ze=0,Pe=!1,ft=null,de={references:[],entities:[]},Rs=null;const qd=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 100:$="IDLE";break;case 2:e.patternName=r;break;case 10:$==="IDLE"?e.elevation.x=parseFloat(r):$==="POLYLINE"?(Rs={x:parseFloat(r),y:0,bulge:0},de.entities[0].points.push(Rs)):$==="SEED"?(ft||(ft={x:0,y:0},e.seeds.seeds.push(ft)),ft.x=parseFloat(r)):zt(s,ze,parseFloat(r));break;case 20:$==="IDLE"?e.elevation.y=parseFloat(r):$==="POLYLINE"?Rs.y=parseFloat(r):$==="SEED"?(ft.y=parseFloat(r),ft=null):zt(s,ze,parseFloat(r));break;case 30:e.elevation.z=parseFloat(r);break;case 63:e.fillColor=r;break;case 70:e.fillType=parseFloat(r)===1?"SOLID":"PATTERN";break;case 210:e.extrusionDir.x=parseFloat(r);break;case 220:e.extrusionDir.y=parseFloat(r);break;case 230:e.extrusionDir.z=parseFloat(r);break;case 91:e.boundary.count=parseFloat(r);break;case 92:if(de={references:[],entities:[]},e.boundary.loops.push(de),de.type=parseFloat(r),Pe=(de.type&2)===2,Pe){const i={type:"POLYLINE",points:[]};de.entities.push(i),$="POLYLINE"}break;case 93:$==="IDLE"&&($="ENT"),de.count=parseFloat(r);break;case 11:case 21:case 40:case 50:case 51:case 74:case 94:case 95:case 96:ze===4&&($="SPLINE"),zt(s,ze,parseFloat(r));break;case 42:Pe?Rs.bulge=parseFloat(r):zt(s,ze,parseFloat(r));break;case 72:ze=parseFloat(r),de[Pe?"hasBulge":"edgeType"]=ze,Pe||(T=ep(ze),de.entities.push(T));break;case 73:$==="IDLE"||Pe?de.entities[0].closed=r:zt(s,ze,parseFloat(r));break;case 75:$="IDLE",e.style=parseFloat(r);break;case 76:e.hatchType=parseFloat(r);break;case 97:$="IDLE",Pe=!1,de.sourceObjects=parseFloat(r);break;case 98:$="SEED",e.seeds.count=parseFloat(r);break;case 52:e.shadowPatternAngle=parseFloat(r);break;case 41:e.spacing=parseFloat(r);break;case 77:e.double=parseFloat(r)===1;break;case 78:e.pattern.lineCount=parseFloat(r);break;case 53:e.pattern.angle=parseFloat(r);break;case 43:e.pattern.x=parseFloat(r);break;case 44:e.pattern.y=parseFloat(r);break;case 45:e.pattern.offsetX=parseFloat(r);break;case 46:e.pattern.offsetY=parseFloat(r);break;case 79:e.pattern.dashCount=parseFloat(r);break;case 49:e.pattern.length.push(r);break;case 330:de.references.push(r);break;case 450:e.solidOrGradient=parseFloat(r)===0?"SOLID":"GRADIENT";break;case 453:e.color.count=parseFloat(r);break;case 460:e.color.rotation=r;break;case 461:e.color.gradient=r;break;case 462:e.color.tint=r;break;default:Object.assign(e,A(s,r));break}return e},{type:jc,elevation:{},extrusionDir:{x:0,y:0,z:1},pattern:{length:[]},boundary:{loops:[]},seeds:{count:0,seeds:[]},color:{}}),$d={TYPE:jc,process:qd};function ep(n){if(Pe)return{};switch(n){case 1:return{type:"LINE",start:{x:0,y:0},end:{x:0,y:0}};case 2:return{type:"ARC",center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,counterClockWise:!1};case 3:return{type:"ELLIPSE",center:{x:0,y:0},startAngle:0,endAngle:0,counterClockWise:!1,major:{x:0,y:0},minor:0};case 4:return{type:"SPLINE",degree:0,rational:0,periodic:0,knots:{count:0,knots:[]},controlPoints:{count:0,points:[]},weights:1}}return{}}function zt(n,e,t){switch(n){case 10:switch(e){case 1:T.start.x=t;break;case 2:T.center.x=t;break;case 3:T.center.x=t;break;case 4:T.controlPoints.points.push({x:t,y:0});break}break;case 20:{switch(e){case 1:T.start.y=t;break;case 2:T.center.y=t;break;case 3:T.center.y=t;break;case 4:T.controlPoints.points[T.controlPoints.points.length-1].y=t;break}break}case 11:switch(e){case 1:T.end.x=t;break;case 3:T.major.x=t;break}break;case 21:{switch(e){case 1:T.end.y=t;break;case 3:T.major.y=t;break}break}case 40:switch(e){case 2:T.radius=t;break;case 3:T.minor=t;break;case 4:T.knots.knots.push(t);break}break;case 42:switch(e){case 4:T.weights=t;break}break;case 50:switch(e){case 2:T.startAngle=t;break;case 3:T.startAngle=t;break}break;case 51:switch(e){case 2:T.endAngle=t;break;case 3:T.endAngle=t;break}break;case 73:switch(e){case 2:T.counterClockWise=parseFloat(t)===1;break;case 3:T.counterClockWise=parseFloat(t)===1;break;case 4:T.rational=t;break}break;case 74:switch(e){case 4:T.periodic=t;break}break;case 94:switch(e){case 4:T.degree=t;break}break;case 95:switch(e){case 4:T.knots.count=t;break}break;case 96:switch(e){case 4:T.controlPoints.count=t;break}break}}const Ac="MTEXT",ho={10:"x",20:"y",30:"z",40:"nominalTextHeight",41:"refRectangleWidth",71:"attachmentPoint",72:"drawingDirection",7:"styleName",11:"xAxisX",21:"xAxisY",31:"xAxisZ",42:"horizontalWidth",43:"verticalHeight",73:"lineSpacingStyle",44:"lineSpacingFactor",90:"backgroundFill",420:"bgColorRGB0",421:"bgColorRGB1",422:"bgColorRGB2",423:"bgColorRGB3",424:"bgColorRGB4",425:"bgColorRGB5",426:"bgColorRGB6",427:"bgColorRGB7",428:"bgColorRGB8",429:"bgColorRGB9",430:"bgColorName0",431:"bgColorName1",432:"bgColorName2",433:"bgColorName3",434:"bgColorName4",435:"bgColorName5",436:"bgColorName6",437:"bgColorName7",438:"bgColorName8",439:"bgColorName9",45:"fillBoxStyle",63:"bgFillColor",441:"bgFillTransparency",75:"columnType",76:"columnCount",78:"columnFlowReversed",79:"columnAutoheight",48:"columnWidth",49:"columnGutter",50:"columnHeights"},tp=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];return C(e,s,r),e},{type:Ac,string:""}),C=(n,e,t)=>(ho[e]!==void 0?n[ho[e]]=t:e===1||e===3?n.string+=t:e===50?(n.xAxisX=Math.cos(t),n.xAxisY=Math.sin(t)):Object.assign(n,A(e,t)),n),sp={TYPE:Ac,process:tp,assign:C},Qc="TEXT",uo={1:"string",10:"x",20:"y",30:"z",11:"x2",21:"y2",31:"z2",39:"thickness",40:"textHeight",41:"relScaleX",50:"rotation",51:"obliqueAngle",7:"styleName",71:"mirror",72:"hAlign",73:"vAlign"},rp=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];return ee(e,s,r),e},{type:Qc,string:""}),ee=(n,e,t)=>{uo[e]!==void 0?n[uo[e]]=t:Object.assign(n,A(e,t))},ip={TYPE:Qc,process:rp,assign:ee},Oc="ATTDEF",np=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];return Fn(e,s,r),e},{type:Oc,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}}),Fn=(n,e,t)=>{switch(e){case 100:{n.subclassMarker=t;break}case 1:switch(n.subclassMarker){case"AcDbText":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break}break;case 2:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.tag=t;break;case"AcDbXrecord":n.attdefFlag=t;break}break;case 3:switch(n.subclassMarker){case"AcDbAttributeDefinition":n.prompt=t;break;case"AcDbMText":C(n.mtext,e,t);break}break;case 7:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break}break;case 10:switch(n.subclassMarker){case"AcDbText":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break;case"AcDbXrecord":n.x=t;break}break;case 20:switch(n.subclassMarker){case"AcDbText":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break;case"AcDbXrecord":n.y=t;break}break;case 30:switch(n.subclassMarker){case"AcDbText":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break;case"AcDbXrecord":n.z=t;break}break;case 11:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.x2=t;break;case"AcDbMText":C(n.mtext,e,t);break}break;case 21:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.y2=t;break;case"AcDbMText":C(n.mtext,e,t);break}break;case 31:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.z2=t;break;case"AcDbMText":C(n.mtext,e,t);break}break;case 39:ee(n.text,e,t);break;case 40:switch(n.subclassMarker){case"AcDbText":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break;case"AcDbXrecord":n.annotationScale=t;break}break;case 41:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break}break;case 42:case 43:case 44:case 45:C(n.mtext,e,t);break;case 46:n.mtext.annotationHeight=t;break;case 48:case 49:C(n.mtext,e,t);break;case 50:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break}break;case 51:ee(n.text,e,t);break;case 63:C(n.mtext,e,t);break;case 70:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.attributeFlags=t;break;case"AcDbXrecord":typeof n.mTextFlag>"u"?n.mTextFlag=t:typeof n.isReallyLocked>"u"?n.isReallyLocked=t:n.secondaryAttdefCount=t;break}break;case 71:case 72:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":ee(n.text,e,t);break;case"AcDbMText":C(n.mtext,e,t);break}break;case 73:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.fieldLength=t;break;case"AcDbMText":C(n.mtext,e,t);break}break;case 74:ee(n.text,73,t);break;case 75:case 76:case 78:case 79:C(n.mtext,e,t);break;case 90:C(n.mtext,e,t);break;case 210:case 220:case 230:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":ee(n.mtext,e,t);break;case"AcDbMText":C(n.mtext,e,t);break}break;case 280:switch(n.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":n.lock=t;break;case"AcDbXrecord":n.clone=!0;break}break;case 340:n.attdefHandle=t;break;case 420:case 421:case 422:case 423:case 424:case 425:case 426:case 427:case 428:case 429:case 430:case 431:case 432:case 433:case 434:case 435:case 436:case 437:case 438:case 439:case 441:C(n.mtext,e,t);break;default:Object.assign(n,A(e,t));break}},ap={TYPE:Oc,process:np,assign:Fn},Dc="ATTRIB",op=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];return Fn(e,s,r),e},{type:Dc,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}}),lp={TYPE:Dc,process:op},qc="INSERT",cp=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 2:e.block=r;break;case 10:e.x=r;break;case 20:e.y=r;break;case 30:e.z=r;break;case 41:e.scaleX=r;break;case 42:e.scaleY=r;break;case 43:e.scaleZ=r;break;case 44:e.columnSpacing=r;break;case 45:e.rowSpacing=r;break;case 50:e.rotation=r;break;case 70:e.columnCount=r;break;case 71:e.rowCount=r;break;case 210:e.extrusionX=r;break;case 220:e.extrusionY=r;break;case 230:e.extrusionZ=r;break;default:Object.assign(e,A(s,r));break}return e},{type:qc}),hp={TYPE:qc,process:cp},$c="3DFACE",up=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 10:e.vertices[0].x=r;break;case 20:e.vertices[0].y=r;break;case 30:e.vertices[0].z=r;break;case 11:e.vertices[1].x=r;break;case 21:e.vertices[1].y=r;break;case 31:e.vertices[1].z=r;break;case 12:e.vertices[2].x=r;break;case 22:e.vertices[2].y=r;break;case 32:e.vertices[2].z=r;break;case 13:e.vertices[3].x=r;break;case 23:e.vertices[3].y=r;break;case 33:e.vertices[3].z=r;break;default:Object.assign(e,A(s,r));break}return e},{type:$c,vertices:[{},{},{},{}]}),dp={TYPE:$c,process:up},eh="DIMENSION",pp=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 2:e.block=r;break;case 10:e.start.x=r;break;case 20:e.start.y=r;break;case 30:e.start.z=r;break;case 11:e.textMidpoint.x=r;break;case 21:e.textMidpoint.y=r;break;case 31:e.textMidpoint.z=r;break;case 13:e.measureStart.x=r;break;case 23:e.measureStart.y=r;break;case 33:e.measureStart.z=r;break;case 14:e.measureEnd.x=r;break;case 24:e.measureEnd.y=r;break;case 34:e.measureEnd.z=r;break;case 50:e.rotation=r;break;case 51:e.horizonRotation=r;break;case 52:e.extensionRotation=r;break;case 53:e.textRotation=r;break;case 70:{const i=mp(r);i.ordinateType&&(e.ordinateType=!0),i.uniqueBlockReference&&(e.uniqueBlockReference=!0),i.userDefinedLocation&&(e.userDefinedLocation=!0),e.dimensionType=i.dimensionType;break}case 71:e.attachementPoint=r;break;case 210:e.extrudeDirection=e.extrudeDirection||{},e.extrudeDirection.x=r;break;case 220:e.extrudeDirection=e.extrudeDirection||{},e.extrudeDirection.y=r;break;case 230:e.extrudeDirection=e.extrudeDirection||{},e.extrudeDirection.z=r;break;default:Object.assign(e,A(s,r));break}return e},{type:eh,start:{x:0,y:0,z:0},measureStart:{x:0,y:0,z:0},measureEnd:{x:0,y:0,z:0},textMidpoint:{x:0,y:0,z:0},attachementPoint:1,dimensionType:0});function mp(n){let e=!1,t=!1,s=!1;if(n>6){const r=n-32,i=n-64,a=n-32-64,o=n-32-128,l=n-32-64-128;r>=0&&r<=6?(e=!0,n=r):i>=0&&i<=6?(t=!0,n=i):a>=0&&a<=6?(e=!0,t=!0,n=a):o>=0&&o<=6?(e=!0,s=!0,n=o):l>=0&&l<=6&&(e=!0,t=!0,s=!0,n=l)}return{dimensionType:n,uniqueBlockReference:e,ordinateType:t,userDefinedLocation:s}}const yp={TYPE:eh,process:pp},th="VIEWPORT",bp=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 1:e.layout=parseFloat(r);break;case 10:e.center.x=parseFloat(r);break;case 20:e.center.y=parseFloat(r);break;case 30:e.center.z=parseFloat(r);break;case 12:e.centerDCS.x=parseFloat(r);break;case 22:e.centerDCS.y=parseFloat(r);break;case 13:e.snap.x=parseFloat(r);break;case 23:e.snap.y=parseFloat(r);break;case 14:e.snapSpacing.x=parseFloat(r);break;case 24:e.snapSpacing.y=parseFloat(r);break;case 15:e.gridSpacing.x=parseFloat(r);break;case 25:e.gridSpacing.y=parseFloat(r);break;case 16:e.direction.x=parseFloat(r);break;case 26:e.direction.y=parseFloat(r);break;case 36:e.direction.z=parseFloat(r);break;case 17:e.target.x=parseFloat(r);break;case 27:e.target.y=parseFloat(r);break;case 37:e.target.z=parseFloat(r);break;case 40:e.width=parseFloat(r);break;case 41:e.height=parseFloat(r);break;case 50:e.snapAngle=parseFloat(r);break;case 51:e.angle=parseFloat(r);break;case 68:e.status=r;break;case 69:e.id=r;break;case 90:e.flags=r;break;case 110:e.x=parseFloat(r);break;case 120:e.y=parseFloat(r);break;case 130:e.z=parseFloat(r);break;case 111:e.xAxisX=parseFloat(r);break;case 121:e.xAxisY=parseFloat(r);break;case 131:e.xAxisZ=parseFloat(r);break;case 112:e.xAxisX=parseFloat(r);break;case 122:e.xAxisY=parseFloat(r);break;case 132:e.xAxisZ=parseFloat(r);break;case 146:e.elevation=parseFloat(r);break;case 281:e.render=r;break;default:Object.assign(e,A(s,r));break}return e},{type:th,center:{},centerDCS:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}}),xp={TYPE:th,process:bp},sh="OLE2FRAME",fp=n=>n.reduce((e,t)=>{const s=t[0],r=t[1];switch(s){case 70:e.version=r;break;case 3:e.name=r;break;case 10:e.upperLeftX=r;break;case 20:e.upperLeftY=r;break;case 30:e.upperLeftZ=r;break;case 11:e.lowerRightX=r;break;case 21:e.lowerRightY=r;break;case 31:e.lowerRightZ=r;break;case 71:e.objectType=r;break;case 72:e.tile=r;break;case 90:e.length=r;break;case 310:e.data+=r;break;default:Object.assign(e,A(s,r));break}return e},{type:sh,data:""}),gp={TYPE:sh,process:fp},po=[Wd,Id,Nd,Cd,Yd,Jd,Pd,jd,Qd,Dd,$d,sp,ap,lp,ip,hp,yp,dp,xp,gp].reduce((n,e)=>(n[e.TYPE]=e,n),{}),rh=n=>{const e=[],t=[];let s;n.forEach(i=>{i[0]===0&&(s=[],t.push(s)),s.push(i)});let r;return t.forEach(i=>{const a=i[0][1],o=i.slice(1);if(po[a]!==void 0){const l=po[a].process(o);a==="POLYLINE"?(r=l,e.push(l)):a==="VERTEX"?r?r.vertices.push(l):tt.error("ignoring invalid VERTEX entity"):a==="SEQEND"?r=void 0:e.push(l)}}),e},Rp=n=>{let e;const t=[];let s,r=[];return n.forEach(i=>{const a=i[0],o=i[1];if(o==="BLOCK")e="block",s={},r=[],t.push(s);else if(o==="ENDBLK")e==="entities"?s.entities=rh(r):s.entities=[],r=void 0,e=void 0;else if(e==="block"&&a!==0)switch(a){case 1:s.xref=o;break;case 2:s.name=o;break;case 10:s.x=o;break;case 20:s.y=o;break;case 30:s.z=o;break;case 67:o!==0&&(s.paperSpace=o);break;case 410:s.layout=o;break}else e==="block"&&a===0?(e="entities",r.push(i)):e==="entities"&&r.push(i)}),t},Zp=n=>{let e;const t={layouts:[]};let s={};return n.forEach((r,i)=>{const a=r[0],o=r[1];if(a===0&&(e="IDLE"),o==="LAYOUT"&&(e="layout",s={},t.layouts.push(s)),e==="layout"&&a!==0)switch(a){case 100:o==="AcDbLayout"&&(e="AcDbLayout");break}if(e==="AcDbLayout"&&a!==0)switch(a){case 1:s.name=o;break;case 5:s.handle=o;break;case 10:s.minLimitX=parseFloat(o);break;case 20:s.minLimitY=parseFloat(o);break;case 11:s.maxLimitX=parseFloat(o);break;case 21:s.maxLimitY=parseFloat(o);break;case 12:s.x=parseFloat(o);break;case 22:s.y=parseFloat(o);break;case 32:s.z=parseFloat(o);break;case 14:s.minX=parseFloat(o);break;case 24:s.minY=parseFloat(o);break;case 34:s.minZ=parseFloat(o);break;case 15:s.maxX=parseFloat(o);break;case 25:s.maxY=parseFloat(o);break;case 35:s.maxZ=parseFloat(o);break;case 70:s.flag=o===1?"PSLTSCALE":"LIMCHECK";break;case 71:s.tabOrder=o;break;case 146:s.elevation=parseFloat(o);break;case 13:s.ucsX=parseFloat(o);break;case 23:s.ucsY=parseFloat(o);break;case 33:s.ucsZ=parseFloat(o);break;case 16:s.ucsXaxisX=parseFloat(o);break;case 26:s.ucsXaxisY=parseFloat(o);break;case 36:s.ucsXaxisZ=parseFloat(o);break;case 17:s.ucsYaxisX=parseFloat(o);break;case 27:s.ucsYaxisY=parseFloat(o);break;case 37:s.ucsYaxisZ=parseFloat(o);break;case 76:switch(o){case 0:s.ucsType="NOT ORTHOGRAPHIC";break;case 1:s.ucsType="TOP";break;case 2:s.ucsType="BOTTOM";break;case 3:s.ucsType="FRONT";break;case 4:s.ucsType="BACK";break;case 5:s.ucsType="LEFT";break;case 6:s.ucsType="RIGHT";break}break;case 330:s.tableRecord=o;break;case 331:s.lastActiveViewport=o;break;case 333:s.shadePlot=o;break}}),t},Gp=(n,e)=>n>=10&&n<60||n>=210&&n<240?parseFloat(e,10):n>=60&&n<100?parseInt(e,10):e,Sp=n=>{let e="type",t;const s=[];for(const r of n)e==="type"?(t=parseInt(r,10),e="value"):(s.push([t,Gp(t,r)]),e="type");return s},vp=n=>{let e;return n.reduce((t,s)=>(s[0]===0&&s[1]==="SECTION"?e=[]:s[0]===0&&s[1]==="ENDSEC"?(t.push(e),e=void 0):e!==void 0&&e.push(s),t),[])},Vp=(n,e)=>{const t=e[0][1],s=e.slice(1);switch(t){case"HEADER":n.header=Vd(s);break;case"TABLES":n.tables=Xd(s);break;case"BLOCKS":n.blocks=Rp(s);break;case"ENTITIES":n.entities=rh(s);break;case"OBJECTS":n.objects=Zp(s);break}return n},Mp=n=>{const e=n.split(/\r\n|\r|\n/g),t=Sp(e);return vp(t).reduce(Vp,{header:{},blocks:[],entities:[],objects:{layouts:[]},tables:{layers:{},styles:{},ltypes:{}}})};var br,mo;function kp(){if(mo)return br;mo=1;function n(){this.__data__=[],this.size=0}return br=n,br}var xr,yo;function ih(){if(yo)return xr;yo=1;function n(e,t){return e===t||e!==e&&t!==t}return xr=n,xr}var fr,bo;function Us(){if(bo)return fr;bo=1;var n=ih();function e(t,s){for(var r=t.length;r--;)if(n(t[r][0],s))return r;return-1}return fr=e,fr}var gr,xo;function wp(){if(xo)return gr;xo=1;var n=Us(),e=Array.prototype,t=e.splice;function s(r){var i=this.__data__,a=n(i,r);if(a<0)return!1;var o=i.length-1;return a==o?i.pop():t.call(i,a,1),--this.size,!0}return gr=s,gr}var Rr,fo;function Lp(){if(fo)return Rr;fo=1;var n=Us();function e(t){var s=this.__data__,r=n(s,t);return r<0?void 0:s[r][1]}return Rr=e,Rr}var Zr,go;function Xp(){if(go)return Zr;go=1;var n=Us();function e(t){return n(this.__data__,t)>-1}return Zr=e,Zr}var Gr,Ro;function zp(){if(Ro)return Gr;Ro=1;var n=Us();function e(t,s){var r=this.__data__,i=n(r,t);return i<0?(++this.size,r.push([t,s])):r[i][1]=s,this}return Gr=e,Gr}var Sr,Zo;function Ns(){if(Zo)return Sr;Zo=1;var n=kp(),e=wp(),t=Lp(),s=Xp(),r=zp();function i(a){var o=-1,l=a==null?0:a.length;for(this.clear();++o<l;){var c=a[o];this.set(c[0],c[1])}}return i.prototype.clear=n,i.prototype.delete=e,i.prototype.get=t,i.prototype.has=s,i.prototype.set=r,Sr=i,Sr}var vr,Go;function Wp(){if(Go)return vr;Go=1;var n=Ns();function e(){this.__data__=new n,this.size=0}return vr=e,vr}var Vr,So;function Tp(){if(So)return Vr;So=1;function n(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}return Vr=n,Vr}var Mr,vo;function Ip(){if(vo)return Mr;vo=1;function n(e){return this.__data__.get(e)}return Mr=n,Mr}var kr,Vo;function Up(){if(Vo)return kr;Vo=1;function n(e){return this.__data__.has(e)}return kr=n,kr}var wr,Mo;function nh(){if(Mo)return wr;Mo=1;var n=typeof bs=="object"&&bs&&bs.Object===Object&&bs;return wr=n,wr}var Lr,ko;function ve(){if(ko)return Lr;ko=1;var n=nh(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return Lr=t,Lr}var Xr,wo;function Cn(){if(wo)return Xr;wo=1;var n=ve(),e=n.Symbol;return Xr=e,Xr}var zr,Lo;function Np(){if(Lo)return zr;Lo=1;var n=Cn(),e=Object.prototype,t=e.hasOwnProperty,s=e.toString,r=n?n.toStringTag:void 0;function i(a){var o=t.call(a,r),l=a[r];try{a[r]=void 0;var c=!0}catch{}var h=s.call(a);return c&&(o?a[r]=l:delete a[r]),h}return zr=i,zr}var Wr,Xo;function Fp(){if(Xo)return Wr;Xo=1;var n=Object.prototype,e=n.toString;function t(s){return e.call(s)}return Wr=t,Wr}var Tr,zo;function Fs(){if(zo)return Tr;zo=1;var n=Cn(),e=Np(),t=Fp(),s="[object Null]",r="[object Undefined]",i=n?n.toStringTag:void 0;function a(o){return o==null?o===void 0?r:s:i&&i in Object(o)?e(o):t(o)}return Tr=a,Tr}var Ir,Wo;function Yt(){if(Wo)return Ir;Wo=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Ir=n,Ir}var Ur,To;function ah(){if(To)return Ur;To=1;var n=Fs(),e=Yt(),t="[object AsyncFunction]",s="[object Function]",r="[object GeneratorFunction]",i="[object Proxy]";function a(o){if(!e(o))return!1;var l=n(o);return l==s||l==r||l==t||l==i}return Ur=a,Ur}var Nr,Io;function Cp(){if(Io)return Nr;Io=1;var n=ve(),e=n["__core-js_shared__"];return Nr=e,Nr}var Fr,Uo;function Ep(){if(Uo)return Fr;Uo=1;var n=Cp(),e=function(){var s=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function t(s){return!!e&&e in s}return Fr=t,Fr}var Cr,No;function oh(){if(No)return Cr;No=1;var n=Function.prototype,e=n.toString;function t(s){if(s!=null){try{return e.call(s)}catch{}try{return s+""}catch{}}return""}return Cr=t,Cr}var Er,Fo;function Hp(){if(Fo)return Er;Fo=1;var n=ah(),e=Ep(),t=Yt(),s=oh(),r=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,a=Function.prototype,o=Object.prototype,l=a.toString,c=o.hasOwnProperty,h=RegExp("^"+l.call(c).replace(r,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function u(d){if(!t(d)||e(d))return!1;var p=n(d)?h:i;return p.test(s(d))}return Er=u,Er}var Hr,Co;function Yp(){if(Co)return Hr;Co=1;function n(e,t){return e==null?void 0:e[t]}return Hr=n,Hr}var Yr,Eo;function st(){if(Eo)return Yr;Eo=1;var n=Hp(),e=Yp();function t(s,r){var i=e(s,r);return n(i)?i:void 0}return Yr=t,Yr}var Br,Ho;function En(){if(Ho)return Br;Ho=1;var n=st(),e=ve(),t=n(e,"Map");return Br=t,Br}var Jr,Yo;function Cs(){if(Yo)return Jr;Yo=1;var n=st(),e=n(Object,"create");return Jr=e,Jr}var Kr,Bo;function Bp(){if(Bo)return Kr;Bo=1;var n=Cs();function e(){this.__data__=n?n(null):{},this.size=0}return Kr=e,Kr}var Pr,Jo;function Jp(){if(Jo)return Pr;Jo=1;function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Pr=n,Pr}var _r,Ko;function Kp(){if(Ko)return _r;Ko=1;var n=Cs(),e="__lodash_hash_undefined__",t=Object.prototype,s=t.hasOwnProperty;function r(i){var a=this.__data__;if(n){var o=a[i];return o===e?void 0:o}return s.call(a,i)?a[i]:void 0}return _r=r,_r}var jr,Po;function Pp(){if(Po)return jr;Po=1;var n=Cs(),e=Object.prototype,t=e.hasOwnProperty;function s(r){var i=this.__data__;return n?i[r]!==void 0:t.call(i,r)}return jr=s,jr}var Ar,_o;function _p(){if(_o)return Ar;_o=1;var n=Cs(),e="__lodash_hash_undefined__";function t(s,r){var i=this.__data__;return this.size+=this.has(s)?0:1,i[s]=n&&r===void 0?e:r,this}return Ar=t,Ar}var Qr,jo;function jp(){if(jo)return Qr;jo=1;var n=Bp(),e=Jp(),t=Kp(),s=Pp(),r=_p();function i(a){var o=-1,l=a==null?0:a.length;for(this.clear();++o<l;){var c=a[o];this.set(c[0],c[1])}}return i.prototype.clear=n,i.prototype.delete=e,i.prototype.get=t,i.prototype.has=s,i.prototype.set=r,Qr=i,Qr}var Or,Ao;function Ap(){if(Ao)return Or;Ao=1;var n=jp(),e=Ns(),t=En();function s(){this.size=0,this.__data__={hash:new n,map:new(t||e),string:new n}}return Or=s,Or}var Dr,Qo;function Qp(){if(Qo)return Dr;Qo=1;function n(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Dr=n,Dr}var qr,Oo;function Es(){if(Oo)return qr;Oo=1;var n=Qp();function e(t,s){var r=t.__data__;return n(s)?r[typeof s=="string"?"string":"hash"]:r.map}return qr=e,qr}var $r,Do;function Op(){if(Do)return $r;Do=1;var n=Es();function e(t){var s=n(this,t).delete(t);return this.size-=s?1:0,s}return $r=e,$r}var ei,qo;function Dp(){if(qo)return ei;qo=1;var n=Es();function e(t){return n(this,t).get(t)}return ei=e,ei}var ti,$o;function qp(){if($o)return ti;$o=1;var n=Es();function e(t){return n(this,t).has(t)}return ti=e,ti}var si,el;function $p(){if(el)return si;el=1;var n=Es();function e(t,s){var r=n(this,t),i=r.size;return r.set(t,s),this.size+=r.size==i?0:1,this}return si=e,si}var ri,tl;function e0(){if(tl)return ri;tl=1;var n=Ap(),e=Op(),t=Dp(),s=qp(),r=$p();function i(a){var o=-1,l=a==null?0:a.length;for(this.clear();++o<l;){var c=a[o];this.set(c[0],c[1])}}return i.prototype.clear=n,i.prototype.delete=e,i.prototype.get=t,i.prototype.has=s,i.prototype.set=r,ri=i,ri}var ii,sl;function t0(){if(sl)return ii;sl=1;var n=Ns(),e=En(),t=e0(),s=200;function r(i,a){var o=this.__data__;if(o instanceof n){var l=o.__data__;if(!e||l.length<s-1)return l.push([i,a]),this.size=++o.size,this;o=this.__data__=new t(l)}return o.set(i,a),this.size=o.size,this}return ii=r,ii}var ni,rl;function s0(){if(rl)return ni;rl=1;var n=Ns(),e=Wp(),t=Tp(),s=Ip(),r=Up(),i=t0();function a(o){var l=this.__data__=new n(o);this.size=l.size}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=s,a.prototype.has=r,a.prototype.set=i,ni=a,ni}var ai,il;function r0(){if(il)return ai;il=1;function n(e,t){for(var s=-1,r=e==null?0:e.length;++s<r&&t(e[s],s,e)!==!1;);return e}return ai=n,ai}var oi,nl;function i0(){if(nl)return oi;nl=1;var n=st(),e=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch{}}();return oi=e,oi}var li,al;function lh(){if(al)return li;al=1;var n=i0();function e(t,s,r){s=="__proto__"&&n?n(t,s,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[s]=r}return li=e,li}var ci,ol;function ch(){if(ol)return ci;ol=1;var n=lh(),e=ih(),t=Object.prototype,s=t.hasOwnProperty;function r(i,a,o){var l=i[a];(!(s.call(i,a)&&e(l,o))||o===void 0&&!(a in i))&&n(i,a,o)}return ci=r,ci}var hi,ll;function Hs(){if(ll)return hi;ll=1;var n=ch(),e=lh();function t(s,r,i,a){var o=!i;i||(i={});for(var l=-1,c=r.length;++l<c;){var h=r[l],u=a?a(i[h],s[h],h,i,s):void 0;u===void 0&&(u=s[h]),o?e(i,h,u):n(i,h,u)}return i}return hi=t,hi}var ui,cl;function n0(){if(cl)return ui;cl=1;function n(e,t){for(var s=-1,r=Array(e);++s<e;)r[s]=t(s);return r}return ui=n,ui}var di,hl;function Bt(){if(hl)return di;hl=1;function n(e){return e!=null&&typeof e=="object"}return di=n,di}var pi,ul;function a0(){if(ul)return pi;ul=1;var n=Fs(),e=Bt(),t="[object Arguments]";function s(r){return e(r)&&n(r)==t}return pi=s,pi}var mi,dl;function o0(){if(dl)return mi;dl=1;var n=a0(),e=Bt(),t=Object.prototype,s=t.hasOwnProperty,r=t.propertyIsEnumerable,i=n(function(){return arguments}())?n:function(a){return e(a)&&s.call(a,"callee")&&!r.call(a,"callee")};return mi=i,mi}var yi,pl;function Hn(){if(pl)return yi;pl=1;var n=Array.isArray;return yi=n,yi}var Zs={exports:{}},bi,ml;function l0(){if(ml)return bi;ml=1;function n(){return!1}return bi=n,bi}Zs.exports;var yl;function hh(){return yl||(yl=1,function(n,e){var t=ve(),s=l0(),r=e&&!e.nodeType&&e,i=r&&!0&&n&&!n.nodeType&&n,a=i&&i.exports===r,o=a?t.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||s;n.exports=c}(Zs,Zs.exports)),Zs.exports}var xi,bl;function c0(){if(bl)return xi;bl=1;var n=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(s,r){var i=typeof s;return r=r??n,!!r&&(i=="number"||i!="symbol"&&e.test(s))&&s>-1&&s%1==0&&s<r}return xi=t,xi}var fi,xl;function uh(){if(xl)return fi;xl=1;var n=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=n}return fi=e,fi}var gi,fl;function h0(){if(fl)return gi;fl=1;var n=Fs(),e=uh(),t=Bt(),s="[object Arguments]",r="[object Array]",i="[object Boolean]",a="[object Date]",o="[object Error]",l="[object Function]",c="[object Map]",h="[object Number]",u="[object Object]",d="[object RegExp]",p="[object Set]",m="[object String]",y="[object WeakMap]",b="[object ArrayBuffer]",x="[object DataView]",g="[object Float32Array]",R="[object Float64Array]",Z="[object Int8Array]",v="[object Int16Array]",G="[object Int32Array]",S="[object Uint8Array]",V="[object Uint8ClampedArray]",k="[object Uint16Array]",X="[object Uint32Array]",M={};M[g]=M[R]=M[Z]=M[v]=M[G]=M[S]=M[V]=M[k]=M[X]=!0,M[s]=M[r]=M[b]=M[i]=M[x]=M[a]=M[o]=M[l]=M[c]=M[h]=M[u]=M[d]=M[p]=M[m]=M[y]=!1;function F(L){return t(L)&&e(L.length)&&!!M[n(L)]}return gi=F,gi}var Ri,gl;function Yn(){if(gl)return Ri;gl=1;function n(e){return function(t){return e(t)}}return Ri=n,Ri}var Gs={exports:{}};Gs.exports;var Rl;function Bn(){return Rl||(Rl=1,function(n,e){var t=nh(),s=e&&!e.nodeType&&e,r=s&&!0&&n&&!n.nodeType&&n,i=r&&r.exports===s,a=i&&t.process,o=function(){try{var l=r&&r.require&&r.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();n.exports=o}(Gs,Gs.exports)),Gs.exports}var Zi,Zl;function u0(){if(Zl)return Zi;Zl=1;var n=h0(),e=Yn(),t=Bn(),s=t&&t.isTypedArray,r=s?e(s):n;return Zi=r,Zi}var Gi,Gl;function dh(){if(Gl)return Gi;Gl=1;var n=n0(),e=o0(),t=Hn(),s=hh(),r=c0(),i=u0(),a=Object.prototype,o=a.hasOwnProperty;function l(c,h){var u=t(c),d=!u&&e(c),p=!u&&!d&&s(c),m=!u&&!d&&!p&&i(c),y=u||d||p||m,b=y?n(c.length,String):[],x=b.length;for(var g in c)(h||o.call(c,g))&&!(y&&(g=="length"||p&&(g=="offset"||g=="parent")||m&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||r(g,x)))&&b.push(g);return b}return Gi=l,Gi}var Si,Sl;function Jn(){if(Sl)return Si;Sl=1;var n=Object.prototype;function e(t){var s=t&&t.constructor,r=typeof s=="function"&&s.prototype||n;return t===r}return Si=e,Si}var vi,vl;function ph(){if(vl)return vi;vl=1;function n(e,t){return function(s){return e(t(s))}}return vi=n,vi}var Vi,Vl;function d0(){if(Vl)return Vi;Vl=1;var n=ph(),e=n(Object.keys,Object);return Vi=e,Vi}var Mi,Ml;function p0(){if(Ml)return Mi;Ml=1;var n=Jn(),e=d0(),t=Object.prototype,s=t.hasOwnProperty;function r(i){if(!n(i))return e(i);var a=[];for(var o in Object(i))s.call(i,o)&&o!="constructor"&&a.push(o);return a}return Mi=r,Mi}var ki,kl;function mh(){if(kl)return ki;kl=1;var n=ah(),e=uh();function t(s){return s!=null&&e(s.length)&&!n(s)}return ki=t,ki}var wi,wl;function Kn(){if(wl)return wi;wl=1;var n=dh(),e=p0(),t=mh();function s(r){return t(r)?n(r):e(r)}return wi=s,wi}var Li,Ll;function m0(){if(Ll)return Li;Ll=1;var n=Hs(),e=Kn();function t(s,r){return s&&n(r,e(r),s)}return Li=t,Li}var Xi,Xl;function y0(){if(Xl)return Xi;Xl=1;function n(e){var t=[];if(e!=null)for(var s in Object(e))t.push(s);return t}return Xi=n,Xi}var zi,zl;function b0(){if(zl)return zi;zl=1;var n=Yt(),e=Jn(),t=y0(),s=Object.prototype,r=s.hasOwnProperty;function i(a){if(!n(a))return t(a);var o=e(a),l=[];for(var c in a)c=="constructor"&&(o||!r.call(a,c))||l.push(c);return l}return zi=i,zi}var Wi,Wl;function Pn(){if(Wl)return Wi;Wl=1;var n=dh(),e=b0(),t=mh();function s(r){return t(r)?n(r,!0):e(r)}return Wi=s,Wi}var Ti,Tl;function x0(){if(Tl)return Ti;Tl=1;var n=Hs(),e=Pn();function t(s,r){return s&&n(r,e(r),s)}return Ti=t,Ti}var Ss={exports:{}};Ss.exports;var Il;function f0(){return Il||(Il=1,function(n,e){var t=ve(),s=e&&!e.nodeType&&e,r=s&&!0&&n&&!n.nodeType&&n,i=r&&r.exports===s,a=i?t.Buffer:void 0,o=a?a.allocUnsafe:void 0;function l(c,h){if(h)return c.slice();var u=c.length,d=o?o(u):new c.constructor(u);return c.copy(d),d}n.exports=l}(Ss,Ss.exports)),Ss.exports}var Ii,Ul;function g0(){if(Ul)return Ii;Ul=1;function n(e,t){var s=-1,r=e.length;for(t||(t=Array(r));++s<r;)t[s]=e[s];return t}return Ii=n,Ii}var Ui,Nl;function R0(){if(Nl)return Ui;Nl=1;function n(e,t){for(var s=-1,r=e==null?0:e.length,i=0,a=[];++s<r;){var o=e[s];t(o,s,e)&&(a[i++]=o)}return a}return Ui=n,Ui}var Ni,Fl;function yh(){if(Fl)return Ni;Fl=1;function n(){return[]}return Ni=n,Ni}var Fi,Cl;function _n(){if(Cl)return Fi;Cl=1;var n=R0(),e=yh(),t=Object.prototype,s=t.propertyIsEnumerable,r=Object.getOwnPropertySymbols,i=r?function(a){return a==null?[]:(a=Object(a),n(r(a),function(o){return s.call(a,o)}))}:e;return Fi=i,Fi}var Ci,El;function Z0(){if(El)return Ci;El=1;var n=Hs(),e=_n();function t(s,r){return n(s,e(s),r)}return Ci=t,Ci}var Ei,Hl;function bh(){if(Hl)return Ei;Hl=1;function n(e,t){for(var s=-1,r=t.length,i=e.length;++s<r;)e[i+s]=t[s];return e}return Ei=n,Ei}var Hi,Yl;function xh(){if(Yl)return Hi;Yl=1;var n=ph(),e=n(Object.getPrototypeOf,Object);return Hi=e,Hi}var Yi,Bl;function fh(){if(Bl)return Yi;Bl=1;var n=bh(),e=xh(),t=_n(),s=yh(),r=Object.getOwnPropertySymbols,i=r?function(a){for(var o=[];a;)n(o,t(a)),a=e(a);return o}:s;return Yi=i,Yi}var Bi,Jl;function G0(){if(Jl)return Bi;Jl=1;var n=Hs(),e=fh();function t(s,r){return n(s,e(s),r)}return Bi=t,Bi}var Ji,Kl;function gh(){if(Kl)return Ji;Kl=1;var n=bh(),e=Hn();function t(s,r,i){var a=r(s);return e(s)?a:n(a,i(s))}return Ji=t,Ji}var Ki,Pl;function S0(){if(Pl)return Ki;Pl=1;var n=gh(),e=_n(),t=Kn();function s(r){return n(r,t,e)}return Ki=s,Ki}var Pi,_l;function v0(){if(_l)return Pi;_l=1;var n=gh(),e=fh(),t=Pn();function s(r){return n(r,t,e)}return Pi=s,Pi}var _i,jl;function V0(){if(jl)return _i;jl=1;var n=st(),e=ve(),t=n(e,"DataView");return _i=t,_i}var ji,Al;function M0(){if(Al)return ji;Al=1;var n=st(),e=ve(),t=n(e,"Promise");return ji=t,ji}var Ai,Ql;function k0(){if(Ql)return Ai;Ql=1;var n=st(),e=ve(),t=n(e,"Set");return Ai=t,Ai}var Qi,Ol;function w0(){if(Ol)return Qi;Ol=1;var n=st(),e=ve(),t=n(e,"WeakMap");return Qi=t,Qi}var Oi,Dl;function jn(){if(Dl)return Oi;Dl=1;var n=V0(),e=En(),t=M0(),s=k0(),r=w0(),i=Fs(),a=oh(),o="[object Map]",l="[object Object]",c="[object Promise]",h="[object Set]",u="[object WeakMap]",d="[object DataView]",p=a(n),m=a(e),y=a(t),b=a(s),x=a(r),g=i;return(n&&g(new n(new ArrayBuffer(1)))!=d||e&&g(new e)!=o||t&&g(t.resolve())!=c||s&&g(new s)!=h||r&&g(new r)!=u)&&(g=function(R){var Z=i(R),v=Z==l?R.constructor:void 0,G=v?a(v):"";if(G)switch(G){case p:return d;case m:return o;case y:return c;case b:return h;case x:return u}return Z}),Oi=g,Oi}var Di,ql;function L0(){if(ql)return Di;ql=1;var n=Object.prototype,e=n.hasOwnProperty;function t(s){var r=s.length,i=new s.constructor(r);return r&&typeof s[0]=="string"&&e.call(s,"index")&&(i.index=s.index,i.input=s.input),i}return Di=t,Di}var qi,$l;function X0(){if($l)return qi;$l=1;var n=ve(),e=n.Uint8Array;return qi=e,qi}var $i,ec;function An(){if(ec)return $i;ec=1;var n=X0();function e(t){var s=new t.constructor(t.byteLength);return new n(s).set(new n(t)),s}return $i=e,$i}var en,tc;function z0(){if(tc)return en;tc=1;var n=An();function e(t,s){var r=s?n(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}return en=e,en}var tn,sc;function W0(){if(sc)return tn;sc=1;var n=/\w*$/;function e(t){var s=new t.constructor(t.source,n.exec(t));return s.lastIndex=t.lastIndex,s}return tn=e,tn}var sn,rc;function T0(){if(rc)return sn;rc=1;var n=Cn(),e=n?n.prototype:void 0,t=e?e.valueOf:void 0;function s(r){return t?Object(t.call(r)):{}}return sn=s,sn}var rn,ic;function I0(){if(ic)return rn;ic=1;var n=An();function e(t,s){var r=s?n(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}return rn=e,rn}var nn,nc;function U0(){if(nc)return nn;nc=1;var n=An(),e=z0(),t=W0(),s=T0(),r=I0(),i="[object Boolean]",a="[object Date]",o="[object Map]",l="[object Number]",c="[object RegExp]",h="[object Set]",u="[object String]",d="[object Symbol]",p="[object ArrayBuffer]",m="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",x="[object Int8Array]",g="[object Int16Array]",R="[object Int32Array]",Z="[object Uint8Array]",v="[object Uint8ClampedArray]",G="[object Uint16Array]",S="[object Uint32Array]";function V(k,X,M){var F=k.constructor;switch(X){case p:return n(k);case i:case a:return new F(+k);case m:return e(k,M);case y:case b:case x:case g:case R:case Z:case v:case G:case S:return r(k,M);case o:return new F;case l:case u:return new F(k);case c:return t(k);case h:return new F;case d:return s(k)}}return nn=V,nn}var an,ac;function N0(){if(ac)return an;ac=1;var n=Yt(),e=Object.create,t=function(){function s(){}return function(r){if(!n(r))return{};if(e)return e(r);s.prototype=r;var i=new s;return s.prototype=void 0,i}}();return an=t,an}var on,oc;function F0(){if(oc)return on;oc=1;var n=N0(),e=xh(),t=Jn();function s(r){return typeof r.constructor=="function"&&!t(r)?n(e(r)):{}}return on=s,on}var ln,lc;function C0(){if(lc)return ln;lc=1;var n=jn(),e=Bt(),t="[object Map]";function s(r){return e(r)&&n(r)==t}return ln=s,ln}var cn,cc;function E0(){if(cc)return cn;cc=1;var n=C0(),e=Yn(),t=Bn(),s=t&&t.isMap,r=s?e(s):n;return cn=r,cn}var hn,hc;function H0(){if(hc)return hn;hc=1;var n=jn(),e=Bt(),t="[object Set]";function s(r){return e(r)&&n(r)==t}return hn=s,hn}var un,uc;function Y0(){if(uc)return un;uc=1;var n=H0(),e=Yn(),t=Bn(),s=t&&t.isSet,r=s?e(s):n;return un=r,un}var dn,dc;function B0(){if(dc)return dn;dc=1;var n=s0(),e=r0(),t=ch(),s=m0(),r=x0(),i=f0(),a=g0(),o=Z0(),l=G0(),c=S0(),h=v0(),u=jn(),d=L0(),p=U0(),m=F0(),y=Hn(),b=hh(),x=E0(),g=Yt(),R=Y0(),Z=Kn(),v=Pn(),G=1,S=2,V=4,k="[object Arguments]",X="[object Array]",M="[object Boolean]",F="[object Date]",L="[object Error]",W="[object Function]",U="[object GeneratorFunction]",H="[object Map]",ae="[object Number]",oe="[object Object]",Y="[object RegExp]",B="[object Set]",_="[object String]",Ne="[object Symbol]",rt="[object WeakMap]",Ys="[object ArrayBuffer]",Kt="[object DataView]",Sh="[object Float32Array]",vh="[object Float64Array]",Vh="[object Int8Array]",Mh="[object Int16Array]",kh="[object Int32Array]",wh="[object Uint8Array]",Lh="[object Uint8ClampedArray]",Xh="[object Uint16Array]",zh="[object Uint32Array]",N={};N[k]=N[X]=N[Ys]=N[Kt]=N[M]=N[F]=N[Sh]=N[vh]=N[Vh]=N[Mh]=N[kh]=N[H]=N[ae]=N[oe]=N[Y]=N[B]=N[_]=N[Ne]=N[wh]=N[Lh]=N[Xh]=N[zh]=!0,N[L]=N[W]=N[rt]=!1;function Pt(I,it,nt,Wh,_t,Fe){var te,jt=it&G,At=it&S,Th=it&V;if(nt&&(te=_t?nt(I,Wh,_t,Fe):nt(I)),te!==void 0)return te;if(!g(I))return I;var qn=y(I);if(qn){if(te=d(I),!jt)return a(I,te)}else{var at=u(I),$n=at==W||at==U;if(b(I))return i(I,jt);if(at==oe||at==k||$n&&!_t){if(te=At||$n?{}:m(I),!jt)return At?l(I,r(te,I)):o(I,s(te,I))}else{if(!N[at])return _t?I:{};te=p(I,at,jt)}}Fe||(Fe=new n);var ea=Fe.get(I);if(ea)return ea;Fe.set(I,te),R(I)?I.forEach(function(Ce){te.add(Pt(Ce,it,nt,Ce,I,Fe))}):x(I)&&I.forEach(function(Ce,je){te.set(je,Pt(Ce,it,nt,je,I,Fe))});var Ih=Th?At?h:c:At?v:Z,ta=qn?void 0:Ih(I);return e(ta||I,function(Ce,je){ta&&(je=Ce,Ce=I[je]),t(te,je,Pt(Ce,it,nt,je,I,Fe))}),te}return dn=Pt,dn}var pn,pc;function J0(){if(pc)return pn;pc=1;var n=B0(),e=1,t=4;function s(r){return n(r,e|t)}return pn=s,pn}var K0=J0();const mc=Tn(K0),Qn=n=>{const e=n.blocks.reduce((s,r)=>(s[r.name]=r,s),{}),t=(s,r)=>{let i=[];return s.forEach(a=>{if(a.type==="INSERT"){const o=a,l=e[o.block];if(!l){tt.error("no block found for insert. block:",o.block);return}const c=o.rowCount??1,h=o.columnCount??1,u=o.rowSpacing??0,d=o.columnSpacing??0,p=o.rotation??0;let m,y;if(c>1||h>1){const b=Math.cos(p*Math.PI/180),x=Math.sin(p*Math.PI/180);m={x:-x*u,y:b*u},y={x:b*d,y:x*d}}else m={x:0,y:0},y={x:0,y:0};for(let b=0;b<c;b++)for(let x=0;x<h;x++){const g={x:o.x+m.x*b+y.x*x,y:o.y+m.y*b+y.y*x,scaleX:o.scaleX,scaleY:o.scaleY,scaleZ:o.scaleZ,extrusionX:o.extrusionX,extrusionY:o.extrusionY,extrusionZ:o.extrusionZ,rotation:o.rotation},R=r.slice(0);R.push(g);const Z=l.entities.map(v=>{const G=mc(v);switch(G.layer=o.layer,G.type){case"LINE":{G.start.x-=l.x,G.start.y-=l.y,G.end.x-=l.x,G.end.y-=l.y;break}case"LWPOLYLINE":case"POLYLINE":{G.vertices.forEach(S=>{S.x-=l.x,S.y-=l.y});break}case"CIRCLE":case"ELLIPSE":case"ARC":{G.x-=l.x,G.y-=l.y;break}case"SPLINE":{G.controlPoints.forEach(S=>{S.x-=l.x,S.y-=l.y});break}}return G});i=i.concat(t(Z,R))}}else{const o=mc(a);o.transforms=r.slice().reverse(),i.push(o)}}),i};return t(n.entities,[])};var D=Wc();const P0=(n,e)=>typeof e>"u"||+e==0?Math.round(n):(n=+n,e=+e,isNaN(n)||!(typeof e=="number"&&e%1===0)?NaN:(n=n.toString().split("e"),n=Math.round(+(n[0]+"e"+(n[1]?+n[1]-e:-e))),n=n.toString().split("e"),+(n[0]+"e"+(n[1]?+n[1]+e:e)))),_0=(n,e,t,s,r)=>{const i=t.length,a=t[0].length;if(n<0||n>1)throw new Error("t out of bounds [0,1]: "+n);if(e<1)throw new Error("degree must be at least 1 (linear)");if(e>i-1)throw new Error("degree must be less than or equal to point count - 1");if(!r){r=[];for(let m=0;m<i;m++)r[m]=1}if(s){if(s.length!==i+e+1)throw new Error("bad knot vector length")}else{s=[];for(let m=0;m<i+e+1;m++)s[m]=m}const o=[e,s.length-1-e],l=s[o[0]],c=s[o[1]];n=n*(c-l)+l,n=Math.max(n,l),n=Math.min(n,c);let h;for(h=o[0];h<o[1]&&!(n>=s[h]&&n<=s[h+1]);h++);const u=[];for(let m=0;m<i;m++){u[m]=[];for(let y=0;y<a;y++)u[m][y]=t[m][y]*r[m];u[m][a]=r[m]}let d;for(let m=1;m<=e+1;m++)for(let y=h;y>h-e-1+m;y--){d=(n-s[y])/(s[y+e+1-m]-s[y]);for(let b=0;b<a+1;b++)u[y][b]=(1-d)*u[y-1][b]+d*u[y][b]}const p=[];for(let m=0;m<a;m++)p[m]=P0(u[h][m]/u[h][a],-9);return p},j0=(n,e,t,s)=>{s||(s=5);let r,i,a;t<0?(r=Math.atan(-t)*4,i=new D.V2(n[0],n[1]),a=new D.V2(e[0],e[1])):(r=Math.atan(t)*4,i=new D.V2(e[0],e[1]),a=new D.V2(n[0],n[1]));const o=a.sub(i),l=o.length(),c=i.add(o.multiply(.5)),h=Math.abs(l/2/Math.tan(r/2)),u=o.norm();let d;if(r<Math.PI){const R=new D.V2(u.x*Math.cos(Math.PI/2)-u.y*Math.sin(Math.PI/2),u.y*Math.cos(Math.PI/2)+u.x*Math.sin(Math.PI/2));d=c.add(R.multiply(-h))}else{const R=new D.V2(u.x*Math.cos(Math.PI/2)-u.y*Math.sin(Math.PI/2),u.y*Math.cos(Math.PI/2)+u.x*Math.sin(Math.PI/2));d=c.add(R.multiply(h))}const p=Math.atan2(a.y-d.y,a.x-d.x)/Math.PI*180;let m=Math.atan2(i.y-d.y,i.x-d.x)/Math.PI*180;m<p&&(m+=360);const y=a.sub(d).length(),b=Math.floor(p/s)*s+s,x=Math.ceil(m/s)*s-s,g=[];for(let R=b;R<=x;R+=s)g.push(d.add(new D.V2(Math.cos(R/180*Math.PI)*y,Math.sin(R/180*Math.PI)*y)));return t<0&&g.reverse(),g.map(R=>[R.x,R.y])},A0=(n,e)=>n.map(function(t){return[t[0]*Math.cos(e)-t[1]*Math.sin(e),t[1]*Math.cos(e)+t[0]*Math.sin(e)]}),mn=(n,e,t,s,r,i,a)=>{i<r&&(i+=Math.PI*2);let o=[];const l=Math.PI*2/72,c=1e-6;for(let h=r;h<i-c;h+=l)o.push([Math.cos(h)*t,Math.sin(h)*s]);return o.push([Math.cos(i)*t,Math.sin(i)*s]),a&&(o=A0(o,a)),o=o.map(function(h){return[n+h[0],e+h[1]]}),o},Q0=(n,e,t,s,r)=>{const i=[],a=n.map(function(c){return[c.x,c.y]}),o=[t[e]],l=[t[e],t[t.length-1-e]];for(let c=e+1;c<t.length-e;++c)o[o.length-1]!==t[c]&&o.push(t[c]);s=s||25;for(let c=1;c<o.length;++c){const h=o[c-1],u=o[c];for(let d=0;d<=s;++d){let p=(d/s*(u-h)+h-l[0])/(l[1]-l[0]);p=Math.max(p,0),p=Math.min(p,1);const m=_0(p,e,a,t,r);i.push(m)}}return i},O0=n=>{const e=[],t=[];for(const i of n.vertices)if(i.faces){const a={indices:[],hiddens:[]};for(const o of i.faces){if(o===0)break;a.indices.push(o<0?-o-1:o-1),a.hiddens.push(o<0)}[3,4].includes(a.indices.length)&&t.push(a)}else e.push({x:i.x,y:i.y});const s=[],r=(i,a)=>{for(const o of s)if(o.slice(-1)[0]===i)return o.push(a);s.push([i,a])};for(const i of t)for(let a=0;a<i.indices.length;a++){if(i.hiddens[a])continue;const o=(a+1)%i.indices.length;r(i.indices[a],i.indices[o])}for(const i of s)for(const a of s)if(i!==a&&i[0]===a.slice(-1)[0]){a.push(...i.slice(1)),i.splice(0,i.length);break}return s.filter(i=>i.length).map(i=>i.map(a=>e[a]).map(a=>[a.x,a.y]))},Rh=(n,e)=>{e=e||{};let t;if(n.type==="LINE"&&(t=[[n.start.x,n.start.y],[n.end.x,n.end.y]]),n.type==="LWPOLYLINE"||n.type==="POLYLINE"){if(t=[],n.polyfaceMesh)t.push(...O0(n)[0]);else if(!n.polygonMesh&&n.vertices.length){n.closed&&(n.vertices=n.vertices.concat(n.vertices[0]));for(let s=0,r=n.vertices.length;s<r-1;++s){const i=[n.vertices[s].x,n.vertices[s].y],a=[n.vertices[s+1].x,n.vertices[s+1].y];t.push(i),n.vertices[s].bulge&&(t=t.concat(j0(i,a,n.vertices[s].bulge))),s===r-2&&t.push(a)}}}if(n.type==="CIRCLE"&&(t=mn(n.x,n.y,n.r,n.r,0,Math.PI*2),n.extrusionZ===-1&&(t=t.map(function(s){return[-s[0],s[1]]}))),n.type==="ELLIPSE"){const s=Math.sqrt(n.majorX*n.majorX+n.majorY*n.majorY),r=n.axisRatio*s,i=-Math.atan2(-n.majorY,n.majorX);t=mn(n.x,n.y,s,r,n.startAngle,n.endAngle,i),n.extrusionZ===-1&&(t=t.map(function(a){return[-a[0],a[1]]}))}return n.type==="ARC"&&(t=mn(n.x,n.y,n.r,n.r,n.startAngle,n.endAngle,void 0),n.extrusionZ===-1&&(t=t.map(function(s){return[-s[0],s[1]]}))),n.type==="SPLINE"&&(t=Q0(n.controlPoints,n.degree,n.knots,e.interpolationsPerSplineSegment,n.weights)),t||(tt.warn("unsupported entity for converting to polyline:",n.type),[])},Gn=[[0,0,0],[255,0,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[255,0,255],[255,255,255],[65,65,65],[128,128,128],[255,0,0],[255,170,170],[189,0,0],[189,126,126],[129,0,0],[129,86,86],[104,0,0],[104,69,69],[79,0,0],[79,53,53],[255,63,0],[255,191,170],[189,46,0],[189,141,126],[129,31,0],[129,96,86],[104,25,0],[104,78,69],[79,19,0],[79,59,53],[255,127,0],[255,212,170],[189,94,0],[189,157,126],[129,64,0],[129,107,86],[104,52,0],[104,86,69],[79,39,0],[79,66,53],[255,191,0],[255,234,170],[189,141,0],[189,173,126],[129,96,0],[129,118,86],[104,78,0],[104,95,69],[79,59,0],[79,73,53],[255,255,0],[255,255,170],[189,189,0],[189,189,126],[129,129,0],[129,129,86],[104,104,0],[104,104,69],[79,79,0],[79,79,53],[191,255,0],[234,255,170],[141,189,0],[173,189,126],[96,129,0],[118,129,86],[78,104,0],[95,104,69],[59,79,0],[73,79,53],[127,255,0],[212,255,170],[94,189,0],[157,189,126],[64,129,0],[107,129,86],[52,104,0],[86,104,69],[39,79,0],[66,79,53],[63,255,0],[191,255,170],[46,189,0],[141,189,126],[31,129,0],[96,129,86],[25,104,0],[78,104,69],[19,79,0],[59,79,53],[0,255,0],[170,255,170],[0,189,0],[126,189,126],[0,129,0],[86,129,86],[0,104,0],[69,104,69],[0,79,0],[53,79,53],[0,255,63],[170,255,191],[0,189,46],[126,189,141],[0,129,31],[86,129,96],[0,104,25],[69,104,78],[0,79,19],[53,79,59],[0,255,127],[170,255,212],[0,189,94],[126,189,157],[0,129,64],[86,129,107],[0,104,52],[69,104,86],[0,79,39],[53,79,66],[0,255,191],[170,255,234],[0,189,141],[126,189,173],[0,129,96],[86,129,118],[0,104,78],[69,104,95],[0,79,59],[53,79,73],[0,255,255],[170,255,255],[0,189,189],[126,189,189],[0,129,129],[86,129,129],[0,104,104],[69,104,104],[0,79,79],[53,79,79],[0,191,255],[170,234,255],[0,141,189],[126,173,189],[0,96,129],[86,118,129],[0,78,104],[69,95,104],[0,59,79],[53,73,79],[0,127,255],[170,212,255],[0,94,189],[126,157,189],[0,64,129],[86,107,129],[0,52,104],[69,86,104],[0,39,79],[53,66,79],[0,63,255],[170,191,255],[0,46,189],[126,141,189],[0,31,129],[86,96,129],[0,25,104],[69,78,104],[0,19,79],[53,59,79],[0,0,255],[170,170,255],[0,0,189],[126,126,189],[0,0,129],[86,86,129],[0,0,104],[69,69,104],[0,0,79],[53,53,79],[63,0,255],[191,170,255],[46,0,189],[141,126,189],[31,0,129],[96,86,129],[25,0,104],[78,69,104],[19,0,79],[59,53,79],[127,0,255],[212,170,255],[94,0,189],[157,126,189],[64,0,129],[107,86,129],[52,0,104],[86,69,104],[39,0,79],[66,53,79],[191,0,255],[234,170,255],[141,0,189],[173,126,189],[96,0,129],[118,86,129],[78,0,104],[95,69,104],[59,0,79],[73,53,79],[255,0,255],[255,170,255],[189,0,189],[189,126,189],[129,0,129],[129,86,129],[104,0,104],[104,69,104],[79,0,79],[79,53,79],[255,0,191],[255,170,234],[189,0,141],[189,126,173],[129,0,96],[129,86,118],[104,0,78],[104,69,95],[79,0,59],[79,53,73],[255,0,127],[255,170,212],[189,0,94],[189,126,157],[129,0,64],[129,86,107],[104,0,52],[104,69,86],[79,0,39],[79,53,66],[255,0,63],[255,170,191],[189,0,46],[189,126,141],[129,0,31],[129,86,96],[104,0,25],[104,69,78],[79,0,19],[79,53,59],[51,51,51],[80,80,80],[105,105,105],[130,130,130],[190,190,190],[255,255,255]],D0=(n,e)=>{const t=n[e.layer];if(t){const s="colorNumber"in e&&e.colorNumber!==256?e.colorNumber:t.colorNumber;return Gn[s]||[0,0,0]}else return tt.warn("no layer table for layer:"+e.layer),[0,0,0]},yc=(n,e)=>({x:n.x*Math.cos(e)-n.y*Math.sin(e),y:n.y*Math.cos(e)+n.x*Math.sin(e)}),q0=n=>n[0]===255&&n[1]===255&&n[2]===255?"rgb(0, 0, 0)":`rgb(${n[0]}, ${n[1]}, ${n[2]})`,$0=(n,e,t,s)=>{const r=t,i=e,a=e.length;let o=0,l=!1;for(let d=0;d<a+n;d++)if(s>r[d]&&s<=r[d+1]){o=d,l=!0;break}if(!l)throw new Error("invalid new knot");const c=[];for(let d=0;d<a+n+1;d++)d<=o?c[d]=r[d]:d===o+1?c[d]=s:c[d]=r[d-1];let h;const u=[];for(let d=0;d<a+1;d++)d<=o-n+1?h=1:o-n+2<=d&&d<=o?r[d+n-1]-r[d]===0?h=0:h=(s-r[d])/(r[d+n-1]-r[d]):h=0,h===0?u[d]=i[d-1]:h===1?u[d]=i[d]:u[d]={x:(1-h)*i[d-1].x+h*i[d].x,y:(1-h)*i[d-1].y+h*i[d].y};return{controlPoints:u,knots:c}},em=(n,e)=>{for(let t=1;t<n;++t)if(e[t]!==e[0])throw Error(`not pinned. order: ${n} knots: ${e}`);for(let t=e.length-2;t>e.length-n-1;--t)if(e[t]!==e[e.length-1])throw Error(`not pinned. order: ${n} knots: ${e}`)},Zh=(n,e)=>{let t=1;for(let s=e+1;s<n.length&&n[s]===n[e];++s)++t;return t},tm=(n,e)=>{const t=[];let s=n;for(;s<e.length-n;){const r=e[s],i=Zh(e,s);for(let a=0;a<n-i-1;++a)t.push(r);s=s+i}return t},sm=(n,e,t)=>(em(n,t),tm(n,t).reduce((s,r)=>$0(n,s.controlPoints,s.knots,r),{controlPoints:e,knots:t})),Jt=(n,e,t)=>{let s="";const r=t.map(a=>{const o=a.x||0,l=a.y||0,c=a.scaleX||1,h=a.scaleY||1,u=(a.rotation||0)/180*Math.PI,{cos:d,sin:p}=Math;let m,y,b,x,g,R;return a.extrusionZ===-1?(m=-c*d(u),y=c*p(u),b=h*p(u),x=h*d(u),g=-o,R=l):(m=c*d(u),y=c*p(u),b=-h*p(u),x=h*d(u),g=o,R=l),[m,y,b,x,g,R]});let i=new D.Box2;if(n.valid){let a=[{x:n.min.x,y:n.min.y},{x:n.max.x,y:n.min.y},{x:n.max.x,y:n.max.y},{x:n.min.x,y:n.max.y}];r.forEach(([o,l,c,h,u,d])=>{a=a.map(p=>({x:p.x*o+p.y*c+u,y:p.x*l+p.y*h+d}))}),i=a.reduce((o,l)=>o.expandByPoint(l),new D.Box2)}return r.reverse(),r.forEach(([a,o,l,c,h,u])=>{s+=`<g transform="matrix(${a} ${o} ${l} ${c} ${h} ${u})">`}),s+=e,r.forEach(a=>{s+="</g>"}),{bbox:i,element:s}},On=(n,{bbox:e,element:t})=>n.extrusionZ===-1?{bbox:new D.Box2().expandByPoint({x:-e.min.x,y:e.min.y}).expandByPoint({x:-e.max.x,y:e.max.y}),element:`<g transform="matrix(-1 0 0 1 0 0)">
        ${t}
      </g>`}:{bbox:e,element:t},yn=n=>{const e=Rh(n),t=e.reduce((r,[i,a])=>r.expandByPoint({x:i,y:a}),new D.Box2),s=e.reduce((r,i,a)=>(r+=a===0?"M":"L",r+=i[0]+","+i[1],r),"");return Jt(t,`<path d="${s}" />`,n.transforms)},rm=n=>{const e=new D.Box2().expandByPoint({x:n.x+n.r,y:n.y+n.r}).expandByPoint({x:n.x-n.r,y:n.y-n.r}),t=`<circle cx="${n.x}" cy="${n.y}" r="${n.r}" />`,{bbox:s,element:r}=On(n,{bbox:e,element:t});return Jt(s,r,n.transforms)},Gh=(n,e,t,s,r,i,a,o)=>{const l=Math.sqrt(t*t+s*s),c=r*l,h=-Math.atan2(-s,t),u=im(n,e,t,s,r,i,a);if(Math.abs(i-a)<1e-9||Math.abs(i-a+Math.PI*2)<1e-9){const d=`<g transform="rotate(${h/Math.PI*180} ${n}, ${e})">
      <ellipse cx="${n}" cy="${e}" rx="${l}" ry="${c}" />
    </g>`;return{bbox:u,element:d}}else{const d=yc({x:Math.cos(i)*l,y:Math.sin(i)*c},h),p={x:n+d.x,y:e+d.y},m=yc({x:Math.cos(a)*l,y:Math.sin(a)*c},h),y={x:n+m.x,y:e+m.y},b=(a<i?a+Math.PI*2:a)-i<Math.PI?0:1,x=`<path d="${`M ${p.x} ${p.y} A ${l} ${c} ${h/Math.PI*180} ${b} 1 ${y.x} ${y.y}`}" />`;return{bbox:u,element:x}}},im=(n,e,t,s,r,i,a,o)=>{for(;i<0;)i+=Math.PI*2;for(;a<=i;)a+=Math.PI*2;const l=[];if(Math.abs(t)<1e-12||Math.abs(s)<1e-12)for(let u=0;u<4;u++)l.push(u/2*Math.PI);else l[0]=Math.atan(-s*r/t)-Math.PI,l[1]=Math.atan(t*r/s)-Math.PI,l[2]=l[0]-Math.PI,l[3]=l[1]-Math.PI;for(let u=4;u>=0;u--){for(;l[u]<i;)l[u]+=Math.PI*2;l[u]>a&&l.splice(u,1)}l.push(i),l.push(a);const c=l.map(u=>({x:Math.cos(u),y:Math.sin(u)})),h=[[t,-s*r],[s,t*r]];return c.map(u=>({x:u.x*h[0][0]+u.y*h[0][1]+n,y:u.x*h[1][0]+u.y*h[1][1]+e})).reduce((u,d)=>(u.expandByPoint(d),u),new D.Box2)},nm=n=>{const{bbox:e,element:t}=Gh(n.x,n.y,n.majorX,n.majorY,n.axisRatio,n.startAngle,n.endAngle),{bbox:s,element:r}=On(n,{bbox:e,element:t});return Jt(s,r,n.transforms)},am=n=>{const{bbox:e,element:t}=Gh(n.x,n.y,n.r,0,1,n.startAngle,n.endAngle,n.extrusionZ===-1),{bbox:s,element:r}=On(n,{bbox:e,element:t});return Jt(s,r,n.transforms)},om=(n,e,t)=>{const s=[];let r=0,i=n;for(;i<e.length-n+1;){const a=Zh(e,i),o=t.slice(r,r+n);n===4?s.push(`<path d="M ${o[0].x} ${o[0].y} C ${o[1].x} ${o[1].y} ${o[2].x} ${o[2].y} ${o[3].x} ${o[3].y}" />`):n===3&&s.push(`<path d="M ${o[0].x} ${o[0].y} Q ${o[1].x} ${o[1].y} ${o[2].x} ${o[2].y}" />`),r+=a,i+=a}return s},lm=n=>{let e=new D.Box2;n.controlPoints.forEach(i=>{e=e.expandByPoint(i)});const t=n.degree+1,s=sm(t,n.controlPoints,n.knots),r=`<g>${om(t,s.knots,s.controlPoints).join("")}</g>`;return Jt(e,r,n.transforms)},cm=n=>{switch(n.type){case"CIRCLE":return rm(n);case"ELLIPSE":return nm(n);case"ARC":return am(n);case"SPLINE":{const e=n.weights&&n.weights.some(t=>t!==1);if((n.degree===2||n.degree===3)&&!e)try{return lm(n)}catch{return yn(n)}else return yn(n)}case"LINE":case"LWPOLYLINE":case"POLYLINE":return yn(n);default:return tt.warn("entity type not supported in SVG rendering:",n.type),null}},hm=n=>{const e=Qn(n),{bbox:t,elements:s}=e.reduce((i,a,o)=>{const l=D0(n.tables.layers,a),c=cm(a);if(c){const{bbox:h,element:u}=c;h.valid&&(i.bbox.expandByPoint(h.min),i.bbox.expandByPoint(h.max)),i.elements.push(`<g stroke="${q0(l)}">${u}</g>`)}return i},{bbox:new D.Box2,elements:[]}),r=t.valid?{x:t.min.x,y:-t.max.y,width:t.max.x-t.min.x,height:t.max.y-t.min.y}:{x:0,y:0,width:0,height:0};return`<?xml version="1.0"?>
<svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
  preserveAspectRatio="xMinYMin meet"
  viewBox="${r.x} ${r.y} ${r.width} ${r.height}"
  width="100%" height="100%"
>
  <g stroke="#000000" stroke-width="0.1%" fill="none" transform="matrix(1,0,0,-1,0,0)">
    ${s.join(`
`)}
  </g>
</svg>`},um=(n,e)=>(e.forEach(t=>{n=n.map(function(s){let r=[s[0],s[1]];if(t.scaleX&&(r[0]=r[0]*t.scaleX),t.scaleY&&(r[1]=r[1]*t.scaleY),t.rotation){const i=t.rotation/180*Math.PI;r=[r[0]*Math.cos(i)-r[1]*Math.sin(i),r[1]*Math.cos(i)+r[0]*Math.sin(i)]}return t.x&&(r[0]=r[0]+t.x),t.y&&(r[1]=r[1]+t.y),t.extrusionZ===-1&&(r[0]=-r[0]),r})}),n),dm=n=>{const e=Qn(n).map(s=>{const r=n.tables.layers[s.layer];let i=0;return"colorNumber"in s?i=s.colorNumber:r&&(i=r.colorNumber),Gn[i]===void 0&&(i=0),{rgb:Gn[i],layer:r,vertices:um(Rh(s),s.transforms)}}),t=new D.Box2;return e.forEach(s=>{s.vertices.forEach(r=>{t.expandByPoint({x:r[0],y:r[1]})})}),{bbox:t,polylines:e}},pm=n=>n.reduce((e,t)=>{const s=t.layer;return e[s]||(e[s]=[]),e[s].push(t),e},{});class mm{constructor(e){if(typeof e!="string")throw Error("Helper constructor expects a DXF string");this._contents=e,this._parsed=null,this._denormalised=null}parse(){return this._parsed=Mp(this._contents),tt.info("parsed:",this.parsed),this._parsed}get parsed(){return this._parsed===null&&this.parse(),this._parsed}denormalise(){return this._denormalised=Qn(this.parsed),tt.info("denormalised:",this._denormalised),this._denormalised}get denormalised(){return this._denormalised||this.denormalise(),this._denormalised}group(){this._groups=pm(this.denormalised)}get groups(){return this._groups||this.group(),this._groups}toSVG(){return hm(this.parsed)}toPolylines(){return dm(this.parsed)}}class bm extends Ws{constructor(){super(),this._cache=new Map,this.useCache=!1,this.colorHelper=new Wn,this.LayerHelper=new zc}async getFromFile(e,t){let s=URL.createObjectURL(e);return await this.getFromPath(s,t)}async getFromPath(e,t){if(await this._loadFont(t),!this._font)return null;let s=this._fromCache(e);if(s)return this._drawDXF(s.data?s.data:s);await this.trigger("progress","Fetching file ...");let r=await fetch(e);if(r.status!==200)return null;let i=await r.text();await this.trigger("progress","Parsing file ...");let a=new mm(i),o=a.parse();return await this.trigger("progress","Drawing file ..."),this.lastDXF=o,a._parsed=null,a=null,r=null,i=null,this.lastDXF.tables.layers=this.LayerHelper.parse(this.lastDXF.tables.layers),this.layers=this.lastDXF.tables.layers,this.unit=this.lastDXF.header?this.lastDXF.header.insUnits:0,await this._drawDXF(this.lastDXF)}async _drawDXF(e){let t=new ne;t.name="DXFViewer",this.useCache||(K.cache=!1);let s=new Is(e);s.subscribe("log",async d=>await this._log("LineEntity",d));let r=new Tc(e);r.subscribe("log",async d=>await this._log("CircleEntity",d));let i=new Nn(e);i.subscribe("log",async d=>await this._log("SplineEntity",d));let a=new Un(e);a.subscribe("log",async d=>await this._log("SolidEntity",d));let o=new Zd(e,this._font);o.subscribe("log",async d=>await this._log("DimensionEntity",d));let l=new De(e,this._font);l.subscribe("log",async d=>await this._log("TextEntity",d));let c=new Uc(e,this._font);c.subscribe("log",async d=>await this._log("Ole2FrameEntity",d));let h=new Fc(e,this._font);h.subscribe("log",async d=>await this._log("InsertEntity",d));let u=new Ic(e,this._font);return u.subscribe("log",async d=>await this._log("HatchEntity",d)),K.onBeforeTextDraw=this.onBeforeTextDraw,s=s.draw(e),r=r.draw(e),i=i.draw(e),a=a.draw(e),o=await o.draw(e),l=l.draw(e),c=await c.draw(e),h=await h.draw(e,e),u=u.draw(e,d=>{const p=[],m=y=>{y.forEach(b=>{d.includes(b.userData.entity.handle)&&p.push(b)})};return s&&m(s.children),r&&m(r.children),i&&m(i.children),a&&m(a.children),o&&m(o.children),l&&m(l.children),c&&m(c.children),h&&m(h.children),p}),s&&t.add(s),r&&t.add(r),i&&t.add(i),a&&t.add(a),o&&t.add(o),l&&t.add(l),c&&t.add(c),h&&t.add(h),u&&t.add(u),this._rotateByView(t,e),t}_toCache(e,t){this._cache.set(this._replaceEspecialChars(e),new WeakRef(t))}_fromCache(e){const t=this._replaceEspecialChars(e);if(this._cache.has(t)){const s=this._cache.get(t).deref();if(s!==void 0)return s}return null}_replaceEspecialChars(e){return e.replaceAll("/","").replaceAll(".","").replaceAll("_","").replaceAll("-","")}async _loadFont(e){if(!this._font)try{this._font=await new Promise((t,s)=>{new Ju().load(e,t,null,s)})}catch(t){await this.trigger("error",t),this._font=null}}_rotateByView(e,t){let s=t.objects&&t.objects.layouts?t.objects.layouts.find(i=>i.name.toLowerCase()==="model"):null;if(!s)return;let r=Object.keys(t.tables.vports);for(let i=0;i<r.length;i++){let a=t.tables.vports[r[i]];if(a.handle===s.lastActiveViewport&&a.angle!==0){e.rotateOnAxis(new f(0,0,1),a.angle*Math.PI/180);return}}}async _log(e,t){await this.trigger("log",`${e}: ${t}`)}get DefaultTextHeight(){return De.TextHeight}set DefaultTextHeight(e){De.TextHeight=e}get DefaultTextScale(){return De.TextScale}set DefaultTextScale(e){De.TextScale=e}}class bc{constructor(){this.snaps=[],this.min=new f(1/0,1/0,1/0),this.max=new f(-1/0,-1/0,-1/0),this.cuts=5,this.voxel=null,this.decimals=6}process(e){e=e instanceof Array?e:[e],this._getSnaps(e,!0,!1),this._getSize(e),this.voxel=this._generateVoxels(this.min,this.max,1)[0],this.snaps.forEach(t=>this._addPointToVoxel(t,this.voxel.voxels))}findVoxel(e,t=null){let s={x:Number(e.x.toFixed(this.decimals)),y:Number(e.y.toFixed(this.decimals)),z:Number(e.z.toFixed(this.decimals))};t=t||this.voxel.voxels;for(let r=0;r<t.length;r++){let i=t[r];if(i.min.x<=s.x&&s.x<=i.max.x&&i.min.y<=s.y&&s.y<=i.max.y&&i.min.z<=s.z&&s.z<=i.max.z)return i.voxels.length>0?this.findVoxel(e,i.voxels):i}return null}_getSnaps(e,t=!0,s=!0){for(let r=0;r<e.length;r++)e[r].traverse(i=>{if(t&&(i.isLine||i.isLineSegments)||s&&i.isMesh){i.updateWorldMatrix(!0,!1);for(let a=0;a<i.geometry.attributes.position.count;a++)this.snaps.push({entity:i,point:new f(i.geometry.attributes.position.getX(a),i.geometry.attributes.position.getY(a),i.geometry.attributes.position.getZ(a)).applyMatrix4(i.matrixWorld)})}})}_generateVoxels(e,t,s){if(s===this.cuts)return[];let r=[],i=t.clone().sub(e).multiplyScalar(1/s);for(let a=0;a<s;a++)for(let o=0;o<s;o++)for(let l=0;l<s;l++){let c={name:"VOXEL_"+a+"_"+o+"_"+l,min:new f(e.x+a*i.x,e.y+o*i.y,e.z+l*i.z),max:new f(e.x+(a+1)*i.x,e.y+(o+1)*i.y,e.z+(l+1)*i.z),snaps:[]};c.voxels=this._generateVoxels(c.min,c.max,s+1),r.push(c)}return r}_addPointToVoxel(e,t){for(let s=0;s<t.length;s++){let r=t[s];if(r.min.x<=e.point.x&&e.point.x<=r.max.x&&r.min.y<=e.point.y&&e.point.y<=r.max.y&&r.min.z<=e.point.z&&e.point.z<=r.max.z){r.voxels.length===0?r.snaps.push(e):this._addPointToVoxel(e,r.voxels);return}}}_getSize(e){e.forEach(t=>{let s=new Ze().setFromObject(t);this.min.set(Math.min(this.min.x,s.min.x),Math.min(this.min.y,s.min.y),Math.min(this.min.z,s.min.z)),this.max.set(Math.max(this.max.x,s.max.x),Math.max(this.max.y,s.max.y),Math.max(this.max.z,s.max.z))})}clear(){this.snaps.length=0,this.min=null,this.max=null,this.voxel=null}}class xm extends Ws{constructor(e,t,s,r,i){super(),this.container=t.domElement,this.scene=s,this.camera=r,this.controls=i,this.snaps=new bc,this.snaps.process(e),this._mouseDownEvent=a=>{this._mouseDown(a)},this._mouseUpEvent=a=>{this._mouseUp(a)},this._mouseMoveEvent=a=>{this._mouseMove(a)},this.container.addEventListener("pointerdown",this._mouseDownEvent),this.container.addEventListener("pointerup",this._mouseUpEvent),this.container.addEventListener("pointermove",this._mouseMoveEvent),this.raycaster=new Xc,this.mouse=new w,this.plane=new iu,this.planeNormal=new f,this.mousePos=new f,this.vectorHelper=new f,document.addEventListener("wheel",()=>{this._changeSquareSize=!0})}_mouseDown(){}_mouseUp(){}async _mouseMove(e){if(this.snaps){e.mousePosInScene=this._getMousePosInScene(e);let t={x:e.mousePosInScene.x,y:e.mousePosInScene.y,z:e.mousePosInScene.z},s=this.snaps.findVoxel(t);if(s){let r=this._findNearestSnapPoint(t,s);if(!r.snap){this._hideSnapSquare();return}r.distance<5?(e.mousePosInScene={x:r.snap.point.x,y:r.snap.point.y,z:r.snap.point.z},await this._showSnapSquare(r)):this._hideSnapSquare()}}}resetSnaps(){this._clearSnapSquare(),this.snaps=new bc,this.snaps.process(this.__cache.meshes)}_findNearestSnapPoint(e,t){let s={snap:null,distance:1/0};for(let r=0;r<t.snaps.length;r++){const i=t.snaps[r];let a=i.point.distanceTo(e);a<s.distance&&(s.snap=i,s.distance=a)}return s}_hideSnapSquare(){this._snapSquare&&(this._snapSquare.visible=!1)}async _showSnapSquare(e){if(!this._snapSquare||this._changeSquareSize){this._clearSnapSquare();let t=this._getSize();this._snapSquare=new ge(new Mn(t,t,t),new Ls({color:16753920,wireframe:!0})),this._snapSquare.visible=!1,this._snapSquare.initial=!0,this.scene.add(this._snapSquare)}this._snapSquare.position.copy(e.snap.point),this._snapSquare.visible=!0,await this.trigger("nearSnap",e)}_getSize(){const e={width:this.camera.right/this.camera.zoom-this.camera.left/this.camera.zoom,height:this.camera.top/this.camera.zoom-this.camera.bottom/this.camera.zoom};return delete this._changeSquareSize,Math.max(e.width,e.height)/100}_getMousePosInScene(e){let t=e.currentTarget,s=this.camera.position.distanceTo(this.controls.target);this.mouse.x=e.offsetX/t.offsetWidth*2-1,this.mouse.y=-(e.offsetY/t.offsetHeight)*2+1,this.planeNormal.copy(this.camera.getWorldDirection(this.vectorHelper));let r=this.camera.position.clone();return r.add(this.planeNormal.multiplyScalar(s)),this.plane.setFromNormalAndCoplanarPoint(this.planeNormal,r),this.raycaster.setFromCamera(this.mouse,this.camera),this.raycaster.ray.intersectPlane(this.plane,this.mousePos),this.mousePos}clear(){this._clearSnapSquare(),this.snaps.clear(),this.container.removeEventListener("pointerdown",this._mouseDownEvent),this.container.removeEventListener("pointerup",this._mouseUpEvent),this.container.removeEventListener("pointermove",this._mouseMoveEvent),this.snaps=null,this.container=null,this.scene=null,this.camera=null,this.controls=null,this.raycaster=null,this.mouse=null,this.plane=null,this.planeNormal=null,this.mousePos=null,this.vectorHelper=null}_clearSnapSquare(){this._snapSquare&&(this._snapSquare.parent&&this._snapSquare.parent.remove(this._snapSquare),this._snapSquare.geometry.dispose(),this._snapSquare.material.dispose(),this._snapSquare=null)}}class ym{constructor(e,t,s){this.camera=t,this.container=e,this.raycaster=new Xc,this._calculateThreshold(),this.targets=s,this.container.addEventListener("wheel",()=>{this._calculateThreshold()})}raycast(e){this.raycaster.setFromCamera(e,this.camera);const t=this.raycaster.intersectObjects(this.targets,!0);return t.length===0?null:t[0]}_calculateThreshold(){const e={width:this.camera.right/this.camera.zoom-this.camera.left/this.camera.zoom,height:this.camera.top/this.camera.zoom-this.camera.bottom/this.camera.zoom},t=Math.min(e.width,e.height);this.raycaster.params.Line.threshold=t/500}}class Dn extends Ws{constructor(){super()}_initRaycasting(e,t,s,r){const i=[];s.traverse(a=>{a.geometry&&i.push(a)}),this.pointer=new w,this.raycast=r||new ym(e,t,i)}_clone(e){const t={};e.traverse(r=>{t[r.uuid]=r.userData,r.userData=null});const s=e.clone();return e.traverse(r=>{r.userData=t[r.uuid]}),s}_setMaterial(e){const t=new Ls({depthTest:!1,depthWrite:!1});return t.color.setHex(e),t.color.convertSRGBToLinear(),t}_isInsideEntityList(e){const t=e.userData.entity;return t?this.dxf.entities.find(s=>s===t||s.block===t.name):!1}}class fm extends Dn{constructor(e,t,s,r,i=null){super(),this.container=e,this._clonedObjects={},this.dxf3d=s,this.dxf=r,this._initRaycasting(e,t,s,i),this._material=this._setMaterial(16753920),this.container.addEventListener("pointermove",async a=>await this._onPointerMove(a),!1)}async _onPointerMove(e){e.preventDefault();let t=e.target.getBoundingClientRect();const s=e.clientX-t.left,r=e.clientY-t.top;this.pointer.x=s/this.container.clientWidth*2-1,this.pointer.y=-(r/this.container.clientHeight)*2+1;const i=this.raycast.raycast(this.pointer);if(this.removeHover(),i){const a=this._isInsideEntityList(i.object)?i.object:i.object.parent;if(!a.userData)return;this.hover(a),await this.trigger("hover",a)}}hover(e,t=null){let s=null,r=e.parent;for(;s===null&&r!==null;)r.name==="DIMENSION"&&(s=r),r=r.parent;s&&(e=s),this._clonedObjects[e.uuid]||(this._clonedObjects[e.uuid]={clone:this._clone(e),parent:e.parent});const i=this._clonedObjects[e.uuid];i.clone.hovered=!0,i.clone.traverse(a=>{a.material&&(a.material=t||this._material)}),this._hovered=i.clone,i.parent.add(this._hovered)}removeHover(){this._hovered&&this._hovered.parent&&(this._hovered.parent.remove(this._hovered),this._hovered=null)}}class gm extends Dn{constructor(e,t,s,r,i=null){super(),this.container=e,this.camera=t,this.dxf3d=s,this.dxf=r,this._initRaycasting(e,t,s,i),this._material=this._setMaterial(255),this.selecteds=[],this._boxHelpers={start3dpoint:new f,end3dpoint:new f,boxMin:new f,boxMax:new f},this._isMouseDown=!1,this._isMouseMoving=!1,this.container.addEventListener("pointerdown",async a=>await this._onPointerDown(a),!1),this.container.addEventListener("pointerup",async a=>await this._onPointerUp(a),!1),this.container.addEventListener("pointermove",async a=>await this._onPointerMove(a),!1)}async _onPointerDown(e){if(e.button===0&&(this._isMouseDown=!0,e.ctrlKey)){let t=e.target.getBoundingClientRect();const s=e.clientX-t.left,r=e.clientY-t.top;this._onSelectionBox={start:{x:s,y:r},end:{x:s,y:r}}}}async _onPointerUp(e){if(this._isMouseDown=!1,this._isMouseMoving){this._isMouseMoving=!1;return}if(e.button!==0)return;e.preventDefault(),this.deselectAll();let t=null;if(this._onSelectionBox){const s=this._getEntitiesUnderSelectionBox(this._onSelectionBox.start,this._onSelectionBox.end);s&&(t=s)}else{let s=e.target.getBoundingClientRect();const r=e.clientX-s.left,i=e.clientY-s.top;this.pointer.x=r/this.container.clientWidth*2-1,this.pointer.y=-(i/this.container.clientHeight)*2+1;const a=await this.raycast.raycast(this.pointer);a&&(t=this._isInsideEntityList(a.object)?a.object:a.object.parent)}t&&(this.select(t),await this.trigger("select",t)),this._removeSelectionBox(),this._onSelectionBox=null}async _onPointerMove(e){if(this._onSelectionBox){let t=e.target.getBoundingClientRect();const s=e.clientX-t.left,r=e.clientY-t.top;this._onSelectionBox.end={x:s,y:r},this.drawSelectionBox(this._onSelectionBox.start,this._onSelectionBox.end,t);return}this._isMouseDown&&(this._isMouseMoving=!0)}drawSelectionBox(e,t,s){this._removeSelectionBox();const r=Math.max(e.x,t.x)-Math.min(e.x,t.x),i=Math.max(e.y,t.y)-Math.min(e.y,t.y);this._selectionBox=document.createElement("div"),this._selectionBox.style.position="absolute",this._selectionBox.style.border="1px solid white",this._selectionBox.style.left=Math.min(e.x,t.x)+s.left+"px",this._selectionBox.style.top=Math.min(e.y,t.y)+s.top+"px",this._selectionBox.style.width=r+"px",this._selectionBox.style.height=i+"px",this._selectionBox.style.pointerEvents="none",this._selectionBox.style.background="blue",this._selectionBox.style.opacity=.25,document.body.appendChild(this._selectionBox)}_removeSelectionBox(){this._selectionBox&&(document.body.removeChild(this._selectionBox),this._selectionBox=null)}_getEntitiesUnderSelectionBox(e,t){e.x=e.x/this.container.clientWidth*2-1,e.y=-(e.y/this.container.clientHeight)*2+1,t.x=t.x/this.container.clientWidth*2-1,t.y=-(t.y/this.container.clientHeight)*2+1,this._boxHelpers.start3dpoint=new f(e.x,e.y,0).unproject(this.camera),this._boxHelpers.end3dpoint=new f(t.x,t.y,0).unproject(this.camera),this._boxHelpers.boxMin.set(Math.min(this._boxHelpers.start3dpoint.x,this._boxHelpers.end3dpoint.x),Math.min(this._boxHelpers.start3dpoint.y,this._boxHelpers.end3dpoint.y),0),this._boxHelpers.boxMax.set(Math.max(this._boxHelpers.start3dpoint.x,this._boxHelpers.end3dpoint.x),Math.max(this._boxHelpers.start3dpoint.y,this._boxHelpers.end3dpoint.y),0);const s=new Ze(this._boxHelpers.boxMin,this._boxHelpers.boxMax),r=this._getBlocksUnderBox(s,this.dxf3d);return r.length>0?r:null}_getBlocksUnderBox(e,t){const s=[];if(!t||!t.children)return s;if(this._fitInsideBox(e,t)){let r=[];return this._getInsideElements(t,r),s.push(...r),s}for(let r=0;r<t.children.length;r++){const i=t.children[r],a=this._getBlocksUnderBox(e,i);for(let o=0;o<a.length;o++){let l=[];this._getInsideElements(a[o],l),l.length>0&&s.push(...l)}}return s}_getInsideElements(e,t){if(this._isInsideEntityList(e)){t.push(e);return}if(!(!e.children||e.children.length===0))for(let s=0;s<e.children.length;s++)this._getInsideElements(e.children[s],t)}_fitInsideBox(e,t){let s=new Ze().setFromObject(t);return e.containsBox(s)}select(e,t=null){(e instanceof Array?e:[e]).forEach(s=>{let r=null,i=s.parent;for(;r===null&&i!==null;)i.name==="DIMENSION"&&(r=i),i=i.parent;r&&(s=r);const a=this._clone(s);a.selected=!0,a.traverse(o=>{o.material&&(o.material=t||this._material)}),s.parent.add(a),this.selecteds.push(a)})}deselectAll(){this.selecteds&&(this.selecteds.forEach(e=>e.parent.remove(e)),this.selecteds.length=0)}}class Rm extends Dn{constructor(e,t,s,r,i=null){super(),this.container=e,this.camera=t,this.dxf3d=s,this.dxf=r,this._initRaycasting(e,this.camera,s,i),this._material=this._setMaterial(255),this._materialHover=this._setMaterial(16753920),this._clonedObjects={},this.selecteds=[],this._boxHelpers={start3dpoint:new f,end3dpoint:new f,boxMin:new f,boxMax:new f},this._isMouseDown=!1,this._isMouseMoving=!1,this.container.addEventListener("pointerdown",async a=>await this._onPointerDown(a),!1),this.container.addEventListener("pointerup",async a=>await this._onPointerUp(a),!1),this.container.addEventListener("pointermove",async a=>await this._onPointerMove(a),!1)}async _onPointerDown(e){if(e.button===0&&(this._isMouseDown=!0,e.ctrlKey)){let t=e.target.getBoundingClientRect();const s=e.clientX-t.left,r=e.clientY-t.top;this._onSelectionBox={start:{x:s,y:r},end:{x:s,y:r}}}}async _onPointerUp(e){if(this._isMouseDown=!1,this._isMouseMoving){this._isMouseMoving=!1;return}if(e.button!==0)return;e.preventDefault(),this.deselectAll();let t=null;if(this._onSelectionBox){const s=this._getEntitiesUnderSelectionBox(this._onSelectionBox.start,this._onSelectionBox.end);s&&(t=s)}else{let s=e.target.getBoundingClientRect();const r=e.clientX-s.left,i=e.clientY-s.top;this.pointer.x=r/this.container.clientWidth*2-1,this.pointer.y=-(i/this.container.clientHeight)*2+1;const a=await this.raycast.raycast(this.pointer);a&&(t=this._isInsideEntityList(a.object)?a.object:a.object.parent)}t&&(this.select(t),await this.trigger("select",t)),this._removeSelectionBox(),this._onSelectionBox=null}async _onPointerMove(e){e.preventDefault();const t=e.target.getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top;if(this._onSelectionBox){this._onSelectionBox.end={x:s,y:r},this.drawSelectionBox(this._onSelectionBox.start,this._onSelectionBox.end,t);return}this._isMouseDown&&(this._isMouseMoving=!0),this.pointer.x=s/this.container.clientWidth*2-1,this.pointer.y=-(r/this.container.clientHeight)*2+1;const i=this.raycast.raycast(this.pointer);if(this.removeHover(),i){const a=this._isInsideEntityList(i.object)?i.object:i.object.parent;if(!a.userData)return;this.hover(a),await this.trigger("hover",a)}}drawSelectionBox(e,t,s){this._removeSelectionBox();const r=Math.max(e.x,t.x)-Math.min(e.x,t.x),i=Math.max(e.y,t.y)-Math.min(e.y,t.y);this._selectionBox=document.createElement("div"),this._selectionBox.style.position="absolute",this._selectionBox.style.border="1px solid white",this._selectionBox.style.left=Math.min(e.x,t.x)+s.left+"px",this._selectionBox.style.top=Math.min(e.y,t.y)+s.top+"px",this._selectionBox.style.width=r+"px",this._selectionBox.style.height=i+"px",this._selectionBox.style.pointerEvents="none",this._selectionBox.style.background="blue",this._selectionBox.style.opacity=.25,document.body.appendChild(this._selectionBox)}_removeSelectionBox(){this._selectionBox&&(document.body.removeChild(this._selectionBox),this._selectionBox=null)}_getEntitiesUnderSelectionBox(e,t){e.x=e.x/this.container.clientWidth*2-1,e.y=-(e.y/this.container.clientHeight)*2+1,t.x=t.x/this.container.clientWidth*2-1,t.y=-(t.y/this.container.clientHeight)*2+1,this._boxHelpers.start3dpoint=new f(e.x,e.y,0).unproject(this.camera),this._boxHelpers.end3dpoint=new f(t.x,t.y,0).unproject(this.camera),this._boxHelpers.boxMin.set(Math.min(this._boxHelpers.start3dpoint.x,this._boxHelpers.end3dpoint.x),Math.min(this._boxHelpers.start3dpoint.y,this._boxHelpers.end3dpoint.y),0),this._boxHelpers.boxMax.set(Math.max(this._boxHelpers.start3dpoint.x,this._boxHelpers.end3dpoint.x),Math.max(this._boxHelpers.start3dpoint.y,this._boxHelpers.end3dpoint.y),0);const s=new Ze(this._boxHelpers.boxMin,this._boxHelpers.boxMax),r=this._getBlocksUnderBox(s,this.dxf3d);return r.length>0?r:null}_getBlocksUnderBox(e,t){const s=[];if(!t||!t.children)return s;if(this._fitInsideBox(e,t)){let r=[];return this._getInsideElements(t,r),s.push(...r),s}for(let r=0;r<t.children.length;r++){const i=t.children[r],a=this._getBlocksUnderBox(e,i);for(let o=0;o<a.length;o++){let l=[];this._getInsideElements(a[o],l),l.length>0&&s.push(...l)}}return s}_fitInsideBox(e,t){let s=new Ze().setFromObject(t);return e.containsBox(s)}_getInsideElements(e,t){if(this._isInsideEntityList(e)){t.push(e);return}if(!(!e.children||e.children.length===0))for(let s=0;s<e.children.length;s++)this._getInsideElements(e.children[s],t)}select(e,t=null){(e instanceof Array?e:[e]).forEach(s=>{s=this._checkForDimension(s);const r=this._clone(s);r.selected=!0,r.traverse(i=>{i.material&&(i.material=t||this._material)}),r.renderOrder=1,s.parent.add(r),this.selecteds.push(r)})}deselectAll(){this.selecteds&&(this.selecteds.forEach(e=>e.parent.remove(e)),this.selecteds.length=0)}hover(e,t=null){e=this._checkForDimension(e),this._clonedObjects[e.uuid]||(this._clonedObjects[e.uuid]={clone:this._clone(e),parent:e.parent});const s=this._clonedObjects[e.uuid];s.clone.hovered=!0,s.clone.traverse(r=>{r.material&&(r.material=t||this._materialHover)}),this._hovered=s.clone,s.parent.add(this._hovered)}removeHover(){this._hovered&&this._hovered.parent&&(this._hovered.parent.remove(this._hovered),this._hovered=null)}_checkForDimension(e){let t=e;for(;t!==null;){if(t.name==="DIMENSION")return t;t=t.parent}return e}}const Zm={Unitless:0,Inches:1,Feet:2,Miles:3,Millimeters:4,Centimeters:5,Meters:6,Kilometers:7,Microinches:8,Mils:9,Yards:10,Angstroms:11,Nanometers:12,Microns:13,Decimeters:14,Decameters:15,Hectometers:16,Gigameters:17,"Astronomical units":18,"Light years":19,Parsecs:20,"US Survey Feet":21,"US Survey Inch":22,"US Survey Yard":23,"US Survey Mile":24};export{Rm as CADControls,bm as DXFViewer,fm as Hover,gd as Merger,gm as Select,xm as SnapsHelper,Zm as UNITS};
